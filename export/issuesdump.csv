id,project,subject,description,author,created_on,updated_on,assignee,status,priority
82,bismark,packporting pfifo_fast fix,"A fix to a ECN/pfifo qdisc bug is in 2.6.39-rcX. It has not been backported to openwrt as yet.

At the moment the wndr3700 is using the pfifo qdisc on most (all?) interfaces. I do not know if this will remain the case, but the bug messes up ecn enabled flows to a large extent. Nor do I know what qdisc was used in the original study.

More details on the problem and tiny fix are here:

http://www.coverfire.com/archives/2011/03/13/pfifo_fast-and-ecn/",Dave Täht,2011-04-12 09:12:50.206617,2011-04-17 13:08:45.409628,Dave Täht,Closed,Normal
35,sysadmin,New Server Buildout,"The arrival of a new server and new requirements are going to require thinking. 

What, exactly, do we want to do with it?",Dave Täht,2011-02-18 06:59:38.255348,2011-03-18 08:02:48.159891,Dave Täht,New,Normal
13,sysadmin,DNS should return NXdomain for invalid subdomains - it returns an ad-site instead.,"If there is a way of turning off this behavior at your DNS provider
it helps on rbls on the email side... and

Seeing ads on typos is just not how the net was supposed to be.

root@shipka:~# host siwa.bufferbloat.nte
siwa.bufferbloat.nte.bufferbloat.net has address 174.37.172.68

Also, I am a fan of geodns. If they can do geodns, great. If not you could
delegate the NS subdomain and record for mirrors.bufferbloat.net to sima/shipka
and one day we could actually do it, particularly as most of the bufferbloat
issues I've seen are in the third world, and Australia.",Dave Täht,2011-01-24 10:12:03.706782,2011-01-26 17:38:45.041511,Dave Täht,New,Low
174,bismark-testbed,using decimal for naming subnets is silly,"I should have gone with /21s throughout, but didn't.",Dave Täht,2011-05-22 08:41:53.147936,2011-07-10 14:31:56.033737,Dave Täht,Closed,Normal
49,iscwrt,httpping testing/port to openwrt,"",Dave Täht,2011-04-04 07:51:34.465091,2011-08-03 07:19:23.71512,Dave Täht,Closed,Normal
9,sysadmin,Issue management via email,"I want the workflow to be manageable via email....

http://www.redmine.org/issues/1110",Dave Täht,2011-01-23 18:55:22.332627,2011-01-26 17:34:37.033788,Dave Täht,Closed,Normal
20,sysadmin,"The key leaks in a bounced mail, too",Not good.,Dave Täht,2011-01-26 12:36:25.233116,2011-01-26 13:08:19.592291,Dave Täht,Closed,Normal
14,sysadmin,IRC channel name should be #bufferbloat,#bloat won't be found...,Jim Gettys,2011-01-24 12:18:30.587128,2011-01-26 17:36:13.908506,Dave Täht,In Progress,Normal
6,sysadmin,Need Bandwidth/cpu usage monitor,"MRTG? Cacti?

I already have part of nagios configured but am out of date as to a good bandwidth monitor to use.

I like having ONE graph that shows system activity across all the servers being maintained.

These tools will live on lists.bufferbloat.net for now. ",Dave Täht,2011-01-23 18:50:18.254378,2011-01-26 17:41:48.445375,Dave Täht,New,Low
2,sysadmin,xapian plugin for redmine,"subject says it all.

Will be nice for indexing documents, presuming it works.
",Jim Gettys,2011-01-23 18:28:39.724905,2011-01-26 17:43:05.748458,Dave Täht,New,Normal
3,sysadmin,etckeeper to keep track of the system would be goodness.,"integrated into the sysadmin git repo, ideally.",Jim Gettys,2011-01-23 18:30:24.936969,2011-01-26 17:44:05.773308,Dave Täht,Closed,Normal
8,sysadmin,Setup & test backup to backup.bufferbloat.net,"Once the backup disk is set, test backups.",Jim Gettys,2011-01-23 18:53:25.389573,2011-01-26 17:44:05.819817,Dave Täht,New,Normal
15,sysadmin,Can I create a new issue via email?,"This would be bad in some cases without decent anti-spam control. I'd
like to get this to filter via gpg...

-- 
Dave Taht
http://nex-6.taht.net",Dave Täht,2011-01-24 13:37:12.942372,2011-02-01 09:18:02.703943,Dave Täht,Closed,Normal
4,sysadmin,Postgres 9 with streaming,"It would be nice to have postgres 9 running as the backend. Although I trust 8.4, streaming replication (for a hot spare) is simply ""better"" with 9.

",Dave Täht,2011-01-23 18:43:56.16173,2011-01-24 14:22:55.881752,Dave Täht,In Progress,Normal
326,cerowrt,Fwd: [PATCH net-next] sch_sfq: rehash queues in perturb timer,"Eric, I think I love you.

I'd like to slam this into cerowrt, which is based on 3.1.5 for at
least another month. Are there dependencies on the other work you've
been doing in this area I should worry about?


---------- Forwarded message ----------
From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Wed, Dec 21, 2011 at 2:30 PM
Subject: [PATCH net-next] sch_sfq: rehash queues in perturb timer
To: David Miller <davem@davemloft.net>
Cc: netdev <netdev@vger.kernel.org>


A known Out Of Order (OOO) problem hurts SFQ when timer changes
perturbation value, since all new packets delivered to SFQ enqueue might
end on different slots than previous in-flight packets.

With round robin delivery, we can thus deliver packets in a different
order.

Since SFQ is limited to small amount of in-flight packets, we can rehash
packets so that this OOO problem is fixed.

This rehashing is performed only if internal flow classifier is in use.

We now store in skb->cb[] the ""struct flow_keys"" so that we dont call
skb_flow_dissect() again while rehashing.

Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
---
 net/sched/sch_sfq.c |   87 +++++++++++++++++++++++++++++++++++++++---
 1 file changed, 81 insertions(+), 6 deletions(-)

diff --git a/net/sched/sch_sfq.c b/net/sched/sch_sfq.c
index 30cda70..d329a8a 100644
--- a/net/sched/sch_sfq.c
+++ b/net/sched/sch_sfq.c
@@ -136,16 +136,30 @@ static inline struct sfq_head
*sfq_dep_head(struct sfq_sched_data *q, sfq_index
       return &q->dep[val - SFQ_SLOTS];
 }

+/*
+ * In order to be able to quickly rehash our queue when timer changes
+ * q->perturbation, we store flow_keys in skb->cb[]
+ */
+struct sfq_skb_cb {
+       struct flow_keys        keys;
+};
+
+static inline struct sfq_skb_cb *sfq_skb_cb(const struct sk_buff *skb)
+{
+       BUILD_BUG_ON(sizeof(skb->cb) <
+               sizeof(struct qdisc_skb_cb) + sizeof(struct sfq_skb_cb));
+       return (struct sfq_skb_cb *)qdisc_skb_cb(skb)->data;
+}
+
 static unsigned int sfq_hash(const struct sfq_sched_data *q,
                            const struct sk_buff *skb)
 {
-       struct flow_keys keys;
+       const struct flow_keys *keys = &sfq_skb_cb(skb)->keys;
       unsigned int hash;

-       skb_flow_dissect(skb, &keys);
-       hash = jhash_3words((__force u32)keys.dst,
-                           (__force u32)keys.src ^ keys.ip_proto,
-                           (__force u32)keys.ports, q->perturbation);
+       hash = jhash_3words((__force u32)keys->dst,
+                           (__force u32)keys->src ^ keys->ip_proto,
+                           (__force u32)keys->ports, q->perturbation);
       return hash & (q->divisor - 1);
 }

@@ -161,8 +175,10 @@ static unsigned int sfq_classify(struct sk_buff
*skb, struct Qdisc *sch,
           TC_H_MIN(skb->priority) <= q->divisor)
               return TC_H_MIN(skb->priority);

-       if (!q->filter_list)
+       if (!q->filter_list) {
+               skb_flow_dissect(skb, &sfq_skb_cb(skb)->keys);
               return sfq_hash(q, skb) + 1;
+       }

       *qerr = NET_XMIT_SUCCESS | __NET_XMIT_BYPASS;
       result = tc_classify(skb, q->filter_list, &res);
@@ -423,12 +439,71 @@ sfq_reset(struct Qdisc *sch)
               kfree_skb(skb);
 }

+/*
+ * When q->perturbation is changed, we rehash all queued skbs
+ * to avoid OOO (Out Of Order) effects.
+ * We dont use sfq_dequeue()/sfq_enqueue() because we dont want to change
+ * counters.
+ */
+static void sfq_rehash(struct sfq_sched_data *q)
+{
+       struct sk_buff *skb;
+       int i;
+       struct sfq_slot *slot;
+       struct sk_buff_head list;
+
+       __skb_queue_head_init(&list);
+
+       for (i = 0; i < SFQ_SLOTS; i++) {
+               slot = &q->slots[i];
+               if (!slot->qlen)
+                       continue;
+               while (slot->qlen) {
+                       skb = slot_dequeue_head(slot);
+                       sfq_dec(q, i);
+                       __skb_queue_tail(&list, skb);
+               }
+               q->ht[slot->hash] = SFQ_EMPTY_SLOT;
+       }
+       q->tail = NULL;
+
+       while ((skb = __skb_dequeue(&list)) != NULL) {
+               unsigned int hash = sfq_hash(q, skb);
+               sfq_index x = q->ht[hash];
+
+               slot = &q->slots[x];
+               if (x == SFQ_EMPTY_SLOT) {
+                       x = q->dep[0].next; /* get a free slot */
+                       q->ht[hash] = x;
+                       slot = &q->slots[x];
+                       slot->hash = hash;
+               }
+               slot_queue_add(slot, skb);
+               sfq_inc(q, x);
+               if (slot->qlen == 1) {          /* The flow is new */
+                       if (q->tail == NULL) {  /* It is the first flow */
+                               slot->next = x;
+                       } else {
+                               slot->next = q->tail->next;
+                               q->tail->next = x;
+                       }
+                       q->tail = slot;
+                       slot->allot = q->scaled_quantum;
+               }
+       }
+}
+
 static void sfq_perturbation(unsigned long arg)
 {
       struct Qdisc *sch = (struct Qdisc *)arg;
       struct sfq_sched_data *q = qdisc_priv(sch);
+       spinlock_t *root_lock = qdisc_lock(qdisc_root_sleeping(sch));

+       spin_lock(root_lock);
       q->perturbation = net_random();
+       if (!q->filter_list && q->tail)
+               sfq_rehash(q);
+       spin_unlock(root_lock);

       if (q->perturb_period)
               mod_timer(&q->perturb_timer, jiffies + q->perturb_period);",David Taht,2011-12-21 20:02:28.859065,2012-04-21 12:37:44.271846,Dave Täht,Closed,Normal
31,sysadmin,THANKS FOR THE BETA TESTING!!,"And thanks for checking in! I'm so completely buried right now I can
hardly see my way clear out of it, so by all means, beat on the site...

Originally I was going to be expanding the [[bloat:outline]] on the wiki
today...

Let me know via the sysadmin tracker whatever problems you find. Or
check in on irc on chat.freenode.net #bufferbloat.

(This email is also a test to see if I CAN actually open an issue via email)",Dave Täht,2011-01-27 10:35:30.558944,2011-03-19 11:50:23.972734,Dave Täht,In Progress,High
16,sysadmin,migrate my tasks from org to redmine,"* TODO lists.bufferbloat.net
** DONE don't do a cname
** DONE Must have a real IP address 
** DONE Need mx records
** DONE nag about reverse DNS
** DEFR nolisting
** Email
*** TODO Mailman
**** DONE Basic mailman (web/https)
**** DONE need redirect for bare https: url
**** DONE Test email exchanges through the backup mx
**** DONE Add more mailing lists
     CLOSED: [2011-01-21 Fri 15:39]
     :LOGBOOK:
     - State ""DONE""       from ""STARTED""    [2011-01-21 Fri 15:39]
     - State ""STARTED""    from ""STARTED""    [2011-01-21 Fri 11:12]
     CLOCK: [2011-01-21 Fri 11:12]--[2011-01-21 Fri 15:38] =>  4:26
     :END:
     added theory, bloat-announce, bloat-devel
**** TODO test exchanges through exim mailers
**** TODO html filtering working?
**** DEFR CAPCHA - require approval to enter the list(s)
*** WAIT SSL CERT 							 :JG:
    SCHEDULED: <2011-01-17 Mon>
*** DONE REVERSE LOOKUP 						:ISC:
*** DONE DNS RBLS
*** DONE procmail NOT dovecot
*** TODO Search engine
    xapian preferred. Google custom maybe.
*** TODO Customize with puzzle pieces :JG:
*** TODO Gmane gateway
    gmane.bufferbloat.users
    gmane.bufferbloat.devel
    gmane.bufferbloat.announce

** TODO Schedules
*** Hard disk test at 3AM
*** Backups at 1AM
*** Cron locate at 2AM
*** Monthly faq to bloat-announce
** TODO Backups
   where? Gettys.net seems like a good idea. Rsync.net possibly
*** DB backup
*** rsync backup
*** Toutatis backup
* Global Tasks
** DONE Enable NTP
*** DONE ask isc for theirs
** snmpd
*** DONE Configure proc monitoring
*** TODO Allow Access
*** TODO Configure users
*** TODO Configure mibs
** Smartd
*** DONE apt-get install snmpd smartmontools
*** DONE configure to monitor - sending to hwmon@lists.bufferbloat.net
*** DONE Self tests - look good
** Hardware monitoring
*** Fan/cpu temp
** Web server log analysis
*** Analyzer?
** System log analysis?
*** TODO Why is the nightly update dumping core?
** Bandwidth analysis - mrtg? Cacti? What?
   :DEPENDS: snmp
** Nagios
*** DONE Get nagios server installed 
*** TODO Nagios clients
*** TODO Configure 
** Valid Url checker/report
** Feedvalidator
** International support
   Spanish translations of core documents, etc
** Apache tuning
*** Rate limit according to the CPU 
** WAIT etckeeper
   :DEPENDS: backups
** Local DNS
*** DONE siwa (cache only)
*** DONE shipka (cache only)
    CLOSED: [2011-01-20 Thu 11:54]
    :LOGBOOK:
    - State ""DONE""       from ""STARTED""    [2011-01-20 Thu 11:54]
    - State ""STARTED""    from ""STARTED""    [2011-01-20 Thu 11:53]
    CLOCK: [2011-01-20 Thu 11:53]--[2011-01-20 Thu 11:54] =>  0:01
    :END:
** Dogfood
*** DONE Turn on ECN/sack/dsack
    /etc/sysctl.d/60-bufferbloat.conf
*** DONE Reduce txqueuelen to 64
*** TODO Check into DMA tx queues on these servers
*** TODO SFB for outgoing packets?
** Firewall rules
*** TODO Allow 222, 443, 80, 81, tcp/udp 53, tcp/udp > 1024, git (9418), rsync
    enable ufw
*** TODO Allow NTP
*** TODO Have a syn rate limiter handy
**** Range of 30-300 connects/sec on 443?
*** DONE Have some sort of temporary open for outgoing
*** DONE Whitelist 567, 25 for dyndns, shipka. 
*** TODO prioritize port 222 traffic for interactive
*** TODO Leave postgres port open for certain ips
*** DONE Fiddle with txqueuelen
*** TODO whitelist snmpd (161) for monitor hosts
*** TODO load module with ip_list_tot=2000
*** TODO fully test dynamic opening of port 25
*** TODO Integrate firewall and shaping script(s)
*** TODO NMAP scan
*** TODO System updates
*** TODO Reboots
* TODO Redmine
** DONE Redmine 1.1 branched from git
*** DONE Need to migrate anyway to pg
- first, install redmine in a fresh postgre database
- then copy the rows from every table from the mysql database to the postgresql, truncating the postgresql tables first.
- select max(id) from MyTable; => max(id) + 1 (MaxIdPlusOne) => use that number in an ALTER SEQUENCE MyTable_id_seq RESTART with MaxIdPlusOne; That for every table with a sequence.
*** http://www.redmine.org/projects/redmine/wiki/RedmineInstall
*** Think hard about planning to scale
**** Web server/http server separation
**** EC2
**** DB/web server separation
***** WAIT Postgres 9.0?
      Too hard right now... Wait for official support
      Maybe install on sima

*** TODO Kill whatever is using mysql
*** DONE kill apache-prefork in favor of apache-mpm wherever possible
*** DONE Add favicon - added seems not to be vectored through this
*** TEST Redirect javascripts, images, css, files(?) so they can be handled by apache directly
*** CNCL etags
    too many hassles with multiple front ends, just supply cache for now
*** DONE Add mathjax support - works https://shipka.bufferbloat.net/MathJax/test/
*** DONE Add mathjax support to wiki headers
    I'm a little dubious about the change in the regexp. Asked eric for advice.
*** DONE openid support
*** TEST RMagick 
*** DONE Import old files
*** CNCL Import old data
*** TODO Email integration
*** TODO Backups
*** TODO Block access to certain stuff via robots.txt
*** TODO GET Content
**** Mysql dump from wordpress
**** Email logs
** UNKN RequestHeader set X_FORWARDED_PROTO 'https' in apache??
** DONE Ignore MX records for emails to [lists.bufferbloat.net]
*** CNCL transport_map for submit port
*** DONE Smarthost
** DONE Get apache configured for fcgi
   CLOSED: [2011-01-19 Wed 23:20]
   :LOGBOOK:
   - State ""DONE""       from ""STARTED""    [2011-01-19 Wed 23:20]
   - State ""STARTED""    from ""STARTED""    [2011-01-19 Wed 21:11]
   CLOCK: [2011-01-19 Wed 21:11]--[2011-01-19 Wed 23:20] =>  2:09
   :END:
   :PROPERTIES:
   :Effort:   1:00
   :END:
** DONE Expires headers
** DONE CSS or textile fix for images
*** DONE CSS fix 100% width
*** DEFR Rumors have it that using textile's scaling is subject to XSS attacks
** TODO Keep 4 ruby processes handy
   Must have misconfigured, I end up with 0 after being idle
** GRMP Attachments/images go through redmine rather than sanely through apache
   Maybe put some stuff in ~user dirs
*** TODO Fix existing attachments
 * WANT Glossary tag(s)
** CNCL etags - not needed 
** RTRY Yslow
** TODO github integration
   http://www.redmine.org/projects/redmine/wiki/HowTo_keep_in_sync_your_git_repository_for_redmine
** Email <-> forum gateway??
   Meh: http://www.redmine.org/issues/1616
** Plugins
*** Flot?
*** TEST Youtube
*** Mathjax support
   http://blog.felixbreuer.net/2010/03/19/writing-math.html
** DONE Admin Logins
** DB tuning
*** DONE Autovacuum or schedule? (Autovacuum for now)
*** DONE Buffers/connections high enough? (Think so)
*** TODO Do statistics step after backups
*** DEFR Increase buffering? Not needed yet
** Domain name
*** TODO Do redirects 
    from http(s)://www.bufferbloat.net to https://bufferbloat.net 
    or vice versa 
    Do redirects from http://bufferbloat.net to https://bufferbloat.net
** TODO Firewall
** Schedules
*** database optimization at 4AM

*** Backups
** Markdown format + textile?
** TODO How do you do tags in the wiki (ex: glossary)
** TODO Slashdot/Stress test
   (originate lots of hits from my other servers)
** siwa.bufferbloat.net admin landing page
   mrtg, nagios, health, etc
   Also SSL (don't care about real SSL)
* Random Tasks
** IRC channel
*** TODO irc bot to hold #bufferbloat alive
*** TODO irc commit notifications
** github fork of Linux-wireless
*** irc commit notifications
** NTP interaction with bufferbloat?

Jan 16 06:18:18 siwa dovecot: Fatal: Time just moved backwards by 9 seconds. This might cause a lot of problems, so I'll just kill myself now. http://wiki.dovecot.org/TimeMovedBackwards
** ECN issues
http://icir.org/floyd/ecnProblems.html
** Enabling ecn on osx
*** Normally
Re:
http://icir.org/floyd/ecn.html

MAC OS X:
Leopard 10.5.0 implements ECN, controlled by the variables ""net.inet.tcp.ecn_negotiate_in"" and ""net.inet.tcp.ecn_initiate_out"". Reported by Rui Paulo, 2007. 

*** For tunnels

   ECN friendly behavior
     gif can be configured to be ECN friendly, as described in draft-ietf-ipsec-ecn-02.txt.  This is turned
     off by default, and can be turned on by IFF_LINK1 interface flag.

     Without IFF_LINK1, gif will show a normal behavior, like described in RFC2893.  This can be summarized
     as follows:

           Ingress  Set outer TOS bit to 0.

           Egress   Drop outer TOS bit.

     With IFF_LINK1, gif will copy ECN bits (0x02 and 0x01 on IPv4 TOS byte or IPv6 traffic class byte) on
     egress and ingress, as follows:

           Ingress  Copy TOS bits except for ECN CE (masked with 0xfe) from inner to outer.  Set ECN CE bit
                    to 0.

           Egress   Use inner TOS bits with some change.  If outer ECN CE bit is 1, enable ECN CE bit on the
                    inner.

     Note that the ECN friendly behavior violates RFC2893.  This should be used in mutual agreement with the
     peer.

** DONE have gnugol use global keys
*** Also installed on shipka
** Apt repo(s) for debian/ubuntu
*** bufferbloat-tests
*** bufferbloat-finder
*** bufferbloat-homegw

*** bufferbloat-desktop
*** bufferbloat-server
*** bufferbloat-experimental
** RPM repos
* Personal
** Join #redmine
** Bugreport problem with postgres9 repo
** Pick up hudson
",Dave Täht,2011-01-24 15:35:26.355911,2011-01-24 15:48:58.359936,Dave Täht,New,High
12,sysadmin,Email & Other Workflow,"Just some grumps

* The email interface does not send from a unique per project email address
 
* The subject line is thus a bit wordy

* The email interface does not wrap text to 80 columns

* The email interface does not authenticate users using gpg. gpg is the one sure means of anti-spam out there.

* Entering new issues (examples: support, abuse, security, snmp alerts) via email appears problematic

* The email interface DOES support some modification of attributes

* The email interface DOES supply sufficient information in it's headers to adequately filter

* The web interface does not support bulk edits/adds of issues

* There does not appear to be a command line interface

* It does not appear there are triggers implemented, so when a project moves from one state to another, (example: from In Development to Test), whatever happens next has to be done manually.

Some of this is just my own ignorance, to be sure, but most of these are features of RT.

I know, I know, one new project at a time.

Grump.",Dave Täht,2011-01-24 09:07:39.220434,2011-01-24 20:46:42.257025,Dave Täht,New,Low
306,cerowrt,Better QoS for the external interface,"I'm planning on incorporating BQL (byte queue limits) into the kernel for cerowrt rc8, as well as implementing 2-3 default aqm/qos schemes.

BQL lets us get away from having overly low TX rings and manage things with bytes in the driver, rather than in the ring. We should also (finally) be able to get away from artificially short txqueuelen with what I describe below... 

The default QoS 'prioritization' scheme as supplied by openwrt simply is not the 'right thing' for modern high bandwidth environments. Also the unholy HFSC + SFQ + RED scheme in it is nearly impossible to understand. So...

By default it will be QFQ (the quick fair queue scheduler) + RED at line rate. This is working really well, at least at 100Mbit line rates. More testing of course, is required, and tuning RED for various line rates (10,100,1000) will also be required. 

The biggest problem is that nobody runs at line rate anymore. So we need a bandwidth test - presently netperf - to be able to run either automatically, or from the gui, to set the upload rate, at the very least. We need to run it twice - once for a brief duration to see what shaping is happening, and once longer - to see what happens,
after things settle down. 

When an upload parameter is generated, we will shape on top of QFQ + RED using CBQ or HTB, with a single set of QFQ qdiscs, most likely with a sub-qdisc of RED, as no better alternative is yet available. My experiments with SFB, for example, have resulted in it overly punishing most flows, not that I'm entirely willing to give up on it.

There will be *no* priorities per se', only fairness between flows. It's my hope to otherwise preserve the properties of the existing configuration gui and configuration files in openwrt. Configuring the default txqueuelen, tx rings, and red right for various bandwidths between 128k and 100Mbit is going to be
really hard...

The third potential shaper is 'bittorrent mode', which would do fairness between machines, rather than flows. Thus far the only way I've figured out how to implement this is with a pre-nat filter per ip filter on the above, and results in de-fqing all flows coming from one machine, which is not good. I think - but am not sure - I might be able to create a  set of filters and hashes that lets you use qfq on a per machine basis and still promote fairness between a limited number of flows on each machine, but haven't got there yet. So you'd get like 32 flows per machine to hash into, and 256 machines with unique buckets to hash against...

and/or a dscp filter would help with the hash buckets. 

It would be nice to have a 'run bandwidth test' thing in the gui that can pull the results out of netperf (which does have a nice csv output mode)

I MAY try to bump up the clock rate to give CBQ something to work with. Regrettably I've been able to lock up CBQ regularly with various prototypes of this setup. Switching to HTB in a very limited mode now....

As these scripts will not be cerowrt specific - but merely require BQL and QFQ - it's my hope that they can be tried on multiple gateway setups, such as the guruplug and/or x86 boxes, etc, to get a feel for the valid ranges. I'd love to see people try BQL and QFQ on desktops - it seems to help a lot on 100Mbit ethernet and a great deal on gigabit....

Also gargoyles's setup should be looked at.

The various and sundry scripts are living in this repository at present: https://github.com/dtaht/deBloat

(although as I write the only working prototypes are the eqfq and eqfq.red scripts in the wip dir)
",Dave Täht,2011-11-24 13:04:57.596461,2011-11-24 13:04:57.596461,Dave Täht,New,Urgent
26,sysadmin,dita plugin,"I'd wanted to patch in the external wiki plugin - which supports graphviz among other tools...

http://www.redmine.org/boards/3/topics/10649

but the code scared me too much.",Dave Täht,2011-01-26 18:29:24.327322,2011-02-01 09:19:06.421328,Dave Täht,New,Low
36,sysadmin,Continuous Build System,"Jenkins (formerly known as hudson) looks good.

How do we get it incorporated into redmine?

What do we do builds on?

",Dave Täht,2011-02-18 07:00:25.533424,2011-02-18 07:08:57.286954,Dave Täht,New,Normal
38,sysadmin,Bloat redmine wiki should be the front page.,"I tried to fix this myself, but I don't know enough about how you have it installed.

In any case, see Eric's page at https://github.com/edavis10/redmine_homepage for details.",Jim Gettys,2011-02-21 14:31:21.859617,2011-02-21 17:26:12.471004,Dave Täht,New,Normal
116,uberwrt,IPv6 ECN support is borked in current kernels,"See 

https://bugzilla.kernel.org/show_bug.cgi?id=34322

for details

This, of course, breaks all ECN aware Qdiscs.",Dave Täht,2011-05-07 12:16:03.494655,2011-07-27 20:17:02.393956,Dave Täht,Closed,Urgent
114,uberwrt,would like a delay sensitive tcp in the kernel,vegas or veno would be useful to test against.,Dave Täht,2011-05-05 23:56:22.461718,2011-06-13 21:40:49.710596,Dave Täht,Closed,Normal
55,uberwrt,Configure build better,"Default to lower TXQUEUELEN
Add radvd
Incorporate other kernel patches
Consider routing rather than bridging
",Dave Täht,2011-04-05 16:01:50.94734,2011-07-27 20:17:02.687554,Dave Täht,Closed,Normal
154,bismark,projectbismark.net,"Can we have projectbismark.net map to here? http://www.bufferbloat.net/projects/bismark/

Thanks!",Nick Feamster,2011-05-16 12:36:23.32433,2011-07-29 08:28:55.549755,Dave Täht,Rejected,Urgent
128,iscwrt,"should be 4, rather than 3 Mac addrs?","two radios
one network port (eth1) for the outside world
another connected to a 4 port bridge.

Yet on boot I only detect 3 mac addrs.",Dave Täht,2011-05-08 20:36:16.771005,2011-07-10 15:04:52.440107,Dave Täht,Closed,Normal
48,bismark,bismark-commits,Neeed a mailing list for the svn commit integrations,Dave Täht,2011-04-04 07:37:43.328945,2011-04-06 04:03:26.582824,Dave Täht,Closed,Normal
129,cerowrt,A general purpose test plan,"And test environment, with automated tests, would be very nice to have.

",Dave Täht,2011-05-09 12:42:43.710459,2011-12-08 11:23:01.09584,Dave Täht,New,Urgent
62,bismark,Create bismark specific openwrt feed,"Also, need to get the feed incorporated into the default build.",Dave Täht,2011-04-06 14:03:23.766222,2011-05-22 06:36:03.151457,Dave Täht,Closed,Immediate
66,bismark,DNSmasq appears to be broken,"By default it is picking up the 127.0.0.1 address on boot, and NOT the dhcp supplied address.

If you manually create the /etc/resolv.conf. KILL -9 the dnsmasq process. Then start it manually with the same command line, it works. ",Dave Täht,2011-04-06 15:44:46.346369,2011-04-07 20:18:27.851341,Dave Täht,Closed,Normal
176,cerowrt,Secure updates are a necessity.,"Home routers are not getting updated properly: they are a security nightmare waiting to happen.

We can do better.

While every router should allow the user to do what they want, most don't ever do security updates, and this is a problem.  So the updates themselves need to be secure, but also automated properly.",Jim Gettys,2011-05-23 09:38:10.397669,2012-04-21 12:42:10.010854,Dave Täht,In Progress,High
84,bismark,openwrt package for SFB?,"As SFB is a leading candidate for a qdisc that can help manage bloat, it would be nice to have it available as a kernel package, along with the acommpanying tc (which also has CHOKe support) A version backported to 2.6.38 is described at:

https://lists.bufferbloat.net/pipermail/bloat/2011-April/000384.html

Regrettably the current wndr build is against 2.6.37.6 

Whenever we move forward to 2.6.38 or can backport to 2.6.37 it would be good to have this under consideration.",Dave Täht,2011-04-12 09:30:44.388889,2011-05-12 18:56:39.231836,Dave Täht,Closed,Normal
81,iscwrt,Do not see radvd (multicast?) announcements on wireless,"Connected via wired I can do a radvdump AND also am automagically assigned a ipv6 address.

Connected via wireless, no assigned ipv6 address, nothing via radvdump

Manually assigning an ipv6 address, I CAN use ndisc6 to discover nearby machines...
but it would be nice to get my routes and ip addr!",Dave Täht,2011-04-12 07:21:53.46512,2012-04-22 16:30:26.011625,Dave Täht,Closed,Normal
148,bismark,babel comes up automatically,Babel interfaces come up automatically. Do we need them?,Srikanth Sundaresan,2011-05-15 17:47:32.475186,2011-05-18 14:17:52.974618,Dave Täht,Closed,Low
149,bismark,Guest interfaces come up automatically,"We don't need the guest interfaces IMO. It makes the interface very complex.
",Srikanth Sundaresan,2011-05-15 17:48:16.832514,2011-05-18 14:19:33.213734,Dave Täht,Closed,Low
142,iscwrt,"iproute2 needs to be updated to ""head"" for sfb support","The upcoming 2.6.39 release of iproute (due in 1wk) has sfb support.

It would be good to backport it into openwrt when released.",Dave Täht,2011-05-12 18:57:57.303018,2011-08-03 07:13:44.348916,Dave Täht,Closed,Normal
447,cerowrt,Dropbear settings luci not apply,"Changes settings to no permit password loggins and root password in luci no make any difference.

For solve need to change init args in xinetd ssh settings.",Alexandre Possebom,2014-09-05 13:02:40.965453,2014-09-05 13:02:40.965453,Dave Täht,New,Normal
45,cerowrt,Worldwide Rollout - Need measurement servers worldwide,"",Dave Täht,2011-04-04 06:57:05.613374,2012-04-21 12:42:02.542772,Dave Täht,New,Normal
91,uberwrt,openwrt package for SFB?,Need to get packaging going for iproute2,Dave Täht,2011-04-16 09:10:48.83528,2011-05-06 00:01:19.306624,Dave Täht,Closed,Normal
133,bismark,ECN is never asserted by RED in qos-scripts,"Although the qdisc claims red is using ECN, tc does not report ECN marking ever being applied, even if I ratchet down the bandwidth well below what is real (10kbit, 100kbit, 5Mbit tested)",Dave Täht,2011-05-10 06:12:07.703608,2011-05-12 18:32:14.558743,Dave Täht,Closed,Normal
119,iscwrt,ipv6calc returns invalid ipv4 info,version .82 and prior blow up on certain kinds of data executing the ipv4 path instead of the ipv6 path,Dave Täht,2011-05-07 22:31:03.303931,2012-04-22 16:30:27.780266,Dave Täht,Closed,Normal
314,cerowrt,Samba/Wins and windows XP and vista issues with wireless and multiple networks,"Co-existence of routed networks in the home, in the case of windows firesharing, is proving to be a pita.",Dave Täht,2011-12-01 10:43:40.963061,2012-08-22 17:38:14.617776,Dave Täht,New,Normal
103,iscwrt,various boot order problems,"the system is not awake enough to set time correctly on boot

among other things.",Dave Täht,2011-05-02 07:25:11.377738,2011-07-10 15:10:31.924942,Dave Täht,Closed,Normal
93,bismark,mountd runs away and eats 100% of CPU,"If you are using an existing build of bismark, 100% of cpu is being eaten by mountd. ",Dave Täht,2011-04-19 07:11:26.148267,2011-05-07 21:39:51.197773,Dave Täht,Closed,Normal
101,iscwrt,dhcp and named are not restarted on a network restart,There needs to be hooks put in place to ensure these restart on demand.,Dave Täht,2011-05-02 07:21:32.218133,2011-05-07 21:42:38.514326,Dave Täht,Rejected,Normal
155,bismark,mailing list access,Can we give mailing list admin access to me (Nick)?,Nick Feamster,2011-05-16 12:41:57.554984,2011-05-17 09:32:45.035589,Dave Täht,Closed,Normal
94,bismark,Regulatory domain is not set by default,"The regulatory domain for the wireless interface is not set by default. This (I think) prevents wireless-n from working properly.

You can set your country code by setting ""option 'country' 'US' for your wireless0 and 1 interfaces in /etc/config/wireless.

",Dave Täht,2011-04-19 16:56:59.673764,2011-05-07 22:34:19.255192,Dave Täht,Closed,Normal
102,iscwrt,txqueuelen is not reset on a network restart,currently txqueuelen is set in rc.local. It needs to be set on interface creation/modification in both wireless and wired interfaces.,Dave Täht,2011-05-02 07:24:17.672547,2012-04-22 16:30:27.251915,Dave Täht,Closed,Normal
98,cerowrt,6to4 firewall rules may not be working,6to4 firewall rules may not be working,Dave Täht,2011-05-02 06:46:36.93787,2014-06-24 20:03:24.032066,Dave Täht,Closed,High
135,bismark,act_connmark: Unknown symbol nf_conntrack_in (err 0),"connection marking has the above issue. Missing module?

Can this cause a problem?",Dave Täht,2011-05-10 15:18:57.164221,2011-05-18 14:31:57.242054,Dave Täht,Closed,Normal
126,cerowrt,ipv6 bridges are all set to the same fe80:: address,"This will wreak merry havoc with the babel protocol, among others:

So here we are with 2 network ports and 2 radios, and a bunch of virtual bridges. Yet we have:

root@OpenWrt:~# ip -6 addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qlen 1000
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
8: br-lan: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
9: br-guest: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
10: br-meshlink0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qlen 4
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
11: br-meshlink1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qlen 4
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever

All the same!

And no eth1 at all! yet on the ipv4 side we have:

root@OpenWrt:~# ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
3: eth1: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc pfifo_fast state DOWN qlen 1000
    link/ether c4:3d:c7:8b:6e:1b brd ff:ff:ff:ff:ff:ff
4: eth0.1@eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP 
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
5: eth0.2@eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP 
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
6: eth0.3@eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP 
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
7: eth0.4@eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP 
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
8: br-lan: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN 
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
    inet 192.168.42.1/24 brd 192.168.42.255 scope global br-lan
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
9: br-guest: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN 
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
    inet 192.168.43.1/24 brd 192.168.43.255 scope global br-guest
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
10: br-meshlink0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN qlen 4
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
    inet 172.16.72.1/24 brd 172.16.72.255 scope global br-meshlink0
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
11: br-meshlink1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN qlen 4
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
    inet 172.16.73.1/24 brd 172.16.73.255 scope global br-meshlink1
    inet6 fe80::c63d:c7ff:fe8b:6e1a/64 scope link 
       valid_lft forever preferred_lft forever
14: sit0: <NOARP> mtu 1480 qdisc noop state DOWN 
    link/sit 0.0.0.0 brd 0.0.0.0
15: ifb0: <BROADCAST,NOARP> mtu 1500 qdisc noop state DOWN qlen 32
    link/ether 86:c8:86:e2:cb:46 brd ff:ff:ff:ff:ff:ff
16: ifb1: <BROADCAST,NOARP> mtu 1500 qdisc noop state DOWN qlen 32
    link/ether 22:b0:4a:db:03:b1 brd ff:ff:ff:ff:ff:ff
17: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP qlen 1000
    link/ether c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
18: wlan2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UNKNOWN qlen 1000
    link/ether ce:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
19: mon.wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UNKNOWN qlen 1000
    link/ieee802.11/radiotap c4:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
20: wlan1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UNKNOWN qlen 1000
    link/ether ca:3d:c7:8b:6e:1a brd ff:ff:ff:ff:ff:ff
21: wlan3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP qlen 1000
    link/ether c4:3d:c7:8b:6e:1c brd ff:ff:ff:ff:ff:ff
22: wlan5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UNKNOWN qlen 1000
    link/ether ce:3d:c7:8b:6e:1c brd ff:ff:ff:ff:ff:ff
23: mon.wlan3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UNKNOWN qlen 1000
    link/ieee802.11/radiotap c4:3d:c7:8b:6e:1c brd ff:ff:ff:ff:ff:ff
24: wlan4: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UNKNOWN qlen 1000
    link/ether ca:3d:c7:8b:6e:1c brd ff:ff:ff:ff:ff:ff

which has some variety

and:

br-guest  Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          inet addr:192.168.43.1  Bcast:192.168.43.255  Mask:255.255.255.0
          inet6 addr: fe80::c63d:c7ff:fe8b:6e1a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:24 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:3228 (3.1 KiB)

br-lan    Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          inet addr:192.168.42.1  Bcast:192.168.42.255  Mask:255.255.255.0
          inet6 addr: fe80::c63d:c7ff:fe8b:6e1a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:9696 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9179 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:553727 (540.7 KiB)  TX bytes:1037996 (1013.6 KiB)

h2. these are on different radios!

br-meshlink0 Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          inet addr:172.16.72.1  Bcast:172.16.72.255  Mask:255.255.255.0
          inet6 addr: fe80::c63d:c7ff:fe8b:6e1a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:4 
          RX bytes:0 (0.0 B)  TX bytes:548 (548.0 B)

br-meshlink1 Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          inet addr:172.16.73.1  Bcast:172.16.73.255  Mask:255.255.255.0
          inet6 addr: fe80::c63d:c7ff:fe8b:6e1a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:7 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:4 
          RX bytes:0 (0.0 B)  TX bytes:618 (618.0 B)

eth0      Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          inet6 addr: fe80::c63d:c7ff:fe8b:6e1a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:9698 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9601 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:728391 (711.3 KiB)  TX bytes:1107293 (1.0 MiB)
          Interrupt:4 

eth0.1    Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:9697 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9273 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:592573 (578.6 KiB)  TX bytes:1081292 (1.0 MiB)

eth0.2    Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:119 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 

eth0.3    Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:100 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:7152 (6.9 KiB)

eth0.4    Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:100 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:7132 (6.9 KiB)

eth1      Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1B  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:5 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:544 errors:0 dropped:0 overruns:0 frame:0
          TX packets:544 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:36904 (36.0 KiB)  TX bytes:36904 (36.0 KiB)

mon.wlan0 Link encap:UNSPEC  HWaddr C4-3D-C7-8B-6E-1A-00-47-00-00-00-00-00-00-00-00  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:553331 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:57373850 (54.7 MiB)  TX bytes:0 (0.0 B)

mon.wlan3 Link encap:UNSPEC  HWaddr C4-3D-C7-8B-6E-1C-00-47-00-00-00-00-00-00-00-00  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:51 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:4097 (4.0 KiB)  TX bytes:0 (0.0 B)

wlan0     Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:509 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:51286 (50.0 KiB)

wlan1     Link encap:Ethernet  HWaddr CA:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:118 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:11468 (11.1 KiB)

wlan2     Link encap:Ethernet  HWaddr CE:3D:C7:8B:6E:1A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:494 (494.0 B)  TX bytes:108 (108.0 B)

wlan3     Link encap:Ethernet  HWaddr C4:3D:C7:8B:6E:1C  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:508 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:51158 (49.9 KiB)

wlan4     Link encap:Ethernet  HWaddr CA:3D:C7:8B:6E:1C  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:117 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:11360 (11.0 KiB)

wlan5     Link encap:Ethernet  HWaddr CE:3D:C7:8B:6E:1C  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:204 (204.0 B)
",Dave Täht,2011-05-08 19:47:31.098582,2011-08-03 07:08:47.893831,Dave Täht,Closed,Normal
289,cerowrt,Fwd: Re: plot,"-------- Original Message --------
Subject: 	Re: plot
Date: 	Fri, 21 Oct 2011 16:25:16 +0200
From: 	Fabian Schneider <fabian@ieee.org>
To: 	David Täht <dave.taht@gmail.com>

	


Hi,

>  Obviously I need to learn enough R to be able to do this sort of analysis myself. In the interim, since I'm doing a similar experiment monday (this time varying either classification of ping or the queue-ing algorithm, not the buffer size - I haven't decided which), we'd love to see your script in the hope I can immediately use it in the class...

Ok. lets see. I created something that should ease up the plotting. See attached tar archive and sample plot. To summarize there is a Makefile which plots the data and expects:
- p1.txt and p2.txt as input (which should be the logs from the ping command)
- awk and sed to be installed and in the path
- GNU R to be installed and in the path

What it does is:
1.) extracts the RTT timeseries 'hopefully' covering the download period, by looking for the ping sequence number (SEQ) with maximum RTT (MAX) and considering all RTTs from SEQ-100 to SEQ+100.
2.) replacing all timeouted pings with an RTT value of MAX+100ms, where the 100ms can be configured in the BEGIN clause of the awk script.
3.) plot the two time series.

What it includes:
- extract.timeseries.awk (performs steps 1+2)
- plotit.R (performs step 3)
- Makefile (wrapper)
- p*.txt example input files

>  As for these plots, what I'd like:
>
>  the Y axis to stay in the the same range of 0 - 1000 ms

(for the combined plot i determine the maximum RTT and use that as an upper bound)

>  the X axis to be 100 seconds long, showing the idle period, the spike, the idle period.

(i opted for a 200 second = 200 ping samples period instead)

>  the two plots to be directly comparable, using a different color for the ping 'dots', and roughly the same start time, so I can overlay them...

already done. Only one output plot.

>  1) start time is uncontrolled (but close enough, given the length of transfer)

you can 'tune' the input data and have the input file start at a chosen point in time that is less than 100 seconds before the maximum to achieve this.
(I did not want to get into more sophisticated methods for determining the download period from the data, sofar)

>  4) tcpdump on at least several stations would be VERY interesting. Dario says you were seeing some interesting duplicate acks - I still haven't verified we've actually FIXED the stack enough to get reliable results.

No what we saw is ping reporting ""(DUP!)"" behind some lines.

>  Would you be interested in following up this line of work with a paper w/me/etc?

sure.

best
Fabian",David Taht,2011-10-21 19:11:13.335283,2012-04-21 12:37:39.393513,Dave Täht,Closed,Normal
132,bismark,Firewall rules do not work on default wlan,"The default firewall rules did not work on the default wlan.

Did work on the guest network and on the wired interface.",Dave Täht,2011-05-10 05:57:43.695383,2011-05-16 04:18:10.88158,Dave Täht,Closed,Normal
168,cerowrt,"after 4+ days of uptime, dhcp server stops","In the only box I've managed to keep running this long, dhcp has stopped serving new addresses.

root@labgw:~# uptime
 19:39:04 up 5 days, 15:20, load average: 0.16, 0.06, 0.05

restarting dnsmasq fixed it. There have been multiple builds since then, of course, and I've beaten this machine up with many, many tests, and it used to have bug [#136] which I killed off by hand.",Dave Täht,2011-05-19 12:43:43.334372,2014-06-24 20:03:31.674927,Dave Täht,Closed,Normal
192,bismark,ppoe is not installed by default,"DSL users especially, use PPP over ethernet. While available in the package repository, it is not installed by default, and for a more worldwide deployment, should be.",Dave Täht,2011-06-02 13:03:47.159999,2011-09-24 17:14:35.879215,Dave Täht,Closed,Normal
242,cerowrt,ssh into hosts times out too quickly,"When ssh'ing into a remote host through a cerowrt router, idle ssh connections seem to stop working.  This happens when the connection is idle for what seems like a rather short time.

I added this to /etc/rc.local, and the problem went away:

sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=432000

This sets a 5 day close time.  This is probably insane, but works well for me so far.  Of course, I've only had the box in play for 1.5 days...",Michael Graff,2011-08-22 19:05:55.430102,2011-08-23 15:46:13.982911,Dave Täht,Closed,Normal
143,bismark,"xWrt conflates ""zones"" and ""Interfaces""","As best as I can tell from looking at the current firewalling code, a ""zone"" can consist of multiple ""interfaces"". Xwrt wants one interface per ""zone"".

This results are tricky to understand, as we have a private and guest zone, consisting of many interfaces each.

Firewalling thus far has been difficult, and ipv6 firewalling works not at all.

So it would be nice if zones could be of multiple interfaces, assuming I'm understanding the rules right.",Dave Täht,2011-05-13 06:10:43.129925,2011-07-27 20:17:02.977463,Dave Täht,Closed,Normal
85,iscwrt,ECN and DSACK support via sysctl,"At the moment, I am appending the following to /etc/sysctl.conf on an install.

# Enable ECN

net.ipv4.tcp_ecn=1
net.ipv4.tcp_sack=1
net.ipv4.tcp_dsack=1

Coming up with a saner way to enable it (forking the openwrt package? a separate package?) would be good.

",Dave Täht,2011-04-12 09:32:57.450313,2011-05-22 06:50:13.593486,Dave Täht,Closed,Normal
79,iscwrt,Alternate TCP algorithms may be a good idea,"The current image is compiled with reno and cubic support for tcp algorithms.

Adding veno and vegas (two kinder/gentler TCPs) would be worthwhile.

sysctl -w net.ipv4.tcp_congestion_control=reno
sysctl -w net.ipv4.tcp_congestion_control=cubic

Work.

sysctl -w net.ipv4.tcp_congestion_control=veno
sysctl -w net.ipv4.tcp_congestion_control=vegas

Do not
",Dave Täht,2011-04-12 06:47:21.160366,2012-04-22 16:30:24.953116,Dave Täht,Closed,High
173,bismark,babel seems to have broken both builds,"1. DNS from clifton box does not work (i.e., even the basic gateway DNS lookup does not work... I'm writing this from a non-Bismark gateway)
2. ping from seapoint to global IP addresses *does* work
3. ping from a laptop conencted to clifton to global IP addresses *does* work
4. ping from a laptop connected to seapoint to cliftno does not work
5. ping from a laptop connected to seapoint to global IP addresses does not work.",Nick Feamster,2011-05-21 10:36:57.622569,2011-05-22 06:27:46.182121,Dave Täht,Closed,Immediate
145,cerowrt,Router solicitation and announce messages should be triggered on a dhcp request,"IPv6 Router Solicitation and announce messages are supplied via a fixed timeout in the kernel.

Clients that have a wireless interface are ""up"" but may not have ""attached"" to the wireless network.

The kernel will send 3 (by default) messages to an interface that is ""up"" before giving up, long before it usually attaches to a wireless network.

Hopefully this can be triggered on the server and client sides by a script poking a /proc parameter.",Dave Täht,2011-05-13 06:43:38.785256,2011-09-20 10:22:36.5691,Dave Täht,New,Normal
83,bismark,txqueuelen and dma tx queues,"setting txqueuelen in the /etc/config/network file does not appear to do the right thing.

I manually reduced this to saner values on the router I'm playing with by manually adding the following to /etc/rc.local

ifconfig eth0 txqueuelen 16
ifconfig eth1 txqueuelen 16
ifconfig wlan0 txqueuelen 4
ifconfig wlan1 txqueuelen 4

Similarly, DMA tx queues are hard coded on both the ar71xx and ath9k driver to fairly large values. (in excess of 64)

Giving total buffering of excess of 64 throughout.

Whether or not these are good values is hard to figure. The research I saw by comcast suggested that 32 total TX buffers was the edge where packet drop made sense vs ECN.",Dave Täht,2011-04-12 09:18:45.7672,2011-05-22 06:46:25.144146,Dave Täht,Closed,Urgent
187,bismark,capetown uses tcp westwood,"this is just a note for the future in that the default tcp algorithm in use is presently
tcp westwood.

Older versions of openwrt used tcp vegas. There are many newer kids on the block,
and mainline Linux kernels use tcp cubic nowadays, rightly or wrongly.",Dave Täht,2011-05-29 13:12:58.977107,2011-06-13 21:27:07.551807,Dave Täht,Closed,Normal
243,cerowrt,Regression - iptables dscp matches do not support ! inversions,"the iptables version in cerowrt rc5 has multiple problems with inversion matches. They are fixed as of the last patch series that went by on the netfilter list.

I do not think the existing iptables upgrade in cerowrt has made it to openwrt head as yet, and it should be held until these patches stablize.",Dave Täht,2011-08-23 09:52:41.583289,2012-04-21 12:37:36.164219,Dave Täht,Closed,Urgent
188,bismark,Netem would allow better emulation of long distances,"netem can be made available with a patch, more adaquately able to emulate 
transmission over longer distances. It does chew up memory, however, and 
what distance can be emulated is a function of the bandwidth available.",Dave Täht,2011-05-29 13:14:40.76108,2011-07-31 19:54:04.756864,Dave Täht,Feedback,Normal
220,cerowrt,echo 1 > /proc/sys/net/ipv4/tcp_low_latency gives good results,"we saw pretty good results today (lowered cpu usage), with this option enabled.

Perhaps it should become the default?",Dave Täht,2011-08-02 16:59:32.145209,2011-08-11 11:42:55.758252,Dave Täht,Closed,Normal
115,uberwrt,Need SFB packaged up into openwrt,"Need a SFB kernel module package to test SFB with.

It was backported to 2.6.38, just needs to be packeged up",Dave Täht,2011-05-05 23:57:45.536739,2011-07-27 20:17:04.280785,Dave Täht,Closed,Normal
200,cerowrt,Rollup bug notes from uberwrt,"There are many bugs for this project currently in the master 'uberwrt' bug hiearchy. Go there for more details.

bufferbloat.net/projects/uberwrt/issues",Dave Täht,2011-07-10 15:01:54.315319,2011-07-31 15:27:00.972511,Dave Täht,Closed,Normal
254,cerowrt,Changing wifi network ESSID via the GUI does not take effect after save+apply,"The /etc/config/wireless file is updated correctly but the actual ESSIDs being used by the live wifi interfaces are not updated as ""apply"" would suggest.

/sbin/wifi down ; /sbin/wifi up  updates them correctly (but may be a bit of a heavy hammer for the task...)",Gregory P Smith,2011-08-28 00:04:16.993024,2012-04-21 12:49:27.085473,Dave Täht,Closed,Normal
231,cerowrt,Identically configured wireless does not hand out DHCP leases,"I have IPv4 and IPv6 configured for all of the sw00, se10, gw00, and gw10 interfaces.  The 2.4 Ghz public interface does not hand out IPv4 addresses to any clients.  The 2.4 Ghz closed network does not hand out DHCP leases to my iPhone but WILL to my Mac laptop.  The 5 Ghz hands out addresses to my mac.  (iPhone cannot speak 5 Ghz.)

Here is a packet capture from the 2.4 closed interface:

02:51:06.559420 IP 0.0.0.0.68 > 255.255.255.255.67: BOOTP/DHCP, Request from 90:27:e4:52:d3:da, length 300
	0x0000:  4500 0148 09f4 0000 ff11 b0b1 0000 0000  E..H............
	0x0010:  ffff ffff 0044 0043 0134 bc2e 0101 0600  .....D.C.4......
	0x0020:  ae23 3a30 003c 0000 0000 0000 0000 0000  .#:0.<..........
	0x0030:  0000 0000 0000 0000 9027 e452 d3da 0000  .........'.R....
	0x0040:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0100:  0000 0000 0000 0000 6382 5363 3501 0137  ........c.Sc5..7
	0x0110:  0601 0306 0f77 fc39 0205 dc3d 0701 9027  .....w.9...=...'
	0x0120:  e452 d3da 3304 0076 a700 ff00 0000 0000  .R..3..v........
	0x0130:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0140:  0000 0000 0000 0000                      ........

",Michael Graff,2011-08-17 20:25:43.713702,2012-04-21 13:09:50.105711,Dave Täht,Closed,Normal
245,cerowrt,GPT format not understood by mounting tools,it appears that the 'ee' GPT format for disk partitioning is not understood by something - busybox? mount? so that a drive formatted with a recent version of ubuntu is not readable by cerowrt,Dave Täht,2011-08-23 11:06:55.995568,2011-08-23 15:09:48.003573,Dave Täht,Closed,High
236,cerowrt,"""uci changes"" results in errors in default config","Running ""uci changes"" from the command line results in errors in the default config.

The problems are in /etc/config/babeld and /etc/config/debloat.  The first file has a missing ' mark on line 16 (option 'carrier_sense '1') -- missing ' after sense.  The second has 'option' in quotes, which seems to fail to parse.",Michael Graff,2011-08-22 14:04:14.123118,2011-08-23 15:51:21.655406,Dave Täht,Closed,Normal
272,cerowrt,Fwd: multicast really can mess up your whole day [PATCH] ath6kl: pass only unicast frames for aggregation,"multicast really can mess up your whole day.


---------- Forwarded message ----------
From: Kalle Valo <kvalo@qca.qualcomm.com>
Date: Mon, Sep 19, 2011 at 11:38 AM
Subject: [PATCH] ath6kl: pass only unicast frames for aggregation
To: linux-wireless@vger.kernel.org


When pinging form ar6003 to the AP RTT was high even when power save was
disabled:

100 packets transmitted, 97 received, 3% packet loss, time 99125ms
rtt min/avg/max/mdev = 1.875/46.733/795.506/139.181 ms

After some investigation one reason for this was that received
multicast traffic confused the aggrecation logic and caused 400 ms
timeouts when receiving multicast frames from AP.

A simple way to fix is to pass only unicast frames for aggregation. This
improves RTT:

100 packets transmitted, 99 received, 1% packet loss, time 99144ms
rtt min/avg/max/mdev = 2.083/13.084/403.390/56.794 ms

Signed-off-by: Kalle Valo <kvalo@qca.qualcomm.com>
---
 drivers/net/wireless/ath/ath6kl/txrx.c |   16 +++++++++-------
 1 files changed, 9 insertions(+), 7 deletions(-)

diff --git a/drivers/net/wireless/ath/ath6kl/txrx.c
b/drivers/net/wireless/ath/ath6kl/txrx.c
index fffd929..348c646 100644
--- a/drivers/net/wireless/ath/ath6kl/txrx.c
+++ b/drivers/net/wireless/ath/ath6kl/txrx.c
@@ -1230,9 +1230,15 @@ void ath6kl_rx(struct htc_target *target,
struct htc_packet *packet)
                       ath6kl_data_tx(skb1, ar->net_dev);
       }

-       if (!aggr_process_recv_frm(ar->aggr_cntxt, tid, seq_no,
-                                  is_amsdu, skb))
-               ath6kl_deliver_frames_to_nw_stack(ar->net_dev, skb);
+       datap = (struct ethhdr *) skb->data;
+
+       if (is_unicast_ether_addr(datap->h_dest) &&
+           aggr_process_recv_frm(ar->aggr_cntxt, tid, seq_no,
+                                 is_amsdu, skb))
+               /* aggregation code will handle the skb */
+               return;
+
+       ath6kl_deliver_frames_to_nw_stack(ar->net_dev, skb);
 }

 static void aggr_timeout(unsigned long arg)
@@ -1249,10 +1255,6 @@ static void aggr_timeout(unsigned long arg)
               if (!rxtid->aggr || !rxtid->timer_mon || rxtid->progress)
                       continue;

-               /*
-                * FIXME: these timeouts happen quite fruently, something
-                * line once within 60 seconds. Investigate why.
-                */
               stats->num_timeouts++;
               ath6kl_dbg(ATH6KL_DBG_AGGR,
                          ""aggr timeout (st %d end %d)\n"",",David Taht,2011-09-19 12:16:25.716899,2011-11-18 08:21:54.434651,Dave Täht,In Progress,Normal
246,cerowrt,Disabling a interface disables all interfaces on the same radio,"From reading other bug reports I see this is in a ""Don't do that"" status right now. But this should eventually be fixed

I wanted to disable the open CEROwrt-guest and CEROwrt5-guest interfaces while leaving the CEROwrt and CEROwrt5 active.  However if you disable the *-guest interface via the gui then you disable all interfaces for that radio.

",Richard Smith,2011-08-23 12:09:41.777684,2012-04-21 12:48:54.077154,Dave Täht,Closed,Normal
341,cerowrt,"after running overnight, with no server, dibbler-client eats 100% of cpu","dibbler-client sort of worked for me when I had a server feeding it, but
after running overnight, it started consuming 100% of cpu when it 
was not getting an address from anywhere.

",Dave Täht,2012-02-29 12:00:46.305543,2012-04-14 12:14:47.930942,Dave Täht,New,Normal
375,cerowrt,IPv6 frag weirdness in default firewall rules,"
I have something somewhere, mildly busted in the firewall rules for ipv6.

<pre>

[ 3749.867187] IN=ge00 OUT= MAC=a0:21:b7:b0:56:9c:00:11:bc:a5:48:01:86:dd SRC=2001:0500:0071:0000:0000:0000:0000:0030 DST=2001:04f8:0003:0203:0000:0000:0001:0002 LEN=412 TC=0 HOPLIMIT=61 FLOWLBL=0 FRAG:1232 ID:8bef7408 PROTO=UDP 
[ 3843.605468] IN=ge00 OUT= MAC=a0:21:b7:b0:56:9c:00:11:bc:a5:48:01:86:dd SRC=2001:04f8:0000:0002:0000:0000:0000:0019 DST=2001:04f8:0003:0203:0000:0000:0001:0002 LEN=480 TC=0 HOPLIMIT=63 FLOWLBL=0 FRAG:1232 ID:4b003a40 PROTO=UDP 
[ 3943.062500] IN=ge00 OUT= MAC=a0:21:b7:b0:56:9c:00:11:bc:a5:48:01:86:dd SRC=2001:067c:00e0:0000:0000:0000:0000:0004 DST=2001:04f8:0003:0203:0000:0000:0001:0002 LEN=1199 TC=0 HOPLIMIT=60 FLOWLBL=0 FRAG:1232 ID:04ac3b8d PROTO=UDP 
[ 3943.085937] IN=ge00 OUT= MAC=a0:21:b7:b0:56:9c:00:11:bc:a5:48:01:86:dd SRC=2001:067c:00e0:0000:0000:0000:0000:0004 DST=2001:04f8:0003:0203:0000:0000:0001:0002 LEN=1199 TC=0 HOPLIMIT=60 FLOWLBL=0 FRAG:1232 ID:04ac3b8e PROTO=UDP 

</pre>",Dave Täht,2012-04-23 07:20:44.311508,2012-04-23 07:20:44.311508,Dave Täht,New,Normal
269,cerowrt,Performance over the LFN 2,"I started fiddling with tcp's socket params. Over fios and a 85 ms path I get about 10Mbit/sec with a 256k window, going to io.lab.bufferbloat.net, which is the maximum by default you can get out of default sysctl settings

I raised that exorbantly... and got it up to 14Mbit, using westwood+. I don't know what the 


root@bob-desktop:~# add these to /etc/sysctl.conf and do a sysctl -a -p
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
root@bob-desktop:~# exit


exit
d@bob-desktop:~$ iperf -w2m -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 4.00 MByte (WARNING: requested 2.00 MByte)
------------------------------------------------------------
[  4] local 149.20.63.20 port 5001 connected with 149.20.54.82 port 47337
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-60.0 sec  2.92 GBytes   418 Mbits/sec


VERY SHORT PATH above, gigE.

[  5] local 149.20.63.20 port 5001 connected with 71.162.243.5 port 41074
[  5]  0.0-10.5 sec  18.2 MBytes  14.5 Mbits/sec

the 84 ms path above.
",Dave Täht,2011-09-15 22:33:40.692427,2011-11-18 08:50:10.298602,Dave Täht,New,Normal
327,cerowrt,WNDR3700v1 support?,"Sadly, I got one of the older ones, which supposedly have a better wireless antenna than the v2, but also less memory (only 8MiB flash instead of 16).  I know it won't all fit, but once you have the v2 release working and released, is there any chance you can drop some functionality (e.g. web server?) for a v1-compatible release?  Apart from less memory, the v1 is pretty much identical.",Alexander Dupuy,2012-01-15 00:22:45.852245,2012-04-21 12:35:47.78125,Dave Täht,Rejected,Normal
253,cerowrt,Cannot edit a Firewall rule listing multiple ports in the LuCI gui,"Trying to edit a firewall rule in the LuCI gui such as one of the defaults with a Destination of ""Device:0.0.0.0/0:80 53 433 873"" is impossible.

The GUI's javascript form validation rejects the port form field because it is not a single number but has spaces in it.",Gregory P Smith,2011-08-27 14:45:14.318039,2012-04-29 17:46:47.804049,Dave Täht,New,Urgent
408,cerowrt,Problems after reconfiguring wireless using Luci (was Bug #404),"[On 20 Jul 2012, Jim Gettys submitted this report. It was initially numbered Bug #404. In an unsuccessful attempt to remove list spam, I deleted the original ticket, but have re-entered it here -reb]

If I reconfigure the router to use a different channel, and then tell the router to save and apply the new setting, the radio channel gets changed, but after the reconfiguration, I can't get an IP address (until I reboot the router).

Sorta seems like something needs to be restarted that isn't.

I had similar problems changing the ESSID from Luci; the change was applied in the file, but afterwards, I couldn't get an IP address until I rebooted.

--- 
On 21 Jul 2012, Maciej Soltysiak responded...

Hi Jim. I had exactly the same with 3.3.8-10. Had to revert to
previous build. Restarting dhcp didn't help. Bad fw rules perhaps?",Rich Brown,2012-09-08 20:17:50.756173,2012-09-08 20:17:50.756173,Dave Täht,New,Normal
300,cerowrt,wpad might be useful,sanely distributing a wpad.home.lan to the end clients would help.,Dave Täht,2011-11-18 08:56:20.081539,2012-04-21 12:31:51.652673,Dave Täht,New,Normal
297,cerowrt,Document how to cope with ipv6 better,"",Dave Täht,2011-11-18 08:08:54.489977,2011-11-18 08:08:54.489977,Dave Täht,New,Normal
270,cerowrt,CeroWrt should warn users when it is meshed rather than wired or WDS'ed.,"Right now, CeroWrt may, if it has no wired network connection, mesh automatically with other routers.

The router should warn in some visible (but not too obnoxious way) if it is running in this mode: e.g.
a blinking light, and maybe a highlighted text on the status page.

Running meshed if you don't have wired around is fine, but people should be more easily aware of a router that ""just does it right"" as CeroWrt does.",Jim Gettys,2011-09-16 11:38:22.100159,2012-04-21 12:31:53.184819,Dave Täht,New,High
296,cerowrt,UpNP support could use to be configured,"there is some useful statistics (for example, used by various grad student projects) that might be useful.

",Dave Täht,2011-11-18 08:04:55.528706,2012-04-21 12:42:25.391829,Dave Täht,New,Normal
268,cerowrt,polipo's internal resolver seems busted in rc6,"I have tried to convince polipo to work. It has worked only sporadically for 
months now, To try and nail the issue, I configured it to try to talk to
127.0.0.1, ::1, and an external dns resolver to equal ill effect. 

All dns lookups fail when dnsgethostbyname = false.

### SECTION daemon
pidFile = ""/var/run/polipo.pid""
daemonise = true
### SECTION general
dnsNameServer = ""192.168.1.1""
proxyAddress = ""::""
chunkHighMark = 10485760
dnsUseGethostbyname = false
logSyslog = true
allowedClients = ""127.0.0.1"", ""172.16.0.0/12""
### SECTION cache
cacheIsShared = true
### SECTION pmm
### VALUES THAT ARE DISABLED WHEN EMPTY
diskCacheRoot = """"
logFile = """"
Host gw.home.lan lookup failed: Timeout (131072).
",Dave Täht,2011-09-15 22:05:49.416079,2011-11-18 08:57:11.625601,Dave Täht,New,Normal
273,cerowrt,Is 6rd still usable?,"We haven't tested 6rd for a while, and given Comcast not going forward with 6rd, aren't in a good place to test it.  We never did have a UI for Comcast's temporary configuration, either.  6to4, on the other hand, works like a champ on Comcast right now.

If the patches have been lost, please let us know.  Even better, help test 6rd on an ongoing basis.",Jim Gettys,2011-09-20 10:15:19.989606,2012-07-12 21:59:00.454441,Dave Täht,New,Immediate
292,cerowrt,gdisk support,"I was building support for gpt partitioned disks into the kernel. If I'm 
not, I've screwed up.

I wasn't aware that gdisk existed....

Consider it bug reported.",David Taht,2011-10-28 10:03:22.15759,2012-04-21 12:37:42.63397,Dave Täht,Closed,Normal
147,cerowrt,Router doesn't get DHCP address unless it's rebooted,"If the router boots up without a WAN connection, it doesn't get a dhcp address once connected. Needs a reboot.
udhcpc is up, but not working properly.
",Srikanth Sundaresan,2011-05-15 17:46:28.803288,2011-09-20 10:22:37.741149,Dave Täht,New,High
413,cerowrt,dhcpv6 fails to acquire a /60 correctly on a cablemodem,"In testing with a real cablemodem, with a /60 provisioned, only the first was picked up in cerowrt's default configuration.

Furthermore, the wide-dhcp script would assign all the interfaces the same /64 network (modified by the eui-64) 

The attached dhcpv6 capture file shows a trace of the attempted transaction.",David Taht,2012-10-26 07:37:24.174105,2013-04-11 04:16:18.805889,Dave Täht,Closed,High
274,cerowrt,Propagating dhcpv6 prefix delegation,"With the addition of some dhcpv6 client to our overflowing request bucket, we are faced with yet another need to somehow
propagate ipv6 prefixes and related information across the rest of the stack.

dibbler is being built now, which features PD. isc-dhcp has been built for a long time, but the PD version (if available)
would probably require the currently too-HUGE-tu-use isc-dhcp code, and multiple daemons. I have hope that moving PD support into
AHCP would be easy, but that's only hope at this point - and 

Great. Once we have PD - what do we do with it? We have to get names into DNS with nsupdate, and push PD stuff into radvd,
ahcp, babeld, and THEN onto all the interfaces sanely...

and then... if we have additional routers --- get ADDITIONAL PD working inside the network. Sanely. Securely. Etc.

Building dibbler is only the first step. 

(just when we had 6to4 working great)

getting a grip on the work involved in doing PD right *can* be done during rc7 but I had no time budgeted for this.",Dave Täht,2011-09-20 13:14:57.425125,2012-04-21 13:18:23.118644,Dave Täht,In Progress,Normal
410,cerowrt,support for massively popular tp-link devices?,"Hi,
is there any chance to get support for massively popular and cheap tp-link devices based on ar71xx ?
TP-Link wr703 [1]
TP-Link wr741nd [2]
TP-Link wr1043nd [3]

just to name a few

[1] http://wiki.openwrt.org/toh/tp-link/tl-wr703n
[2] http://wiki.openwrt.org/toh/tp-link/tl-wr741nd
[3] http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd",Valent Turkovic,2012-09-25 00:45:00.667281,2013-06-11 13:37:01.148155,Dave Täht,Rejected,Normal
301,cerowrt,Need to arrange for AQM testing and bakeoff....,"We have SFB; it may be buggy right now.

We hope to see RED light; it's vaporware.

We think we'll need some sort of fair queuing as well as AQM; SFQ looks good there...

And QFQ looks even better. ",Jim Gettys,2011-11-18 09:28:39.8182,2011-12-05 03:21:41.051513,Dave Täht,New,High
271,cerowrt,network devices are no longer sources of entropy,"I'm told that network devices are no longer trusted sources of entropy for random number generation,
yet in a router device, there isn't a lot of entropy to be had from elsewhere.

I had hoped that hardware makers would add rngs to their chipsets long ago, they have plenty of sources onchip to tap for essential randomness. But nooo...

lacking essential randomness things like ssh keys, ssl, and wpa wireless encryption become VERY predictable.

See also: https://dev.openwrt.org/ticket/9631#comment:4

What other entropy sources can be used?",Dave Täht,2011-09-17 10:43:45.337202,2014-06-24 20:01:48.654308,Dave Täht,Closed,Urgent
267,cerowrt,DNS doesn't appear to work on some interfaces,"The report:

This is on an 802.11g (sw00) channel, since there seems to be an issue with DNS on the .11a (sw10) channel. Interestingly enough, when I associate with the .11a guest (sw11) channel, the DNS works. (Go figure; would you like me to file a bug report on that?)

I've seen this too. bind9 is supposed to scan the available interfaces every two minutes, and it seems possible to trigger a new scan when a new interface comes up OR have some linux specific monitoring thing (inotify, kernel event?) 

Certainly all the wireless interfaces are not active when named starts...

I also note that this report is AFTER we upgraded to bind 9.8.1....",Dave Täht,2011-09-10 12:58:06.980362,2011-09-17 15:40:54.731092,Dave Täht,Closed,Urgent
204,cerowrt,Better oom-survival overall,"while I have patched xinetd to run with oom=1000, when it forks it cannot seem to reset the oom value of the forked process back to a sane value. (I have not folded this patch into the build yet, because of this)

Secondly, once that actually works, oom-protecting - or not - more stuff would be desirable.

Dropbear could run out of xinetd for sure... rsync already runs out of xinetd, netperf does also but some tests fail on the svn version.

Perhaps git-daemon... 

Definately some sensors...

It would be great of lighttpd could run out of xinetd - or some web server - as you only need the web server running rarely... iperf -s doesn't work out of xinetd either....

nearly every daemon could run out of something like xinetd (I'm not sold on xinetd, or init, but
leaving processes around, unmonitored, is a sure recipe for eventual failure) Monit maybe. systemd and launchd are way too big and overdesigned for this task. ",Dave Täht,2011-07-10 16:06:18.032171,2012-04-21 12:32:48.004007,Dave Täht,In Progress,High
275,cerowrt,"Defaults on factory firmware WNDR3700v2, v1.0.0.10 firmware","I upgraded my ""factory firmware"" box to latest (at this date, 1.0.0.10), did a reset to factory defaults, and here is the result.

We should arrange to adopt these defaults when they make sense, and if not document the differences (for example, we may not want to do ht40 on 2.4ghz).

Router Status


Hardware Version	WNDR3700v2
Firmware Version	V1.0.0.10
GUI Language Version	V1.0.0.67

Internet Port
MAC Address	C4:3D:C7:AF:26:F1
IP Address	192.168.1.24
Connection	DHCP
IP Subnet Mask	255.255.255.224
Domain Name Server	192.168.1.1

LAN Port
MAC Address	C4:3D:C7:AF:26:F0
IP Address	10.0.0.1

Wireless Port
Wireless Settings b/g/n
    Name (SSID)	NETGEAR
    Region	North America
    Channel	Auto ( 1 )
    Mode	Up to 130 Mbps
    Wireless AP	On
    Broadcast Name	On
    Wireless isolation	Off
Wireless Settings a/n
    Name (SSID)	NETGEAR-5G
    Region	North America
    Channel	44(P)+48(S)
    Mode	Up to 300 Mbps
    Wireless AP	On
    Broadcast Name	On
    Wireless isolation	Off
Wi-Fi Protected Setup b/g/n	Not Configured
Wi-Fi Protected Setup a/n	Not Configured

Guest Network
Wireless Settings b/g/n
    Name (SSID)	NETGEAR-Guest
    Wireless AP	Off
    Broadcast Name	On
    Wireless isolation	Off
    Allow guest to access My Local Network	Off
Wireless Settings a/n
    Name (SSID)	NETGEAR-5G-Guest
    Wireless AP	Off
    Broadcast Name	On
    Wireless isolation	Off
    Allow guest to access My Local Network	Off


Advanced Wireless Settings


Advanced Wireless Settings (2.4GHz b/g/n)
Enable Wireless Router Radio 
Fragmentation Length (256-2346)	2346
CTS/RTS Threshold (1-2347) 2347	
Preamble Mode	Automatic
Transmit Power Control	100%

Advanced Wireless Settings (5GHz a/n)
Enable Wireless Router Radio
Fragmentation Length (256-2346)	2346
CTS/RTS Threshold (1-2347) 2347	
Preamble Mode	Automatic
Transmit Power Control	 100%

WPS Settings
Router's PIN:	xxxxxxxx  (8 digit number)
Disable Router's PIN
Keep Existing Wireless Settings (2.4GHz b/g/n)
Keep Existing Wireless Settings (5GHz a/n)


Wireless repeating functions are disabled on both 2.4 and 5

Port forwarding/Port triggering: none enabled by default


WAN Setup


 Disable Port Scan and DoS Protection enabled

 Default DMZ Server	.  .  .   not configured

 Respond to Ping on Internet Port - disabled

MTU Size(in bytes)	1500

NAT Filtering	Secured   Open
 Disable SIP ALG

LAN Setup

Device Name	

LAN TCP/IP Setup
IP Address	10.0.0.1  (router moved off of 192.168.1.1 automatically)
IP Subnet Mask	255.255.255.255
RIP Direction	Both
RIP Version	disabled

 Use Router as DHCP Server
Starting IP Address	10.0.0.2
Ending IP Address	10.0.0.254



QoS Setup


Enable WMM (Wi-Fi multimedia) settings (2.4GHz b/g/n) enabled
Enable WMM (Wi-Fi multimedia) settings (5GHz a/n) enabled

Turn Internet Access QoS On (disabled)

Turn Bandwidth Control On (disabled)
  Uplink bandwidth :    Maximum   (256k)   
  Automatically check Internet Uplink bandwidth :      Kbps     

QoS Priority Rule list    


Dyndns disabled


Static routes - none

Remote Management - disabled


 Turn Remote Management On

Remote Management Address:	http://192.168.1.24:8080

Allow Remote Access By:
Only This Computer:	.  .  .  
IP Address Range:	From  .  .  .  
 	 To  .  .  .  
Everyone

Port Number:


USB Settings


Enable any USB Device connected to the USB port  Yes  No

	
UPnP


 Turn UPnP On  (on)
Advertisement Period(in minutes)	30
Advertisement Time to Live(in hops)	4
 

IPv6 disabled

	Traffic Meter


Internet Traffic Meter
Enable Traffic Meter
Traffic volume control by	
Monthly limit	Mbytes
Round up data volume for each connection by	Mbytes
Connection time control
Monthly limit	hours

Traffic Counter
Restart traffic counter at  :   On the  	 day of each month


Traffic Control
Pop up a warning message
Mbytes/Minutes before the monthly limit is reached
When the monthly limit is reached
Turn the Internet LED to flashing green/amber
Disconnect and disable the Internet connection

Internet Traffic Statistics
Start Date/Time: Thursday Sep 1 00:00:00 2011
Current Date/Time: Thursday Sep 22 09:35:45 2011
Traffic Volume Left: 0
Counting Period	Connection Time
(hh:mm)	Traffic Volume (Mbytes)
Upload/Avg	Download/Avg	Total/Avg
Today	0:1	0.00	0.00	0.00
Yesterday	0:0	0.00	0.00	0.00
This week	0:1	0.00/0.00	0.00/0.00	0.00/0.00
This month	0:1	0.00/0.00	0.00/0.00	0.00/0.00
Last month	0:0	0.00/0.00	0.00/0.00	0.00/0.00
   
 

",Jim Gettys,2011-09-22 11:45:20.67034,2012-04-21 12:37:38.539282,Dave Täht,Closed,High
252,cerowrt,addresses distributed with AHCP appear to be firewalled off (cannot route tcp),"Now that ahcp can work, I started deploying a more complex mesh network, and although routes and dns information (UDP) get through, tcp connections do not.

I am thinking I have one of two problems. One is that the server needs to be configured on fixed ips/thenetmask OR the default firewall rules inside of openwrt are messing things up for the mesh interfaces... or there is something else wrong deeper.

More news as it happens.",Dave Täht,2011-08-27 10:37:43.300149,2011-11-18 09:32:37.436453,Dave Täht,New,Urgent
278,cerowrt,Default to HT40+ mode on 5ghz,"5ghz is much cleaner spectrum than 2.4ghz, so defaulting to ht40+ makes sense.",Dave Täht,2011-09-25 05:01:14.197458,2012-04-21 12:38:24.367939,Dave Täht,Closed,Normal
280,cerowrt,ntp patch for ipv6 dad addresses,"---------- Forwarded message ----------
From: Stephen Hemminger <shemminger@vyatta.com>
Date: Mon, Sep 5, 2011 at 3:45 PM
Subject: Re: [PATCH 1/2] bridge: leave carrier on for empty bridge
To: Ang Way Chuang <wcang@sfc.wide.ad.jp>
Cc: Nicolas de Pesloüan <nicolas.2p.debian@gmail.com>, ""David S.
Miller"" <davem@davemloft.net>, netdev@vger.kernel.org


On Tue, 06 Sep 2011 04:02:12 +0900
Ang Way Chuang <wcang@sfc.wide.ad.jp> wrote:

> On 06/09/11 02:57, Stephen Hemminger wrote:
> > The root cause of the problem is applications that don't deal with unresolved
> > IPv6 addresses. I already had to solve this in our distribution for NTP in a
> > not bridge related problem. It is better to fix the applications to understand
> > IPv6 address semantics than to try and force bridge to behave in a way that
> > is friendly to these applications.
> Care to share the patch that you did for NTP? Perhaps, I may apply the same trick and tried it out on dnsmasq and radvd if I have time.

It has been submitted upstream, but probably an eternity until
it ever gets merged through the NTP project...

The problem happens on our system because NTP runs before interfaces
brought up.



commit 0997ebe40b2835a58ba2ea1e504e38d6d29c95ed
Author: Stephen Hemminger <stephen.hemminger@vyatta.com>
Date:   Tue Oct 26 17:55:04 2010 -0700

   Ignore IPV6 Dynamic addresses

   During boot link-local addresses are generated dynamically.
   These addresses are in a tentative state until after resolution occurs.
   While in the tentative state, the address can not be bound to.
   NTP daemon will see the address become available later when it rescans.

   (revised patch for 4.2.4p6)

diff --git a/lib/isc/unix/interfaceiter.c b/lib/isc/unix/interfaceiter.c
index 87af69e..64a9f4f 100644
--- a/lib/isc/unix/interfaceiter.c
+++ b/lib/isc/unix/interfaceiter.c
@@ -151,6 +151,7 @@ get_addr(unsigned int family, isc_netaddr_t *dst,
struct sockaddr *src,
 static isc_result_t linux_if_inet6_next(isc_interfaceiter_t *);
 static isc_result_t linux_if_inet6_current(isc_interfaceiter_t *);
 static void linux_if_inet6_first(isc_interfaceiter_t *iter);
+#include <linux/if_addr.h>
 #endif

 #if HAVE_GETIFADDRS
@@ -216,6 +217,11 @@ linux_if_inet6_current(isc_interfaceiter_t *iter) {
                             ""/proc/net/if_inet6:strlen(%s) != 32"", address);
               return (ISC_R_FAILURE);
       }
+#ifdef __linux
+       /* Ignore DAD addresses -- can't bind to them till resolved */
+       if (flags & IFA_F_TENTATIVE)
+               return (ISC_R_IGNORE);
+#endif
       for (i = 0; i < 16; i++) {
               unsigned char byte;
               static const char hex[] = ""0123456789abcdef"";",David Taht,2011-09-25 15:26:08.623665,2011-11-18 07:41:12.247014,Dave Täht,New,Normal
279,cerowrt,Fwd: [PATCH] ipv6: nullify ipv6_ac_list and ipv6_fl_list when creating new socket,"---------- Forwarded message ----------
From: Yan, Zheng <zheng.z.yan@intel.com>
Date: Sun, Sep 25, 2011 at 5:21 AM
Subject: [PATCH] ipv6: nullify ipv6_ac_list and ipv6_fl_list when
creating new socket
To: ""netdev@vger.kernel.org"" <netdev@vger.kernel.org>,
""davem@davemloft.net"" <davem@davemloft.net>


ipv6_ac_list and ipv6_fl_list from listening socket are inadvertently
shared with new socket created for connection.

Signed-off-by: Zheng Yan <zheng.z.yan@intel.com>
---
diff --git a/net/ipv6/tcp_ipv6.c b/net/ipv6/tcp_ipv6.c
index 3c9fa61..79cc646 100644
--- a/net/ipv6/tcp_ipv6.c
+++ b/net/ipv6/tcp_ipv6.c
@@ -1383,6 +1383,8 @@ static struct sock * tcp_v6_syn_recv_sock(struct
sock *sk, struct sk_buff *skb,
               newtp->af_specific = &tcp_sock_ipv6_mapped_specific;
 #endif

+               newnp->ipv6_ac_list = NULL;
+               newnp->ipv6_fl_list = NULL;
               newnp->pktoptions  = NULL;
               newnp->opt         = NULL;
               newnp->mcast_oif   = inet6_iif(skb);
@@ -1447,6 +1449,7 @@ static struct sock * tcp_v6_syn_recv_sock(struct
sock *sk, struct sk_buff *skb,
          First: no IPv4 options.
        */
       newinet->inet_opt = NULL;
+       newnp->ipv6_ac_list = NULL;
       newnp->ipv6_fl_list = NULL;

       /* Clone RX bits */",David Taht,2011-09-25 05:26:00.404434,2012-04-21 12:38:25.196945,Dave Täht,Closed,Normal
302,cerowrt,Samba badly needs updating....,"The samba in OpenWrt is antique and unmaintained.

Since we likely need it to help bridge between multiple sub-networks for Windows clients, this is bad... And doesn't support modern authentication methods for window.",Jim Gettys,2011-11-18 09:44:51.827349,2012-04-21 12:38:26.944915,Dave Täht,Closed,Normal
309,cerowrt,Turning off wireless acknowledgements for local tcp connnections,"A crazy idea that I've been nursing for a while has been that the core reason why we do all the retries and acknowledgements in the wireless layer to avoid packet loss is because tcp + wireless over the LFN - 30+ms latencies - works really badly. HOWEVER:

I theorize that local connections (e.g. inside the home) have sufficiently low RTTS for tcp to compensate well for the actual wireless packet loss that is occurring.
(and not only that, deal with congestion much better). Furthermore if fair queuing is applied on streams to stations, the bursty packet loss that is typical of wireless would be minimized.

Now, since we can't depend on the RTT measurement due to bufferbloat, inspecting TTL (for ipv6, that's hopcount) at the Access Point, and turning off mac layer acknowledgements when appropriate may actually work. Nobody mucks very much with hopcount. For a TTL of greater than 61 (for ipv4) and a hopcount of greater than 251 (possibly incorrect, have to check the default for ipv6), the connection is pretty much guaranteed to be very local. 

with acks turned off a good wireless connection would actually run faster in the general case, and recover quicker. On a bad connection, this would provide feedback
much sooner than the heroic measures being taken to get the packets through.

mildly deeper packet inspection (only turning off mac layer acks for tcp streams) might work better. OR, applying the don't ack this frame idea algorithmically,
like red, might work as well.

This idea was inspired by seeing patches go by that make turning off mac layer acks a property of the queue for 802.11e. This would make it a property of the packet...

(and this idea only applies to access points. Turning off mac acks at the station layer, mmm... can't do that based on hopcount.)

Now, everybody sing... with appropriate irony... 'Every packet's sacred...'
",Dave Täht,2011-11-25 01:41:14.928091,2012-04-21 12:42:26.021739,Dave Täht,New,Normal
219,cerowrt,dropbear should run out of xinetd,"I had planned to do this for a while now. Our dropbear is already patched to be runnable out of xinetd, I have half a patch to make xinetd oom-killer aware, and there's half a xinetd sensors package around that locks out people (bots, actually) entirely that attempt telnet to the router.

I feel uncomfortable skipping the oom-killer patch, but as fiddling with dropbear and doing it wrong would be bad, getting dropbear to work out of xinetd first, correctly, strikes me as the least risky, so I MAY given time, move dropbear to xinetd and get the sensors package working
before RC5.
",Dave Täht,2011-08-02 16:58:08.262596,2012-04-21 12:30:17.869337,Dave Täht,Closed,Normal
311,cerowrt,Detecting NAT and firewall rules on an interface is a PITA,"If there is any one place where I have shot myself in the foot hundreds of times this year alone, it's on NAT. I keep plugging things into other things and missing a firewall rule or forgetting to turn off nat, and boom, any routing protocol daemon will get confused by this. 

Merely 'remembering' as the idjit admin involved that interface X is natted is not good enough, at least, not for this idjit.

it would be good if there was a kernel event that a routing daemon could subscribe to, a query, a sysfs file, *some* sort of API that says 'yes, virginia, this interface is natted for ipv4' or 'natted for ipv6', and god help you if you announce any routes over it.

Similarly, being able to detect if a major firewall rule was in place, preventing forwarding in particular, would also help.

While you can do this via scripting, or maybe by linking to the iptables library, that's painfully slow, and there is no 'event' per se' that I know of. Maybe there is, who knows?


this was also sort of discussed on homenet, and when the NAT patches for ipv6 came around, I kind of lost it... ",Dave Täht,2011-11-27 02:44:52.252529,2011-11-27 02:44:52.252529,Dave Täht,New,Urgent
303,cerowrt,Samba badly needs updating....,"The samba in OpenWrt is antique and unmaintained.

Since we likely need it to help bridge between multiple sub-networks for Windows clients, this is bad... And doesn't support modern authentication methods for window.",Jim Gettys,2011-11-18 10:48:01.546199,2012-04-21 13:15:38.951355,Dave Täht,Closed,Normal
334,cerowrt,Package libiwinfo required!,"Using bql-31 (OpenWrt | Attitude Adjustment (r29978))

I clicked the Network tab/Wifi sub tab for the first time, and saw this message (screen shot attached).

---
Package libiwinfo required!
The libiwinfo-lua package is not installed. You must install this component for working wireless configuration!
---

The only packages I had installed are snmpd and fprobe. 

Looking at the packages available, there is libiwinfo, but not libiwinfo-lua.",Rich Brown,2012-02-04 11:13:11.602569,2012-04-21 12:35:48.411257,Dave Täht,Closed,Normal
312,cerowrt,QoS/AQM holy grail much closer to achieved,"https://github.com/dtaht/deBloat/commit/6721d1b0bf5e1113a68d128025c46e7c93fc2c6b

There is a downside, but I'd like savor the above commit for a few hours at least.

This requires iproute 3.0 or later, QFQ in the kernel, probably needs BQL, and doesn't
quite work well enough over the LFN for my taste... but it was quite awesome otherwise.",David Taht,2011-11-28 04:40:00.870855,2011-12-01 03:48:18.1703,Dave Täht,New,Normal
324,cerowrt,BUG: scheduling while atomic: swconfig/1340/0x00000002,"In my quest for lower latency throughout the system, I increased the clock interrupt from 100 to 256, enabled low latency desktop, and wanted to see what bugs I would flush out by doing so.

This is one... I had put down working on the switch last year, in march, after beating the buffering problem on it, or so I thought. I never got around to seeing if the the wfq algorithm on it could be made to work - the early data sheets had glowingly cool stuff on them, the later ones deleted that info, so it seems likely that much of the QoS system on-chip actually doesn't work. That said, finding ways to expose more of the switch's functionality higher up on the stack would be good.

Now, previously, I'd tried for a clock interrupt of 1000, and exposed at least two other bugs elsewhere, this one is new...

<pre>
[   21.792968] se00: link up (1000Mbps/Full duplex)
[   22.691406] ADDRCONF(NETDEV_UP): ge00: link is not ready
[   26.695312] BUG: scheduling while atomic: swconfig/1340/0x00000002
[   26.699218] Modules linked in: gpio_buttons usb_storage ohci_hcd xt_hashlimit ip6t_REJECT ip6t_LOG ip6t_rt ip6t_hbh ip6t_mh ip6t_ipv6header ip6t_frag ip6t_eui64 ip6t_ah ip6table_raw ip6_queue ip6table_mangle ip6table_filter ip6_tables nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_irc nf_conntrack_irc nf_nat_ftp nf_conntrack_ftp xt_HL xt_hl ipt_ECN xt_CLASSIFY xt_time xt_tcpmss xt_statistic xt_mark xt_length ipt_ecn xt_DSCP xt_dscp xt_string xt_layer7 xt_quota xt_pkttype xt_physdev xt_owner ipt_MASQUERADE iptable_nat nf_nat xt_recent xt_helper xt_connmark xt_connbytes pptp xt_conntrack xt_NOTRACK iptable_raw xt_state nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack ehci_hcd sd_mod pppoe pppox ipt_REJECT xt_TCPMSS ipt_LOG xt_comment xt_multiport xt_mac xt_limit iptable_mangle iptable_filter ip_tables xt_tcpudp x_tables ip_gre gre ifb sit tunnel4 tun ppp_async ppp_generic slhc vfat fat ext4 jbd2 mbcache autofs4 ath9k ath9k_common ath9k_hw ath nls_utf8 nls_iso8859_2 nls_iso8859_15 nls_iso8859_13 nls_iso8859_1 nls_cp437 mac80211 usbcore scsi_mod nls_base ts_fsm ts_bm ts_kmp crc16 crc_ccitt ipv6 cfg80211 compat arc4 aes_generic crypto_algapi leds_gpio button_hotplug gpio_keys_polled input_polldev input_core
[   26.804687] Call Trace:
[   26.808593] [<802b1200>] dump_stack+0x8/0x34
[   26.812500] [<802b14a8>] __schedule+0x88/0x540
[   26.816406] [<802b22d4>] schedule_timeout+0x1cc/0x200
[   26.824218] [<80083f88>] msleep+0x20/0x30
[   26.828125] [<801ee05c>] rtl8366s_reset_chip+0x2c/0x90
[   26.832031] [<801ee474>] rtl8366s_sw_reset_switch+0x18/0x74
[   26.835937] [<801e62fc>] swconfig_set_attr+0x1f4/0x258
[   26.843750] [<80233f94>] genl_rcv_msg+0x1d4/0x220
[   26.847656] [<80233304>] netlink_rcv_skb+0x6c/0xe8
[   26.851562] [<80233db0>] genl_rcv+0x24/0x34
[   26.855468] [<80232b58>] netlink_unicast+0x274/0x34c
[   26.863281] [<80232ed4>] netlink_sendmsg+0x2a4/0x334
[   26.867187] [<801fefd0>] sock_sendmsg+0x84/0xa4
[   26.871093] [<801ff25c>] __sys_sendmsg+0x1a4/0x24c
[   26.875000] [<80200af8>] sys_sendmsg+0x48/0x7c
[   26.878906] [<8006a3a4>] stack_done+0x20/0x40
[   26.882812] 
</pre>",Dave Täht,2011-12-17 04:35:32.903806,2012-04-21 12:38:32.955603,Dave Täht,Closed,Normal
313,cerowrt,Per-packet RED in linux would be useful,"Many simulations that I've read tend to use a per packet, rather than per byte, form of RED.

This makes enormous sense in that a version of RED that does it only on bytes barely budges when faced with pure ack packets rather than mixed workloads. And certainly doesn't account very well for asymmetric
bandwidths. 

regrettably, RED in linux is bytes, with an average packet size parameter. Twiddle that number as I may and I don't get particularly good results. So writing/finding a version of red that comes closer to the ns2 model may help.
",Dave Täht,2011-11-29 06:48:07.27361,2011-11-29 06:48:07.27361,Dave Täht,New,Normal
340,cerowrt,massive packet loss on wireless crypto in 3.3-rc4-3,"I am getting 80% packet loss on my attempt to get a 3.3-rc4-3 working at all
on encrypted wireless. the icmpv6 errors are another problem entirely
I'd expect.

[   72.040000] ADDRCONF(NETDEV_CHANGE): gw11: link becomes ready
[  318.320000] icmpv6_send: no reply to icmp error
[  318.320000] icmpv6_send: no reply to icmp error
[  650.040000] icmpv6_send: no reply to icmp error
[  650.040000] icmpv6_send: no reply to icmp error
[ 1291.750000] ath: Failed to stop TX DMA, queues=0x004!
[ 1295.080000] ath: Failed to stop TX DMA, queues=0x00c!
[ 1809.500000] icmpv6_send: no reply to icmp error
[ 1923.970000] icmpv6_send: no reply to icmp error
[ 1923.970000] icmpv6_send: no reply to icmp error
[ 1923.970000] icmpv6_send: no reply to icmp error
root@quintaped:/etc/config#",David Taht,2012-02-29 11:11:15.06095,2012-08-02 23:06:59.508704,Dave Täht,Closed,Normal
400,cerowrt,Fwd: [RFC PATCH] tcp: limit data skbs in qdisc layer,"---------- Forwarded message ----------
From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Wed, Jul 4, 2012 at 6:11 AM
Subject: [RFC PATCH] tcp: limit data skbs in qdisc layer
To: David Miller <davem@davemloft.net>
Cc: Yuchung Cheng <ycheng@google.com>, Dave Taht
<dave.taht@gmail.com>, netdev <netdev@vger.kernel.org>,
codel@lists.bufferbloat.net, Tom Herbert <therbert@google.com>, Matt
Mathis <mattmathis@google.com>, Nandita Dukkipati
<nanditad@google.com>, Neal Cardwell <ncardwell@google.com>, Andrew
McGregor <andrewmcgr@gmail.com>


On Fri, 2012-06-29 at 06:51 +0200, Eric Dumazet wrote:

> My long term plan is to reduce number of skbs queued in Qdisc for TCP
> stack, to reduce RTT (removing the artificial RTT bias because of local
> queues)

preliminar patch to give the rough idea :

sk->sk_wmem_alloc not allowed to grow above a given limit,
allowing no more than ~4 segments [1] per tcp socket in qdisc layer at a
given time. (if TSO is enabled, then a single TSO packet hits the limit)

This means we divert sock_wfree() to a tcp_wfree() handler, to
queue/send following frames when skb_orphan() is called for the already
queued skbs.

Note : While this lowers artificial cwnd and rtt, this means more work
has to be done by tx completion handler (softirq instead of preemptable
process context)

To reduce this possible source of latency, we can skb_try_orphan(skb) in
NIC drivers ndo_start_xmit() instead of waiting TX completion, but do
this orphaning only on BQL enabled drivers, or in drivers known to
possibly delay TX completion (NIU is an example, as David had to revert
BQL because of this delaying)

results on my dev machine (tg3 nic) are really impressive, using
standard pfifo_fast, and with or without TSO/GSO

I no longer have 3MBytes backlogged in qdisc by a single netperf
session, and both side socket autotuning no longer use 4 Mbytes.

tcp_write_xmit() call is probably very naive and lacks proper tests.

Note :

[1] because sk_wmem_alloc accounts skb truesize, mss*4 test allow less
then 4 frames, but it seems ok.

 drivers/net/ethernet/broadcom/tg3.c |    1
 include/linux/skbuff.h              |    6 +++
 include/net/sock.h                  |    1
 net/ipv4/tcp_output.c               |   44 +++++++++++++++++++++++++-
 4 files changed, 51 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/broadcom/tg3.c
b/drivers/net/ethernet/broadcom/tg3.c
index e47ff8b..ce0ca96 100644
--- a/drivers/net/ethernet/broadcom/tg3.c
+++ b/drivers/net/ethernet/broadcom/tg3.c
@@ -7020,6 +7020,7 @@ static netdev_tx_t tg3_start_xmit(struct sk_buff
*skb, struct net_device *dev)

        skb_tx_timestamp(skb);
        netdev_tx_sent_queue(txq, skb->len);
+       skb_try_orphan(skb);

        /* Sync BD data before updating mailbox */
        wmb();
diff --git a/include/linux/skbuff.h b/include/linux/skbuff.h
index 885c9bd..c4d4d15 100644
--- a/include/linux/skbuff.h
+++ b/include/linux/skbuff.h
@@ -1667,6 +1667,12 @@ static inline void skb_orphan(struct sk_buff *skb)
        skb->sk         = NULL;
 }

+static inline void skb_try_orphan(struct sk_buff *skb)
+{
+       if (!skb_shinfo(skb)->tx_flags)
+               skb_orphan(skb);
+}
+
 /**
  *     __skb_queue_purge - empty a list
  *     @list: list to empty
diff --git a/include/net/sock.h b/include/net/sock.h
index 640432a..2ce17b1 100644
--- a/include/net/sock.h
+++ b/include/net/sock.h
@@ -1389,6 +1389,7 @@ extern void release_sock(struct sock *sk);

 /* BH context may only use the following locking interface. */
 #define bh_lock_sock(__sk)     spin_lock(&((__sk)->sk_lock.slock))
+#define bh_trylock_sock(__sk)  spin_trylock(&((__sk)->sk_lock.slock))
 #define bh_lock_sock_nested(__sk) \
                                spin_lock_nested(&((__sk)->sk_lock.slock), \
                                SINGLE_DEPTH_NESTING)
diff --git a/net/ipv4/tcp_output.c b/net/ipv4/tcp_output.c
index c465d3e..4e6ef82 100644
--- a/net/ipv4/tcp_output.c
+++ b/net/ipv4/tcp_output.c
@@ -65,6 +65,8 @@ int sysctl_tcp_slow_start_after_idle __read_mostly = 1;
 int sysctl_tcp_cookie_size __read_mostly = 0; /* TCP_COOKIE_MAX */
 EXPORT_SYMBOL_GPL(sysctl_tcp_cookie_size);

+static bool tcp_write_xmit(struct sock *sk, unsigned int mss_now, int nonagle,
+                          int push_one, gfp_t gfp);

 /* Account for new data that has been sent to the network. */
 static void tcp_event_new_data_sent(struct sock *sk, const struct sk_buff *skb)
@@ -783,6 +785,34 @@ static unsigned int
tcp_established_options(struct sock *sk, struct sk_buff *skb
        return size;
 }

+/*
+ * Write buffer destructor automatically called from kfree_skb.
+ */
+void tcp_wfree(struct sk_buff *skb)
+{
+       struct sock *sk = skb->sk;
+       unsigned int len = skb->truesize;
+
+       atomic_sub(len - 1, &sk->sk_wmem_alloc);
+       if (bh_trylock_sock(sk)) {
+               if (!sock_owned_by_user(sk)) {
+                       if ((1 << sk->sk_state) &
+                           (TCPF_CLOSE_WAIT | TCPF_ESTABLISHED))
+                               tcp_write_xmit(sk,
+                                              tcp_current_mss(sk),
+                                              0, 0,
+                                              GFP_ATOMIC);
+               } else {
+                       /* TODO : might signal something here
+                        * so that user thread can call tcp_write_xmit()
+                        */
+               }
+               bh_unlock_sock(sk);
+       }
+
+       sk_free(sk);
+}
+
 /* This routine actually transmits TCP packets queued in by
  * tcp_do_sendmsg().  This is used by both the initial
  * transmission and possible later retransmissions.
@@ -844,7 +874,11 @@ static int tcp_transmit_skb(struct sock *sk,
struct sk_buff *skb, int clone_it,

        skb_push(skb, tcp_header_size);
        skb_reset_transport_header(skb);
-       skb_set_owner_w(skb, sk);
+
+       skb_orphan(skb);
+       skb->sk = sk;
+       skb->destructor = tcp_wfree;
+       atomic_add(skb->truesize, &sk->sk_wmem_alloc);

        /* Build TCP header and checksum it. */
        th = tcp_hdr(skb);
@@ -1780,6 +1814,14 @@ static bool tcp_write_xmit(struct sock *sk,
unsigned int mss_now, int nonagle,
        while ((skb = tcp_send_head(sk))) {
                unsigned int limit;

+               /* yes, sk_wmem_alloc accounts skb truesize, so mss_now * 4
+                * is a lazy approximation of our needs, but it seems ok
+                */
+               if (atomic_read(&sk->sk_wmem_alloc) >= mss_now * 4) {
+                       pr_debug(""here we stop sending frame because
sk_wmem_alloc %d\n"",
+                               atomic_read(&sk->sk_wmem_alloc));
+                       break;
+               }
                tso_segs = tcp_init_tso_segs(sk, skb, mss_now);
                BUG_ON(!tso_segs);",David Taht,2012-07-05 09:12:55.593565,2013-04-11 04:26:21.528318,Dave Täht,Closed,Normal
345,cerowrt,500 error on Traffic Rules page,"Using CeroWrt 3.3-rc7-5 on WNDR3700v2... I installed without incident, and was clicking around through the tabs and observed this problem on the Network -> Firewall -> Traffic Rules page. The message says:

---
This page contains the following errors:
error on line 261 at column 57: expected '>'
Below is a rendering of the page up to the first error.
---",Rich Brown,2012-03-16 18:53:46.68235,2012-04-19 23:50:24.465278,Dave Täht,Closed,Normal
335,cerowrt,Performance regression with rc6 vs bql-34,"I had at one point (or so I recall) been able to coax 400+Mbit out of the router in packet forwarding
performance. Exactly how I did that, it was back in august, and I was using higher
end servers and cards then than I am now.

With bql-34 and my current setup I get only 124Mbit in forwarding performance between two laptops
with bql on them. This is with kernel 3.2.5 with bql backported.

It isn't the new qdiscs. 

I regressed to rc6 and tried again, only to get 183Mbit that way, using iperf.
rc6 was 3.0.4 based. 

Admittedly I spend most of my time trying to get good 4 mbit performance, but I do 
find this puzzling and this strongly indicates a need for a new oprofile.

I am also crashing the router with heavy wireless traffic.",Dave Täht,2012-02-07 14:21:22.693773,2012-04-21 12:35:49.23767,Dave Täht,Closed,Normal
305,cerowrt,Cerowrt needs a good default set of queueing disciplines enabled (PFIFO_FAST MUST DIE),"Probably the biggest new thing in rc8 is going to be all the interfaces will be running some non-default qdisc by default, or so I hope.

To start off with wireless - there is no qdisc that is really appropo at this time. Work is in progress towards abstracting out enough stuff to make an aggregatable qdisc but I expect that work to take 6 months or more longer to even show a plausible result, much less

Of the choices available... SFQ has properties that are pretty compatible with packet aggregation in wireless-n, and does not do too much harm to wireless-g (or so I think), and I have been using that for several months now with no other ill effects noted. The usually less-than-desirable property of SFQ is that it can bunch up to 16 packets up and not be entirely 'fair' that way. This is basically what we want, actually, when we aggregate packets.

I am explicitly filtering out multicast macs and making sure they end up in the VO queue so they don't confuse SFQ as much.(presently multicast in MAC80211 gets figured out after it hits the driver, rather than before it hits the qdiscs)

I also have mods in there to do better DSCP level classification (since rc5), and if I can finish it, I have an 'ANT' classifier as well that I'll stick in there. The net effect of these two classifiers is to toss more real-time requiring (but short) stuff into the VI queue. It's my hope that I can push both the dscp and ant things upstream after rc8 is done, also. So what I think is going to happen on the gw00 gw10 sw00 sw10 interfaces is 3 SFQ qdiscs on VI, BE, and BK - and I might either do pfifo_head_drop on VO or QFQ + head drop on VO. gw01 and g11 I haven't decided on as presently packets can't be aggregated there and I'm in love with QFQ....

As for ethernet, I've proven that I can run QFQ and QFQ + RED at rates that seem thus far indistinguishable from pfifo_fast from a cpu perspective. 

so either they aren't working... or they are pretty fast... more to come on that.

So the internal ethernet interface is going to be QFQ for sure, but I don't see much point in red there at present. The external interface... well... let me do that in a different bug.....",Dave Täht,2011-11-24 12:24:20.758782,2012-05-17 17:44:51.799497,Dave Täht,Closed,Urgent
373,cerowrt,EF traffic doesn't end up in VO,"CS7 traffic ends up in VO. EF ends up in VI. This kind of makes sense
but I might argue for VI for EF.",Dave Täht,2012-04-21 12:18:12.505266,2012-07-12 21:58:12.47428,Dave Täht,Closed,Normal
310,cerowrt,BQL patch fails on 3.1.1,"Same patch works on same kernel version, must be a problem with a .config conflict

make[5]: Entering directory `/home/cero1/src/cerowrt/build_dir/linux-ar71xx_generic/linux-3.1.1'
  CHK     include/linux/version.h
  CHK     include/generated/utsrelease.h
  CALL    scripts/checksyscalls.sh
  CHK     include/generated/compile.h
  CC      net/core/net-sysfs.o
net/core/net-sysfs.c: In function 'netdev_queue_attr_show':
net/core/net-sysfs.c:803:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c:803:31: warning: type defaults to 'int' in declaration of '__mptr'
net/core/net-sysfs.c:803:31: warning: initialization from incompatible pointer type
net/core/net-sysfs.c:803:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c: In function 'netdev_queue_attr_store':
net/core/net-sysfs.c:816:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c:816:31: warning: type defaults to 'int' in declaration of '__mptr'
net/core/net-sysfs.c:816:31: warning: initialization from incompatible pointer type
net/core/net-sysfs.c:816:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c: In function 'netdev_queue_release':
net/core/net-sysfs.c:1194:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c:1194:31: warning: type defaults to 'int' in declaration of '__mptr'
net/core/net-sysfs.c:1194:31: warning: initialization from incompatible pointer type
net/core/net-sysfs.c:1194:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c: In function 'netdev_queue_add_kobject':
net/core/net-sysfs.c:1213:31: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c:1216:18: error: 'struct net_device' has no member named 'queues_kset'
net/core/net-sysfs.c: In function 'netdev_queue_update_kobjects':
net/core/net-sysfs.c:1258:28: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c:1260:21: error: 'struct netdev_queue' has no member named 'kobj'
net/core/net-sysfs.c: In function 'register_queue_kobjects':
net/core/net-sysfs.c:1274:5: error: 'struct net_device' has no member named 'queues_kset'
net/core/net-sysfs.c:1276:10: error: 'struct net_device' has no member named 'queues_kset'
net/core/net-sysfs.c: In function 'remove_queue_kobjects':
net/core/net-sysfs.c:1315:21: error: 'struct net_device' has no member named 'queues_kset'
make[7]: *** [net/core/net-sysfs.o] Error 1
make[6]: *** [net/core] Error 2
make[5]: *** [net] Error 2
make[5]: Leaving directory `/home/cero1/src/cerowrt/build_dir/linux-ar71xx_generic/linux-3.1.1'
make[4]: *** [/home/cero1/src/cerowrt/build_dir/linux-ar71xx_generic/linux-3.1.1/.image] Error 2
make[4]: Leaving directory `/home/cero1/src/cerowrt/target/linux/ar71xx'
make[3]: *** [install] Error 2
make[3]: Leaving directory `/home/cero1/src/cerowrt/target/linux'
make[2]: *** [target/linux/install] Error 2
make[2]: Leaving directory `/home/cero1/src/cerowrt'
make[1]: *** [/home/cero1/src/cerowrt/staging_dir/target-mips_r2_uClibc-0.9.32/stamp/.target_install] Error 2
make[1]: Leaving directory `/home/cero1/src/cerowrt'
",Dave Täht,2011-11-25 08:31:20.858918,2012-04-21 12:38:29.060786,Dave Täht,Closed,Normal
304,cerowrt,TCP timestamping is turned off by default in openwrt/cerowrt,"This gives delay sensitive tcp algorithms such as westwood+ nothing to work with.

I've been wondering for months why westwood didn't seem to do anything differently than cubic
even in cases where it should like at 200+ ms RTTs. This is probably why.

",Dave Täht,2011-11-24 11:57:53.583601,2012-04-18 14:26:04.175897,Dave Täht,In Progress,Urgent
379,cerowrt,3.3.4-3 router crashes under heavy load,"So I started doing long duration, heavy access tests, driving things
with my fastest three boxes,
crypted and unencrypted wireless, and two machines driving through the
internal ethernet at
gigE speeds.

after about 200 sec of heavy load, the router resets. Also in the
general case it becomes hard to get a connection to the webserver for
(example) streaming audio, and ssh won't start due to the loadavg
(have to fix that in xinetd), and dns starts acting up and babeld
stops transmitting routes

Now, this is truly abnormal use - 250+Mbits going through the router
full time rather than 20Mbit or so.

So far this is ipv4 only. I was mostly testing ipv6 and fairly short
(60 second) durations and mostly
ethernet before now.

Things tried:

0) reducing the watchdog time to reset to 1 second rather than 5. This
seemed to help somewhat, but I'm going to rule it out.

1) turning off the qdiscs. This was mildly amusing as I was perturbed
by seeing ping times go from .2sec to 20 or 30ms on GigE with
pfifo_fast. It's been a long time since these puppies were configured
as drop tail systems.

Anyway, still crashes. So I think we can regard the aqm system as
solid. Finally.

I do want to turn hoq-sfq off for further tests, tho.

3) bumping up BQL. Performance improves slightly, still crashes.

4) Not using the wireless at all. So far it's survived 2000 seconds of
abuse, pounding 250+Mbit of ipv4 through it,
from 5 streams from two boxes.

So things point at some interaction with wireless.

theories are:

hostapd can't get enough cpu time to run
the rngd daemon can't get enough cpu time to run
we have a memory leak somewhere in the wireless stack

For the longest time I've had this thing running at HZ_256. Anyway I'm
going to leave ethernet loaded up overnight, then try wireless all by
itself for a few hours.

I have other fish to fry right now.",David Taht,2012-04-30 02:36:17.262966,2014-06-24 19:59:49.717453,Dave Täht,Closed,Urgent
320,cerowrt,Dropping web10g from cerowrt,"Web10g measures all sorts of per-connection tcp statistics that are
otherwise very hard to get at.

http://www.web10g.org/

I have had this patch in the cerowrt kernel for a while and despite
fiddling with it, most of what it attempts to measure is thus far not
useful for bufferbloat, and I can get most of that with a userspace
tool such as netperf and/or some hooks in the kernel.

Now, maybe it can be made useful, but it tinkles all over the tcp fast
path, requires maintenance, and I just don't feel like porting it
forward to 3.1 or 3.2, or waiting for someone else to do so. In
theory, it looked good. In reality, it's hard to care.

I'm glad I tried it, I'm glad that it's out there and I could try it
again, but I'd just as soon live without it.

If jacobo has found a use for it, I'm all ears.",David Taht,2011-12-08 05:04:28.31969,2012-04-21 12:38:30.082552,Dave Täht,Closed,Normal
428,cerowrt, Cerowrt 3.7.5-2 doesn't have openvpn,It's not part of the image or built as a package.,David Personette,2013-03-11 10:35:22.124133,2013-04-11 04:14:25.382182,Dave Täht,Closed,Normal
325,cerowrt,Fwd: Kernel-DOS error in arp mechanism – no delete  off incomplete arp adresses,"---------- Forwarded message ----------
From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Wed, Dec 21, 2011 at 10:51 AM
Subject: Re: Kernel-DOS error in arp mechanism – no delete off
incomplete arp adresses
To: David Miller <davem@davemloft.net>
Cc: richard.weinberger@gmail.com, gladewitz@gmx.de,
linux-kernel@vger.kernel.org, netdev@vger.kernel.org


Le mercredi 21 décembre 2011 à 03:07 -0500, David Miller a écrit :
> From: Eric Dumazet <eric.dumazet@gmail.com>
> Date: Wed, 21 Dec 2011 08:44:27 +0100
>
> > David, I suggest we add back the garbage collector for current kernels,
> > we'll remove it when route cache really disappear ?
> >
> > I'll send a patch today.
>
> Yes, it's the best idea.
>
> We can actually remove it again as early as when when route neigh's
> are ref-less.

Here is the patch I successfully tested in the neighbour stress
situation. This is a stable candidate (2.6.39+)

Thanks !

[PATCH] ipv4: reintroduce route cache garbage collector

Commit 2c8cec5c10b (ipv4: Cache learned PMTU information in inetpeer)
removed IP route cache garbage collector a bit too soon, as this gc was
responsible for expired routes cleanup, releasing their neighbour
reference.

As pointed out by Robert Gladewitz, recent kernels can fill and exhaust
their neighbour cache.

Reintroduce the garbage collection, since we'll have to wait our
neighbour lookups become refcount-less to not depend on this stuff.

Reported-by: Robert Gladewitz <gladewitz@gmx.de>
Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
---
 net/ipv4/route.c |  107 +++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 107 insertions(+)

diff --git a/net/ipv4/route.c b/net/ipv4/route.c
index 46af623..252c512 100644
--- a/net/ipv4/route.c
+++ b/net/ipv4/route.c
@@ -120,6 +120,7 @@

 static int ip_rt_max_size;
 static int ip_rt_gc_timeout __read_mostly      = RT_GC_TIMEOUT;
+static int ip_rt_gc_interval __read_mostly  = 60 * HZ;
 static int ip_rt_gc_min_interval __read_mostly = HZ / 2;
 static int ip_rt_redirect_number __read_mostly = 9;
 static int ip_rt_redirect_load __read_mostly   = HZ / 50;
@@ -133,6 +134,9 @@ static int ip_rt_min_advmss __read_mostly   = 256;
 static int rt_chain_length_max __read_mostly   = 20;
 static int redirect_genid;

+static struct delayed_work expires_work;
+static unsigned long expires_ljiffies;
+
 /*
 *     Interface to generic destination cache.
 */
@@ -830,6 +834,97 @@ static int has_noalias(const struct rtable *head,
const struct rtable *rth)
       return ONE;
 }

+static void rt_check_expire(void)
+{
+       static unsigned int rover;
+       unsigned int i = rover, goal;
+       struct rtable *rth;
+       struct rtable __rcu **rthp;
+       unsigned long samples = 0;
+       unsigned long sum = 0, sum2 = 0;
+       unsigned long delta;
+       u64 mult;
+
+       delta = jiffies - expires_ljiffies;
+       expires_ljiffies = jiffies;
+       mult = ((u64)delta) << rt_hash_log;
+       if (ip_rt_gc_timeout > 1)
+               do_div(mult, ip_rt_gc_timeout);
+       goal = (unsigned int)mult;
+       if (goal > rt_hash_mask)
+               goal = rt_hash_mask + 1;
+       for (; goal > 0; goal--) {
+               unsigned long tmo = ip_rt_gc_timeout;
+               unsigned long length;
+
+               i = (i + 1) & rt_hash_mask;
+               rthp = &rt_hash_table[i].chain;
+
+               if (need_resched())
+                       cond_resched();
+
+               samples++;
+
+               if (rcu_dereference_raw(*rthp) == NULL)
+                       continue;
+               length = 0;
+               spin_lock_bh(rt_hash_lock_addr(i));
+               while ((rth = rcu_dereference_protected(*rthp,
+
lockdep_is_held(rt_hash_lock_addr(i)))) != NULL) {
+                       prefetch(rth->dst.rt_next);
+                       if (rt_is_expired(rth)) {
+                               *rthp = rth->dst.rt_next;
+                               rt_free(rth);
+                               continue;
+                       }
+                       if (rth->dst.expires) {
+                               /* Entry is expired even if it is in use */
+                               if (time_before_eq(jiffies, rth->dst.expires)) {
+nofree:
+                                       tmo >>= 1;
+                                       rthp = &rth->dst.rt_next;
+                                       /*
+                                        * We only count entries on
+                                        * a chain with equal hash inputs once
+                                        * so that entries for different QOS
+                                        * levels, and other non-hash input
+                                        * attributes don't unfairly skew
+                                        * the length computation
+                                        */
+                                       length +=
has_noalias(rt_hash_table[i].chain, rth);
+                                       continue;
+                               }
+                       } else if (!rt_may_expire(rth, tmo, ip_rt_gc_timeout))
+                               goto nofree;
+
+                       /* Cleanup aged off entries. */
+                       *rthp = rth->dst.rt_next;
+                       rt_free(rth);
+               }
+               spin_unlock_bh(rt_hash_lock_addr(i));
+               sum += length;
+               sum2 += length*length;
+       }
+       if (samples) {
+               unsigned long avg = sum / samples;
+               unsigned long sd = int_sqrt(sum2 / samples - avg*avg);
+               rt_chain_length_max = max_t(unsigned long,
+                                       ip_rt_gc_elasticity,
+                                       (avg + 4*sd) >> FRACT_BITS);
+       }
+       rover = i;
+}
+
+/*
+ * rt_worker_func() is run in process context.
+ * we call rt_check_expire() to scan part of the hash table
+ */
+static void rt_worker_func(struct work_struct *work)
+{
+       rt_check_expire();
+       schedule_delayed_work(&expires_work, ip_rt_gc_interval);
+}
+
 /*
 * Perturbation of rt_genid by a small quantity [1..256]
 * Using 8 bits of shuffling ensure we can call rt_cache_invalidate()
@@ -3179,6 +3274,13 @@ static ctl_table ipv4_route_table[] = {
               .proc_handler   = proc_dointvec_jiffies,
       },
       {
+               .procname       = ""gc_interval"",
+               .data           = &ip_rt_gc_interval,
+               .maxlen         = sizeof(int),
+               .mode           = 0644,
+               .proc_handler   = proc_dointvec_jiffies,
+       },
+       {
               .procname       = ""redirect_load"",
               .data           = &ip_rt_redirect_load,
               .maxlen         = sizeof(int),
@@ -3388,6 +3490,11 @@ int __init ip_rt_init(void)
       devinet_init();
       ip_fib_init();

+       INIT_DELAYED_WORK_DEFERRABLE(&expires_work, rt_worker_func);
+       expires_ljiffies = jiffies;
+       schedule_delayed_work(&expires_work,
+               net_random() % ip_rt_gc_interval + ip_rt_gc_interval);
+
       if (ip_rt_proc_init())
               printk(KERN_ERR ""Unable to create route proc files\n"");
 #ifdef CONFIG_XFRM",David Taht,2011-12-21 02:54:13.771467,2012-12-10 09:42:16.72055,Dave Täht,Closed,Normal
403,cerowrt,"bug in /etc/hotplug.d/firewall/10-nat-reflection breaks ""NAT loopback""","Since the interface naming convention in CeroWrt defines the interfaces based on their class e.g. 'ge00' instead of 'wan', the default NAT reflection helper script fails to function.  There is a simple fix (thanks to jow who helped me discover this on #bufferbloat)

edit the nat-reflection script:
<pre>
vi /etc/hotplug.d/firewall/10-nat-reflection
</pre>replace the first two occurences of ""wan"" with ""ge00""
save & exit, then issue:
<pre>ifup ge00</pre>

I tested this on my wndr3800 running 3.3.8-11 and it worked.  Didn't do extensive testing but I tested several DNAT port-forwards from both inside & outside of the NAT to services hosted on the se00 (lan) side and everything seemed to work as expected.",Luke H,2012-07-18 07:39:11.281845,2012-12-24 03:15:14.386391,Dave Täht,New,Normal
356,cerowrt,ipv6 support for buildbot,"It would be helpful if buildbot supported ipv6. In particular it gets rid of nat needed for a build cluster and other single points of failure. Progress appears to being made.

http://twistedmatrix.com/trac/query?col=id&col=summary&col=status&col=branch&col=changetime&keywords=~ipv6&order=priority",Dave Täht,2012-04-08 07:33:06.20375,2012-04-08 07:33:06.20375,Dave Täht,New,Normal
321,cerowrt,ar71xx architecture needs to move into the kernel mainline,"we are using what is now a very stable, well tested, complete, set of patches for the ar71xx mips architecture. As are 34 other machine types. These patches are all currently out of tree, and trying to move forward in closer sync with the mainline kernel is a PITA. It wasn't so bad until recently, but there has been a lot of churn in the stack in the 3.1 to 3.2 transition is making it hard to move forward. 

... And it's good, bufferbloat related churn, that we want to take advantage of.

There are a ton of drivers  (and at least two duplicates) in the current patch set. The biggest problem in getting it into the kernel is that how machines are handled needs to adopt device tree support across the board, as Felix writes here:

""I think it does not make much sense to try to integrate the code from
our ar71xx into ath79 and pushing that upstream. The mips-machine way of
supporting different boards with one kernel is somewhat cumbersome, a
much better way to deal with it is adding device tree support and using
that. Proper device tree support is currently being worked on for the
lantiq target. Once that's functional, I'll look into adapting it to
ath79 as well.""

What caused me to throw in the towel on getting rc7 out the door was that the move from 3.0 to 3.1 broke stuff, and the move to 3.2 was going to break it badly. 

So a step back to do the engineering right here would be helpful.

(and personally, after going from kernel 2.6.37 to 3.1 over the course of this project, I'm really tired of having all these patches to deal with, that are very basic in many respects. What breaks most of the time is merely the Kconfig and Makefiles)

If we want to stay in sync with the kernel and move forward more rapidly in sync with it, spending some time to get more of this stuff in the kernel would be best. Bits and pieces of various drivers could go in incrementally... and I'd like to be thinking about exposing QoS features in, for example, the switch, better than they are now. 

There are presently 63 ar71xx specific patches required to build openwrt/cerowrt for the ar71xx, and that doesn't count the 160 machine and driver specific out of tree files.  

I would like to have a grip and a estimate on the scope of this part of the project, as for the time and costs involved. I have a very good idea how much it costs *not* to do it, at this point.",Dave Täht,2011-12-08 11:05:10.829329,2012-04-21 12:42:27.313253,Dave Täht,New,High
322,cerowrt,Testing BQL should happen in openwrt mainline,"BQL's concept is simple and profound enough for others to test in mainline openwrt. 

I need to stress that all BQL does at present is move the bufferbloat problem out of the 
ethernet drivers and into the packet schedulers, where more packet bursts need to be shredded than
what the default pfifo_fast scheduler can do. 

Also: BQL's controller kind of bothers me, but applying hard limits to the amount of bytes in flight
worked well, in testing an earlier version.

Needed are:

* ar71xx working on 3.1.5 - which will contain a fix to RED 
* BQL backport to 3.1.5 (I did v3, someone else is doing v4)
* BQL driver support for selected devices (ag71xx) (done, untested)
* Building openwrt with QFQ support in the scheduler (DRR is good too) (patches in cerowrt, currently)
* update to iproute2 to at least the 3.0 level to get QFQ support (also patches in cerowrt, currently)
* Scripts to engage TC and things like QFQ, SFQ, etc on top of line rate and HTB (deBloat.git)

All these patches are floating in loose formation. The ar71xx 3.1 backport arrived this morning...

Useful will be - closely tracking eric dumazet's adaptive red work (which is now in net-next and can also be easily backported), as well as the related iproute2 changes - 

most useful of all, for wireless, will be the upcoming 'time in queue' set of ideas, which affect the kernel and iproute as well. 

That said, I think all the ideas are promising enough to actually do inside of openwrt, with the help of everyone expending enthusiasm on it all right now, and we will get better and more interesting results, faster.

Doing further work on these exciting bits merely inside of cerowrt would be self limiting.",Dave Täht,2011-12-08 23:30:27.988963,2012-04-21 13:14:00.406975,Dave Täht,Closed,Urgent
371,cerowrt,route table updates perturbed by alignment errors,"While this is an artifact of bug #360 it begins to explain trouble
I've had all year with ipv6, ipv4 (to some extent) and routing.

It also explains the trouble I had with running a lot of filters in
the qfq qdisc, and now that I'm running sfq all the time, was showing up here.

Basically, trapping in the middle of a string of route updates is really bad
on the route table, often forcing a stream to halt entirely, and reset. 
That too was hard to see until we were running fast enough to hit the keyhole window.




<pre>
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] [<831d5aa8>] ipv6_setsockopt+0x118/0x444 [ipv6]
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] [<831cfbdc>] ip6_ins_rt+0x2a0/0x454 [ipv6]
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] 
--
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] [<831d5acc>] ipv6_setsockopt+0x13c/0x444 [ipv6]
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] [<831cfbdc>] ip6_ins_rt+0x2a0/0x454 [ipv6]
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] 
--
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] [<831d5ad8>] ipv6_setsockopt+0x148/0x444 [ipv6]
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] [<831cfbdc>] ip6_ins_rt+0x2a0/0x454 [ipv6]
Apr 20 19:55:06 OpenWrt kern.alert kernel: [ 7158.578125] 
--
Apr 20 19:55:23 OpenWrt kern.alert kernel: [ 7175.203125] [<831d5ab0>] ipv6_setsockopt+0x120/0x444 [ipv6]
Apr 20 19:55:23 OpenWrt kern.alert kernel: [ 7175.203125] 

</pre>

",Dave Täht,2012-04-20 12:58:21.7181,2012-04-30 03:03:21.813224,Dave Täht,New,Normal
418,cerowrt,TFO crashes cerowrt 3.7.1-1,"I am not able to get through even a single TCP TFO connection. The router restarts as soon as it sees the TFO connection.

Looks like SYN+Data is crashing the box (see attached trace captured on lo iface of cero). logread, dmesg did not show anything. I don't know whether its kernel panic.

This is strange as 3.6 was working for SYN+Data cases.

However the difference from previous instance is the polipo server with TFO running on cero box. Client may run on same cero or on my laptop which in either case crashes the box.

On 3.7, if I run the TFO client on cero box and TFO server on the laptop, it still works but not the reverse.

(see email thread at: https://lists.bufferbloat.net/pipermail/cerowrt-devel/2013-January/000844.html for more details)",David Taht,2013-01-04 19:02:14.792466,2014-05-14 11:35:21.899066,Dave Täht,Closed,Normal
359,cerowrt,Fwd: [PATCH] tcp: fix tcp_rcv_rtt_update() use of an unscaled RTT sample,"---------- Forwarded message ----------
From: David Miller <davem@davemloft.net>
Date: Tue, Apr 10, 2012 at 11:47 AM
Subject: Re: [PATCH] tcp: fix tcp_rcv_rtt_update() use of an unscaled RTT sample
To: ncardwell@google.com
Cc: netdev@vger.kernel.org, nanditad@google.com, ycheng@google.com,
edumazet@google.com, therbert@google.com


From: Neal Cardwell <ncardwell@google.com>
Date: Tue, 10 Apr 2012 13:59:20 -0400

> Fix a code path in tcp_rcv_rtt_update() that was comparing scaled and
> unscaled RTT samples.
>
> The intent in the code was to only use the 'm' measurement if it was a
> new minimum.  However, since 'm' had not yet been shifted left 3 bits
> but 'new_sample' had, this comparison would nearly always succeed,
> leading us to erroneously set our receive-side RTT estimate to the 'm'
> sample when that sample could be nearly 8x too high to use.
>
> The overall effect is to often cause the receive-side RTT estimate to
> be significantly too large (up to 40% too large for brief periods in
> my tests).
>
> Signed-off-by: Neal Cardwell <ncardwell@google.com>

Applied, thanks.",David Taht,2012-04-10 13:45:29.942252,2012-04-19 23:43:55.360944,Dave Täht,Closed,Normal
291,cerowrt,WNDR3800 looks like an WNDR3700v2,"Luci and /proc/cpuinfo reports WNDR3800 as an WNDR3700v2. This is probably a won't fix bug.

cat /proc/cpuinfo                                                                               
system type             : Atheros AR7161 rev 2                                                                 
machine                 : NETGEAR WNDR3700v2
processor               : 0                                                                                    
cpu model               : MIPS 24Kc V7.4                                                                       
BogoMIPS                : 452.19                                                                               
wait instruction        : yes                                                                                  
microsecond timers      : yes                                                                                  
tlb_entries             : 16
extra interrupt vector  : yes                                                                                  
hardware watchpoint     : yes, count: 4, address/irw mask: [0x0000, 0x03c0, 0x07b8, 0x0380]                    
ASEs implemented        : mips16                                                                               
shadow register sets    : 1                                                                                    
kscratch registers      : 0                                                                                    
core                    : 0
VCED exceptions         : not available                                                                        
VCEI exceptions         : not available                                                                            ",Petri Rosenström,2011-10-27 07:14:51.461249,2012-04-21 12:37:40.78682,Dave Täht,Closed,Low
421,cerowrt,More unaligned access traps in CeroWRT 3.7.2,"After running the CeroWRT 3.7.2-3 build overnight with unaligned_action=2, I found two new unaligned access traps that were causing problems.

The first is in tcp_v6_syn_recv_sock, and appears to be tclass-related:

<pre>
[74530.100000] Cpu 0
[74530.100000] $ 0   : 00000000 00000001 86b5f83e 00000000
[74530.100000] $ 4   : 85c83480 000005dc 00000000 00000000
[74530.110000] $ 8   : 00000000 00000000 0000ffff ac1e2a01
[74530.110000] $12   : 00000000 00000000 00000000 00000000
[74530.120000] $16   : 85c83910 85c83480 00000000 86b6a840
[74530.130000] $20   : 00000000 85c81500 85fae240 85c81990
[74530.130000] $24   : 00000000 80232e24                  
[74530.140000] $28   : 80324000 80325b48 8033e190 86ca5d98
[74530.140000] Hi    : 00000000
[74530.140000] Lo    : 00000000
[74530.150000] epc   : 86ca5de8 tcp_v6_syn_recv_sock+0x11c/0x468 [ipv6]
[74530.150000]     Tainted: G           O
[74530.160000] ra    : 86ca5d98 tcp_v6_syn_recv_sock+0xcc/0x468 [ipv6]
[74530.160000] Status: 1000fc03    KERNEL EXL IE 
[74530.170000] Cause : 00800010
[74530.170000] BadVA : 86b5f83e
[74530.170000] PrId  : 00019374 (MIPS 24Kc)
[74530.180000] Modules linked in: sch_teql sch_tbf sch_sfq sch_red sch_qfq sch_prio sch_ns2_codel sch_nfq_codel sch_netem sch_htb sch_gred sch_efq_codel sch_dsmark em_text em_nbyte em_meta em_cmp cls_basic act_police act_ipt act_connmark act_skbedit act_mirred em_u32 cls_u32 cls_tcindex cls_flow cls_route cls_fw sch_hfsc sch_fq_codel sch_codel sch_ingress usb_storage ath79_wdt ohci_hcd xt_hashlimit xt_set(O) ip_set_list_set(O) ip_set_hash_netport(O) ip_set_hash_netiface(O) ip_set_hash_net(O) ip_set_hash_ipportnet(O) ip_set_hash_ipportip(O) ip_set_hash_ipport(O) ip_set_hash_ip(O) ip_set_bitmap_port(O) ip_set_bitmap_ipmac(O) ip_set_bitmap_ip(O) ip_set(O) ip6t_REJECT ip6t_rt ip6t_hbh ip6t_mh ip6t_ipv6header ip6t_frag ip6t_eui64 ip6t_ah ip6table_raw ip6table_mangle ip6table_filter ip6_tables nf_conntrack_ipv6 nf_defrag_ipv6 nfnetlink nf_nat_irc nf_nat_ftp nf_conntrack_irc nf_conntrack_ftp xt_policy xt_esp ipt_ah xt_HL xt_hl xt_ecn ipt_ECN xt_CLASSIFY xt_time xt_tcpmss xt_statistic xt_mark xt_length xt_DSCP xt_dscp xt_string xt_layer7 xt_quota xt_pkttype xt_physdev xt_owner xt_addrtype ipt_MASQUERADE iptable_nat xt_nat nf_nat_ipv4 nf_nat xt_recent xt_helper xt_connmark xt_connbytes pptp pppoe xt_conntrack xt_CT iptable_raw xt_state nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack ehci_hcd sd_mod pppox ipt_REJECT xt_TCPMSS xt_LOG xt_comment xt_multiport xt_mac xt_limit iptable_mangle iptable_filter ip_tables xt_tcpudp x_tables ip_gre gre ifb sit ipcomp xfrm4_tunnel xfrm4_mode_tunnel xfrm4_mode_transport xfrm4_mode_beet esp4 ah4 tunnel4 tun tcp_ledbat(O) ppp_async ppp_generic slhc af_key xfrm_user xfrm_ipcomp xfrm_algo vfat fat ext4 jbd2 mbcache autofs4 button_hotplug(O) ath9k(O) ath9k_common(O) ath9k_hw(O) ath(O) nls_utf8 nls_iso8859_2 nls_iso8859_15 nls_iso8859_13 nls_iso8859_1 nls_cp437 mac80211(O) usbcore usb_common scsi_mod nls_base ts_fsm ts_bm ts_kmp crc16 crc_ccitt ipv6 input_polldev cfg80211(O) compat(O) input_core sha1_generic md5 hmac des_generic deflate cbc authenc arc4 zlib_inflate zlib_deflate ledtrig_timer ledtrig_default_on leds_gpio gpio_button_hotplug(O)
[74530.360000] Process swapper (pid: 0, threadinfo=80324000, task=80328d50, tls=00000000)
[74530.370000] Stack : 00000000 00000002 2a67d6a1 86912228 00000000 00000000 00000014 00000000
[74530.370000]         00000002 00000001 85d213a0 869671b8 06410002 00000014 00000000 00000000
[74530.370000]         00000000 00000001 00000001 86b5f83e 85fae240 85fae240 85c81500 86b6a840
[74530.370000]         00100000 00000000 00000000 00000000 85c7cd54 80255228 8781a000 00000000
[74530.370000]         80325bd8 00000014 00000000 02000004 86c39824 50f7ee85 0306e65e 0306e65e
[74530.370000]         ...
[74530.410000] Call Trace:
[74530.410000] [<86ca5de8>] tcp_v6_syn_recv_sock+0x11c/0x468 [ipv6]
[74530.420000] [<80255228>] tcp_check_req+0x330/0x4cc
[74530.420000] [<8025219c>] tcp_v4_do_rcv+0x12c/0x274
[74530.430000] [<802547ec>] tcp_v4_rcv+0x5b4/0x974
[74530.430000] [<80232bf0>] ip_local_deliver_finish+0x168/0x29c
[74530.440000] [<80207c00>] __netif_receive_skb+0x63c/0x6c0
[74530.440000] [<801ef7e0>] ag71xx_poll+0x400/0x600
[74530.450000] [<802080c8>] net_rx_action+0x88/0x1fc
[74530.450000] [<80078ad8>] __do_softirq+0xb0/0x184
[74530.460000] [<80078c5c>] do_softirq+0x48/0x68
[74530.460000] [<80078e78>] irq_exit+0x4c/0x7c
[74530.460000] [<8006316c>] ret_from_irq+0x0/0x4
[74530.470000] [<80063380>] r4k_wait+0x20/0x40
[74530.470000] [<80064e60>] cpu_idle+0x30/0x60
[74530.480000] [<803428fc>] start_kernel+0x374/0x394
[74530.480000] 
[74530.480000] 
[74530.480000] Code: 7c6279c4  ae2204e4  8e620094 <8c420000> 00021502  0c0931ec  a22204f6  09b29842  8fbf0074 
</pre>

The second is in xfrm_state_lookup:

<pre>
[74929.640000] Cpu 0
[74929.650000] $ 0   : 00000000 00000000 984ebd38 00000007
[74929.650000] $ 4   : 8033c640 00000002 86b4684e 984ebd3c
[74929.660000] $ 8   : 87bc587c 00000000 00000000 00000000
[74929.660000] $12   : 00000002 00000000 00000000 5169fd51
[74929.670000] $16   : 00000004 86b4684e 00000002 984ebd3c
[74929.670000] $20   : 86b4684e 00000004 00000000 80340000
[74929.680000] $24   : 00000000 86915620                  
[74929.680000] $28   : 80324000 80325bd8 8033d570 8027af3c
[74929.690000] Hi    : 00000063
[74929.690000] Lo    : dabc6800
[74929.690000] epc   : 8027ade0 __xfrm_state_lookup+0x60/0x164
[74929.700000]     Tainted: G           O
[74929.700000] ra    : 8027af3c xfrm_state_lookup+0x58/0x88
[74929.710000] Status: 1000fc03    KERNEL EXL IE 
[74929.710000] Cause : 80800010
[74929.720000] BadVA : 86b4684e
[74929.720000] PrId  : 00019374 (MIPS 24Kc)
[74929.720000] Modules linked in: sch_teql sch_tbf sch_sfq sch_red sch_qfq sch_prio sch_ns2_codel sch_nfq_codel sch_netem sch_htb sch_gred sch_efq_codel sch_dsmark em_text em_nbyte em_meta em_cmp cls_basic act_police act_ipt act_connmark act_skbedit act_mirred em_u32 cls_u32 cls_tcindex cls_flow cls_route cls_fw sch_hfsc sch_fq_codel sch_codel sch_ingress usb_storage ath79_wdt ohci_hcd xt_hashlimit xt_set(O) ip_set_list_set(O) ip_set_hash_netport(O) ip_set_hash_netiface(O) ip_set_hash_net(O) ip_set_hash_ipportnet(O) ip_set_hash_ipportip(O) ip_set_hash_ipport(O) ip_set_hash_ip(O) ip_set_bitmap_port(O) ip_set_bitmap_ipmac(O) ip_set_bitmap_ip(O) ip_set(O) ip6t_REJECT ip6t_rt ip6t_hbh ip6t_mh ip6t_ipv6header ip6t_frag ip6t_eui64 ip6t_ah ip6table_raw ip6table_mangle ip6table_filter ip6_tables nf_conntrack_ipv6 nf_defrag_ipv6 nfnetlink nf_nat_irc nf_nat_ftp nf_conntrack_irc nf_conntrack_ftp xt_policy xt_esp ipt_ah xt_HL xt_hl xt_ecn ipt_ECN xt_CLASSIFY xt_time xt_tcpmss xt_statistic xt_mark xt_length xt_DSCP xt_dscp xt_string xt_layer7 xt_quota xt_pkttype xt_physdev xt_owner xt_addrtype ipt_MASQUERADE iptable_nat xt_nat nf_nat_ipv4 nf_nat xt_recent xt_helper xt_connmark xt_connbytes pptp pppoe xt_conntrack xt_CT iptable_raw xt_state nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack ehci_hcd sd_mod pppox ipt_REJECT xt_TCPMSS xt_LOG xt_comment xt_multiport xt_mac xt_limit iptable_mangle iptable_filter ip_tables xt_tcpudp x_tables ip_gre gre ifb sit ipcomp xfrm4_tunnel xfrm4_mode_tunnel xfrm4_mode_transport xfrm4_mode_beet esp4 ah4 tunnel4 tun tcp_ledbat(O) ppp_async ppp_generic slhc af_key xfrm_user xfrm_ipcomp xfrm_algo vfat fat ext4 jbd2 mbcache autofs4 button_hotplug(O) ath9k(O) ath9k_common(O) ath9k_hw(O) ath(O) nls_utf8 nls_iso8859_2 nls_iso8859_15 nls_iso8859_13 nls_iso8859_1 nls_cp437 mac80211(O) usbcore usb_common scsi_mod nls_base ts_fsm ts_bm ts_kmp crc16 crc_ccitt ipv6 input_polldev cfg80211(O) compat(O) input_core sha1_generic md5 hmac des_generic deflate cbc authenc arc4 zlib_inflate zlib_deflate ledtrig_timer ledtrig_default_on leds_gpio gpio_button_hotplug(O)
[74929.910000] Process swapper (pid: 0, threadinfo=80324000, task=80328d50, tls=00000000)
[74929.910000] Stack : 85d14ae0 86910f18 00000001 85c26700 00000000 00000004 00000002 8033c640
[74929.910000]         00000000 86b4684e 984ebd3c 00000002 80340000 8027af3c 00000000 8022d254
[74929.910000]         86c2e900 00000000 00000004 00000002 80232a88 86b4684e 86c2e900 00000004
[74929.910000]         00000000 00000000 fffffffe 8027dce8 00000002 80327dd8 00000000 80232a88
[74929.910000]         00000004 00000002 00000000 80325c74 86c2e900 86ffe2a0 00000001 803281dc
[74929.910000]         ...
[74929.950000] Call Trace:
[74929.950000] [<8027ade0>] __xfrm_state_lookup+0x60/0x164
[74929.960000] [<8027af3c>] xfrm_state_lookup+0x58/0x88
[74929.960000] [<8027dce8>] xfrm_input+0x134/0x480
[74929.970000] [<86cfd1cc>] tunnel64_rcv+0x60/0xa4 [tunnel4]
[74929.970000] [<80232bf0>] ip_local_deliver_finish+0x168/0x29c
[74929.980000] [<80207c00>] __netif_receive_skb+0x63c/0x6c0
[74929.990000] [<801ef7e0>] ag71xx_poll+0x400/0x600
[74929.990000] [<802080c8>] net_rx_action+0x88/0x1fc
[74929.990000] [<80078ad8>] __do_softirq+0xb0/0x184
[74930.000000] [<80078c5c>] do_softirq+0x48/0x68
[74930.000000] [<80078e78>] irq_exit+0x4c/0x7c
[74930.010000] [<8006316c>] ret_from_irq+0x0/0x4
[74930.010000] [<80063380>] r4k_wait+0x20/0x40
[74930.020000] [<80064e60>] cpu_idle+0x30/0x60
[74930.020000] [<803428fc>] start_kernel+0x374/0x394
[74930.030000] 
[74930.030000] 
[74930.030000] Code: 00000000  0809eb7a  8cc6000c <0809eb7c> 8cc50000  8e250008  00c52826  00451026  00023282 
</pre>

I think this last bug stems from the use of a union ""xfrm_address_t"", which avoids all our unaligned access marking.",Robert Bradley,2013-01-17 05:23:52.054855,2013-04-11 04:14:23.839883,Dave Täht,Closed,Normal
218,cerowrt,2.4 ghz dropping connections,"Richard Smith from olpc writes in with his experience in China:

For most of us it worked fine but we actually didn't use it much this time. Quanta provided us with a AP instead. Its was some fancy Motorola PoE job. The network was a wpa network which is a hassle for doing firmware upgrade and software imaging via http.

We switched to the wndr briefly so we had an open network. Sadly you just can't run an open network at anymore. Loads of squatters appear. You can't bandwidth restrict them since the XO's are in the same catagory. It work ok except for one of the other developers who complained that his connection to 2.4Ghz keep dropping. Most of the rest of us were on 5G and didn't see a problem. Due to that complaint we switched back to the Motorola and just dealt with the wpa network.

I took the router back with me to the hotel at night and used it without problems. I had to turn on encryption for 2.4G (again due to squatters) but I used the 5G open.

I think I have a possible solution for the open network for the next time. I think I can use nodogsplash with a site wide password so that once a MAC has been authorized it will stay that way. I'm not sure how I'll deal with firmware access (no browser). I'll have to craft up a recipe for doing a post with the right values so XO's can auth from the firmware.

Not sure about the 2.4 dropping complaint but given that there will be many creowrt releases between now and then I'm not going to worry about it.
",Dave Täht,2011-07-31 06:58:15.531185,2012-04-21 12:44:27.239014,Dave Täht,Closed,Urgent
369,cerowrt,openssl cve,http://lists.grok.org.uk/pipermail/full-disclosure/2012-April/086585.html,Dave Täht,2012-04-19 10:50:56.461937,2012-04-21 12:24:53.230572,Dave Täht,Closed,Normal
323,cerowrt,iwl lua fails to build,"So, I figured, ONE last shot at getting a working build again.

iwinfo_lua.c: In function 'iwinfo_L_wext_frequency_offset':
iwinfo_lua.c:644:1: warning: implicit declaration of function
'wext_get_frequency_offset'
iwinfo_lua.c: In function 'iwinfo_L_wext_txpower_offset':
iwinfo_lua.c:646:1: warning: implicit declaration of function
'wext_get_txpower_offset'
mips-openwrt-linux-uclibc-gcc -O2 -pipe -mips32r2 -mtune=mips32r2
-fno-caller-saves -fhonour-copts -msoft-float
-I/home/cero1/src/cerowrt/staging_dir/target-mips_r2_uClibc-0.9.32/usr/include/libnl-tiny
-I/home/cero1/src/cerowrt/staging_dir/target-mips_r2_uClibc-0.9.32/usr/include
-D_GNU_SOURCE -std=gnu99 -fstrict-aliasing -Iinclude -DUSE_NL80211 -fpic -c
-o iwinfo_cli.o iwinfo_cli.c
iwinfo_cli.c: In function 'print_txpower_offset':
iwinfo_cli.c:319:8: error: 'const struct iwinfo_ops' has no member named
'txpower_offset'
iwinfo_cli.c: In function 'print_frequency_offset':
iwinfo_cli.c:334:8: error: 'const struct iwinfo_ops' has no member named
'frequency_offset'
iwinfo_cli.c: In function 'print_txpwrlist':
iwinfo_cli.c:569:8: error: 'const struct iwinfo_ops' has no member named
'txpower_offset'
make[4]: *** [iwinfo_cli.o] Error 1
make[4]: Leaving directory
`/home/cero1/src/cerowrt/build_dir/target-mips_r2_uClibc-0.9.32/libiwinfo'
make[3]: ***
[/home/cero1/src/cerowrt/build_dir/target-mips_r2_uClibc-0.9.32/libiwinfo/.built]
Error 2
make[3]: Leaving directory `/home/cero1/src/cerowrt/package/iwinfo'
make[2]: *** [package/iwinfo/compile] Error 2
make[2]: Leaving directory `/home/cero1/src/cerowrt'
make[1]: ***
[/home/cero1/src/cerowrt/staging_dir/target-mips_r2_uClibc-0.9.32/stamp/.package_compile]
Error 2
make[1]: Leaving directory `/home/cero1/src/cerowrt'",David Taht,2011-12-10 09:08:52.326802,2012-04-21 12:38:32.049934,Dave Täht,Closed,Normal
366,cerowrt,Fwd: [PATCH] tcp: fix tcp_grow_window() for large incoming frames,"While this is not important for cerowrt, it could explain some things.


---------- Forwarded message ----------
From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Tue, Apr 17, 2012 at 2:28 AM
Subject: [PATCH] tcp: fix tcp_grow_window() for large incoming frames
To: David Miller <davem@davemloft.net>
Cc: Neal Cardwell <ncardwell@google.com>, Tom Herbert
<therbert@google.com>, netdev <netdev@vger.kernel.org>


From: Eric Dumazet <edumazet@google.com>

tcp_grow_window() has to grow rcv_ssthresh up to window_clamp, allowing
sender to increase its window.

tcp_grow_window() still assumes a tcp frame is under MSS, but its no
longer true with LRO/GRO.

This patch fixes one of the performance issue we noticed with GRO on.

Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Neal Cardwell <ncardwell@google.com>
Cc: Tom Herbert <therbert@google.com>
---
Sorry for the delay, this was discussed a long time ago.

 net/ipv4/tcp_input.c |    1 +
 1 file changed, 1 insertion(+)

diff --git a/net/ipv4/tcp_input.c b/net/ipv4/tcp_input.c
index 9944c1d..3ff36406 100644
--- a/net/ipv4/tcp_input.c
+++ b/net/ipv4/tcp_input.c
@@ -335,6 +335,7 @@ static void tcp_grow_window(struct sock *sk, const
struct sk_buff *skb)
                       incr = __tcp_grow_window(sk, skb);

               if (incr) {
+                       incr = max_t(int, incr, 2 * skb->len);
                       tp->rcv_ssthresh = min(tp->rcv_ssthresh + incr,
                                              tp->window_clamp);
                       inet_csk(sk)->icsk_ack.quick |= 1;",David Taht,2012-04-17 20:33:18.950758,2012-04-19 23:35:00.54694,Dave Täht,Rejected,Normal
338,cerowrt,connmark and ipv6 iptables are a bad combination,"I have been battling various ipv6 related bugs for a while. For example, I tried
to make openwrt's shaper do ipv6 and stuff like this will hang the interface
on x86 AND cerowrt.

<code>
# This is my bad boy
ip6tables -t mangle -A qos_Default -p tcp -m length --length :128 -m mark ! --mark 4/0xff -m tcp --tcp-flags ALL SYN -j MARK --set-mark 1/0xff
ip6tables -t mangle -A qos_Default -p tcp -m length --length :128 -m mark ! --mark 4/0xff -m tcp --tcp-flags ALL ACK -j MARK --set-mark 1/0xff
</code>
",Dave Täht,2012-02-11 20:14:51.159396,2012-04-21 12:42:28.545027,Dave Täht,New,Urgent
367,cerowrt,Fwd: [PATCH] ipv6: fix rt6_update_expires,"---------- Forwarded message ----------
From: Gao feng <gaofeng@cn.fujitsu.com>
Date: Tue, Apr 17, 2012 at 7:24 PM
Subject: Re: [PATCH] ipv6: fix rt6_update_expires
To: Jiri Bohac <jbohac@suse.cz>
Cc: David Miller <davem@davemloft.net>, netdev@vger.kernel.org


于 2012年04月16日 21:34, Jiri Bohac 写道:
>
> Commit 1716a961 (ipv6: fix problem with expired dst cache) broke PMTU
> discovery. rt6_update_expires() calls dst_set_expires(), which only updates
> dst->expires if it has not been set previously (expires == 0) or if the new
> expires is earlier than the current dst->expires.
>
> rt6_update_expires() needs to zero rt->dst.expires, otherwise it will contain
> ivalid data left over from rt->dst.from and will confuse dst_set_expires().
>
> Signed-off-by: Jiri Bohac <jbohac@suse.cz>
>
> diff --git a/include/net/ip6_fib.h b/include/net/ip6_fib.h
> index ad4126f..68c1f94 100644
> --- a/include/net/ip6_fib.h
> +++ b/include/net/ip6_fib.h
> @@ -143,8 +143,13 @@ static inline void rt6_set_expires(struct rt6_info *rt, unsigned long expires)
>
>  static inline void rt6_update_expires(struct rt6_info *rt, int timeout)
>  {
> -     if (!(rt->rt6i_flags & RTF_EXPIRES) && rt->dst.from)
> -             dst_release(rt->dst.from);
> +     if (!(rt->rt6i_flags & RTF_EXPIRES)) {
> +             if (rt->dst.from)
> +                     dst_release(rt->dst.from);
> +             /* dst_set_expires relies on expires == 0
> +                  if it has not been set previously */
> +             rt->dst.expires = 0;
> +     }
>
>       dst_set_expires(&rt->dst, timeout);
>       rt->rt6i_flags |= RTF_EXPIRES;
>

looks good to me, thanks.",David Taht,2012-04-17 20:33:52.398546,2012-04-19 23:33:30.683177,Dave Täht,Rejected,Normal
331,cerowrt,drop in replacement for openwrt's qos is hard,"I'd like to be able to preserve the existing qos system
and then compare it against a new one.

That said, the defaults generated for the openwrt qos system
explain a lot, to me, at least. We can do WAY better 
than this, now.

root@OpenWrt:/etc/init.d# tc qdisc show dev ge00
qdisc hfsc 1: root refcnt 2 default 30 
qdisc sfq 100: parent 1:10 limit 16256p quantum 1514b depth 127 divisor 1024 perturb 2sec 
qdisc sfq 200: parent 1:20 limit 16256p quantum 1514b depth 127 divisor 1024 perturb 2sec 
qdisc red 300: parent 1:30 limit 330Kb min 28160b max 84480b ecn 
qdisc red 400: parent 1:40 limit 330Kb min 28160b max 84480b ecn 
qdisc ingress ffff: parent ffff:fff1 ---------------- 
root@OpenWrt:/etc/init.d# tc filter show dev ge00
filter parent 1: protocol ip pref 1 fw 
filter parent 1: protocol ip pref 1 fw handle 0x1/0xff classid 1:10 
filter parent 1: protocol ip pref 2 fw 
filter parent 1: protocol ip pref 2 fw handle 0x2/0xff classid 1:20 
filter parent 1: protocol ip pref 3 fw 
filter parent 1: protocol ip pref 3 fw handle 0x3/0xff classid 1:30 
filter parent 1: protocol ip pref 4 fw 
filter parent 1: protocol ip pref 4 fw handle 0x4/0xff classid 1:40 

root@OpenWrt:/etc/init.d# iptables -t mangle -L
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         
zone_wan_MSSFIX  all  --  anywhere             anywhere            
qos_Default  all  --  anywhere             anywhere            

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
qos_Default  all  --  anywhere             anywhere            

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain qos_Default (2 references)
target     prot opt source               destination         
CONNMARK   all  --  anywhere             anywhere             CONNMARK restore mask 0xff
qos_Default_ct  all  --  anywhere             anywhere             mark match 0x0/0xff
MARK       all  --  anywhere             anywhere             mark match 0x1/0xff length 400:65535 MARK and 0xffffff00
MARK       all  --  anywhere             anywhere             mark match 0x2/0xff length 800:65535 MARK and 0xffffff00
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff length 0:500 MARK xset 0x2/0xff
MARK       icmp --  anywhere             anywhere             MARK xset 0x4/0xff
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp spts:1024:65535 dpts:1024:65535 MARK xset 0x4/0xff
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff udp spts:1024:65535 dpts:1024:65535 MARK xset 0x4/0xff
MARK       tcp  --  anywhere             anywhere             length 0:128 mark match ! 0x4/0xff tcpflags: FIN,SYN,RST,PSH,ACK,URG/SYN MARK xset 0x1/0xff
MARK       tcp  --  anywhere             anywhere             length 0:128 mark match ! 0x4/0xff tcpflags: FIN,SYN,RST,PSH,ACK,URG/ACK MARK xset 0x1/0xff

Chain qos_Default_ct (1 references)
target     prot opt source               destination         
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp multiport ports ssh,222,domain MARK xset 0x1/0xff
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp multiport ports ftp-data,ftp,smtp,www,81,8123,pop3,https,imaps,pop3s MARK xset 0x3/0xff
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff udp multiport ports domain,ntp,sip,5190 MARK xset 0x2/0xff
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp multiport ports rsync MARK xset 0x4/0xff
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff udp multiport ports rsync MARK xset 0x4/0xff
CONNMARK   all  --  anywhere             anywhere             CONNMARK save mask 0xff

Chain zone_wan_MSSFIX (1 references)
target     prot opt source               destination         
root@OpenWrt:/etc/init.d# iptables -t mangle -L
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         
zone_wan_MSSFIX  all  --  anywhere             anywhere            
qos_Default  all  --  anywhere             anywhere            

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
qos_Default  all  --  anywhere             anywhere            

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain qos_Default (2 references)
target     prot opt source               destination         
CONNMARK   all  --  anywhere             anywhere             CONNMARK restore mask 0xff
qos_Default_ct  all  --  anywhere             anywhere             mark match 0x0/0xff
MARK       all  --  anywhere             anywhere             mark match 0x1/0xff length 400:65535 MARK and 0xffffff00
MARK       all  --  anywhere             anywhere             mark match 0x2/0xff length 800:65535 MARK and 0xffffff00
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff length 0:500 MARK xset 0x2/0xff
MARK       icmp --  anywhere             anywhere             MARK xset 0x4/0xff
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp spts:1024:65535 dpts:1024:65535 MARK xset 0x4/0xff
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff udp spts:1024:65535 dpts:1024:65535 MARK xset 0x4/0xff
MARK       tcp  --  anywhere             anywhere             length 0:128 mark match ! 0x4/0xff tcpflags: FIN,SYN,RST,PSH,ACK,URG/SYN MARK xset 0x1/0xff
MARK       tcp  --  anywhere             anywhere             length 0:128 mark match ! 0x4/0xff tcpflags: FIN,SYN,RST,PSH,ACK,URG/ACK MARK xset 0x1/0xff

Chain qos_Default_ct (1 references)
target     prot opt source               destination         
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp multiport ports ssh,222,domain MARK xset 0x1/0xff
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp multiport ports ftp-data,ftp,smtp,www,81,8123,pop3,https,imaps,pop3s MARK xset 0x3/0xff
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff udp multiport ports domain,ntp,sip,5190 MARK xset 0x2/0xff
MARK       tcp  --  anywhere             anywhere             mark match 0x0/0xff tcp multiport ports rsync MARK xset 0x4/0xff
MARK       udp  --  anywhere             anywhere             mark match 0x0/0xff udp multiport ports rsync MARK xset 0x4/0xff
CONNMARK   all  --  anywhere             anywhere             CONNMARK save mask 0xff

Chain zone_wan_MSSFIX (1 references)
target     prot opt source               destination   ",Dave Täht,2012-01-30 06:52:20.649898,2012-04-21 12:47:19.58335,Dave Täht,In Progress,Normal
381,cerowrt,radvd appears to be broken,"I am not getting radvd announcements after a long time in operation.

restarting radvd without the default firewall rules worked.

Not in a position to restore those rules, lets let radvd run for a few days more,
and I'll try to test that on another box.

I was figuring we'd broke radvd with the new kernel but apparently not.",Dave Täht,2012-05-01 15:29:00.743387,2013-04-11 04:43:14.678237,Dave Täht,Closed,Normal
347,cerowrt,Fwd: [PATCH] net: fix a potential rcu_read_lock() imbalance in rt6_fill_node(),"---------- Forwarded message ----------
From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Tue, Mar 27, 2012 at 12:53 PM
Subject: [PATCH] net: fix a potential rcu_read_lock() imbalance in
rt6_fill_node()
To: Ben Greear <greearb@candelatech.com>
Cc: David Miller <davem@davemloft.net>, netdev@vger.kernel.org,
gregkh@linuxfoundation.org, ""Paul E. McKenney"" <paulmck@linux.vnet.ibm.com>,
Dave Jones <davej@redhat.com>


Commit f2c31e32b378 (net: fix NULL dereferences in check_peer_redir() )
added a regression in rt6_fill_node(), leading to rcu_read_lock()
imbalance.

Thats because NLA_PUT() can make a jump to nla_put_failure label.

Fix this by using nla_put()

Many thanks to Ben Greear for his help

Reported-by: Ben Greear <greearb@candelatech.com>
Reported-by: Dave Jones <davej@redhat.com>
Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
---
 net/ipv6/route.c |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/net/ipv6/route.c b/net/ipv6/route.c
index 24c456e..496b627 100644
--- a/net/ipv6/route.c
+++ b/net/ipv6/route.c
@@ -2474,8 +2474,12 @@ static int rt6_fill_node(struct net *net,

       rcu_read_lock();
       n = dst_get_neighbour_noref(&rt->dst);
-       if (n)
-               NLA_PUT(skb, RTA_GATEWAY, 16, &n->primary_key);
+       if (n) {
+               if (nla_put(skb, RTA_GATEWAY, 16, &n->primary_key) < 0) {
+                       rcu_read_unlock();
+                       goto nla_put_failure;
+               }
+       }
       rcu_read_unlock();

       if (rt->dst.dev)",David Taht,2012-03-27 13:38:44.015728,2012-04-19 23:48:43.536905,Dave Täht,Closed,High
402,cerowrt,Tail drop behavior on fq_codel on ack-mostly streams,"In order to reduce memory requirements I reduced the packet limits for the 24 fq_codel queues to anywhere between 100 and 600 packets depending on type. This, I reasoned, would be enough for most traffic loads.

I missed the case of ack mostly traffic, which as it has a 20x1 ratio vs big packets, requires that the queues be
much larger. On an ACK-heavy load, at high bandwidths, we end up with fq_codel in an ""interesting"" drop tail state, where it still admits packets but ends up optimizing for ""new"" flows that aren't actually ""new"".

I do not know the right values. The fq_codel default of 10k packets is sufficient to run the router out of memory in a variety of scenarios, resulting in a crash.",Dave Täht,2012-07-12 12:32:30.171743,2014-05-14 11:38:15.460004,Dave Täht,Closed,Urgent
382,cerowrt,"named.montime runs forever, restarts ntp and named forever","I think this is related to why ntp keeps getting restarted

 3578     1 root     S     1696   3%   0% {named.montime} /bin/sh /usr/sbin/nam

in that the sort of fix for bug #113 which still doesn't work well, we updated ntp to head,
and ntpq now returns stuff that that script can't parse.

ntpq> peers
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
malformed srcadr=149.20.54.81
-0.0.0.0                          3 p   10   64   17    0.362    1.747   4.572
malformed srcadr=46.166.138.172
+0.0.0.0                          2 p    3   64   17   21.008    8.186   1.919
malformed srcadr=38.229.71.1
*0.0.0.0                          2 p    4   64   17   53.762    7.853   3.160
malformed srcadr=24.124.0.251
-0.0.0.0                          3 p    6   64   17   65.623   -3.194   2.748
malformed srcadr=64.16.211.38
-0.0.0.0                          3 p    9   64   17   66.077    2.962   3.207
malformed srcadr=169.229.70.201
+0.0.0.0                          3 p   66   64    7    4.034    7.393   2.044
malformed srcadr=2001:470:79::14:123
-0.0.0.0    ",Dave Täht,2012-05-01 15:31:35.532664,2012-10-08 13:05:49.72143,Dave Täht,New,Immediate
436,cerowrt,speed problems with later versions of cero?,"I've now had three private reports of ""speed"" problems with the latest
cerowrt releases.

All of them take serious uptime to occur. And unfortunately all the
bug report(s) were, ""oh, it
got slow after everybody got home/ran a couple days, so I went back to
the prior router"".

That's not helpful, and could well be new users blaming the change
rather than something else, but it is possible that this is happening,
so... IF that happens to anyone here, I'd like
to request a couple things in roughly this order

tcpdump -i ge00 -s 128 -w /tmp/myproblem.cap # for 10 seconds hit
cntrl-c Send me the file
pinging the box from the outside world # got packet loss?
dmesg > /tmp/dmesg.log # send me the file
logread > /tmp/logread.log # send me te file
run top and see if there is a daemon running away
tell me what ISP's network you are on...

restart the aqm system and see if it goes away
/etc/init.d/aqm restart

try nfq_codel and/or pie instead of fq_codel

1) I am aware of an old bug with odhcp6 where it would start hammering
the network with
requests for an ipv6 address in a tight loop. I don't know what
triggers it. (with AQM set right it is hardly noticeable but
""feelable"". However if your bandwidth setting is even mildly wrong,
boom life gets bad and STAYS bad)

If you look at the packet capture it will be filled with dhcpv6
requests if this is what is happening.

Right now, I have a box dropping nearly every other packet for some
reason. It's not in a place I can easily get at until tomorrow. It's
been up for 90+ days and only started doing this recently

--- X.Y.Z.Q ping statistics ---
60 packets transmitted, 42 packets received, 30.0% packet loss
round-trip min/avg/max/stddev = 37.788/44.205/76.607/6.609 ms

It's my hope it's the above problem and is occurring now that comcast
is rolling out ipv6

Off the top of my head I don't remember what you need to disable to
turn it off. Certainly comment out the ge01 entry to turn it off.

2) Random number generation has changed.

rngd is still enabled, so we're not running out of random numbers, but
we could have other problems... check entropy?

3) There could be a daemon running away (run top)

4) Could have a new instruction trap problem under certain conditions

take a look at the /sys

dmesg
logead


Tony",David Taht,2013-11-21 18:30:09.607406,2014-05-14 11:34:33.969739,Dave Täht,Closed,Normal
401,cerowrt,major retries in the VI AMPDU queue on ath9k,"I find the AMPDU retry statistics to be massively high in the case of VI and still quite high in the case of BE.

(The radios happen to be in MCS4 most of the time, if that matters.
 There are only three radios on the network, no competing traffic at all)

<pre>
root@davesroof:/sys/kernel/debug/ieee80211/phy0/ath9k# cat xmit
    Num-Tx-Queues: 10  tx-queues-setup: 0x10f poll-work-seen: 36206
                                BE         BK        VI        VO

    MPDUs Queued:            27436        174     15066     12730
    MPDUs Completed:         27322        174     15062     12708
    MPDUs XRetried:            114          0         4        22
    Aggregates:              94194          5         0         0
    AMPDUs Queued HW:       620975         49     21536         0
    AMPDUs Queued SW:       438841          7         0         0
    AMPDUs Completed:      1045702         34      6476         0
    AMPDUs Retried:         438217        728    413300         0
    AMPDUs XRetried:         14114         22     15059         0
    FIFO Underrun:               0          0         0         0
    TXOP Exceeded:               0          0         0         0

</pre>

So I don't see TXOP exceeded, but I do see exorbitant numbers
of retries in the AMPDU VI queue for some reason. This disturbs me.



In  xmit.c I see:

<pre>
  static u32 ath_lookup_rate(struct ath_softc *sc, struct ath_buf *bf,
struct ath_atx_tid *tid)
{
  ...
  /*
* Find the lowest frame length among the rate series that will have a
* 4ms transmit duration.
* TODO - TXOP limit needs to be considered.
*/
max_4ms_framelen = ATH_AMPDU_LIMIT_MAX;
</pre>

",Dave Täht,2012-07-08 13:14:32.644964,2013-04-11 04:26:22.31368,Dave Täht,Closed,Urgent
319,cerowrt,Dave needs to get better at pushing out patches,"The overhead of formatting a patch properly is trivial.

Getting a patch set into thunderbird or the web so totally dwarfs the
tedium of actually creating the patch, it's unbelievable.

I have a string of mostly trivial patches I could have got out ages
ago with git send-email.  I could slam out patches every day that way
and be a zillion times more effective coding-wise.

All year I have tried to get to where I could send email effectively
from the command line on my laptop or wherever, and today's email
server setups have become so complex that I have completely failed to
find a way to so. (I note that I am frequently offline and need to be
able to do it from my main development box, my laptop, and I have been
highly mobile of late)

I recently spent most of a day trying to get bufferbloat.net's email
server to take email from me, using sasl, or certs, and failed
entirely.

I've been running my own email servers for 3 decades now, It's both
embarrassing to me and unbelievable how difficult it's become to use
such a basic transport.

And I USED to read my email with emacs. I liked it. I was FAR more
productive switching from code to irc to email to patches and back
when I didn't have to run tools like a browser and thunderbird all the
time.",David Taht,2011-12-08 02:16:58.841041,2012-07-12 21:54:52.065299,Dave Täht,Closed,Normal
360,cerowrt,Patchwork [OpenWrt-Devel] ar71xx TCP/IPsec unaligned instructions,"Good to have patch -
http://patchwork.midlink.org/patch/1721/
This patch is for IPv4 (I am yet to test it on v6)

Tested (without patch) on 3.3-1.4
Here is what traps of ""unaligned_instructions"" shows -
(dmesg.logs)

<snip>
[  803.894531] Stack : 00000000 803011fc 86adfaa0 86adfaa0 869ced60 8721bf00 86210900 86210900
[  803.894531]         86b2f882 86b2f86e 80360000 80231494 80213490 00000001 8721bf00 80360000
[  803.894531]         80213888 87d48000 8721bf00 c0a80121 00000000 8721bf00 86b2f882 c0a80121
[  803.894531]         86210900 8721bf00 86b2f882 8023350c 00000000 86adfa90 80213490 80000000
[  803.894531]         c0a80121 0000d859 00000003 80000000 8721bf00 8029be84 00000001 80301614
[  803.894531]         ...
[  803.894531] Call Trace:
[  803.894531] [<8022abb4>] tcp_rcv_established+0x34/0x690
[  803.894531] [<80231494>] tcp_v4_do_rcv+0x40/0x244
[  803.894531] [<8023350c>] tcp_v4_rcv+0x59c/0x944
[  803.894531] [<802139f8>] ip_local_deliver_finish+0x170/0x29c
[  803.894531] [<801e8290>] __netif_receive_skb+0x458/0x4c8
..
..
[  803.894531] Stack : 00000000 803011fc 86adfaa0 86adfaa0 869ced60 8721bf00 86210900 86210900
[  803.894531]         86b2f882 86b2f86e 80360000 80231494 80213490 00000001 8721bf00 80360000
[  803.894531]         80213888 87d48000 8721bf00 c0a80121 00000000 8721bf00 86b2f882 c0a80121
[  803.894531]         86210900 8721bf00 86b2f882 8023350c 00000000 86adfa90 80213490 80000000
[  803.894531]         c0a80121 0000d859 00000003 80000000 8721bf00 8029be84 00000001 80301614
[  803.894531]         ...
[  803.894531] Call Trace:
[  803.894531] [<8022abb4>] tcp_rcv_established+0x34/0x690
[  803.894531] [<80231494>] tcp_v4_do_rcv+0x40/0x244
[  803.894531] [<8023350c>] tcp_v4_rcv+0x59c/0x944
[  803.894531] [<802139f8>] ip_local_deliver_finish+0x170/0x29c
[  803.894531] [<801e8290>] __netif_receive_skb+0x458/0x4c8
..
..
</snip>


Hereis what oprofiler shows (oprof_raw.txt) -


CPU: MIPS 24K, speed 676 MHz (estimated)
Counted INSTRUCTIONS events (1-0 Instructions completed) with a unit mask of 0x00 (No unit mask) count 100000
samples  %        app name                 symbol name
-------------------------------------------------------------------------------
548       7.6977  vmlinux                  __do_softirq
  548      100.000  vmlinux                  __do_softirq [self]
-------------------------------------------------------------------------------
370       5.1974  libuClibc-0.9.33.so      /lib/libuClibc-0.9.33.so
  370      100.000  libuClibc-0.9.33.so      /lib/libuClibc-0.9.33.so [self]
-------------------------------------------------------------------------------
334       4.6917  vmlinux                  __copy_user
  334      100.000  vmlinux                  __copy_user [self]
-------------------------------------------------------------------------------
276       3.8769  ip_tables                /ip_tables
  276      100.000  ip_tables                /ip_tables [self]
-------------------------------------------------------------------------------
271       3.8067  vmlinux                  csum_partial
  271      100.000  vmlinux                  csum_partial [self]
-------------------------------------------------------------------------------
246       3.4555  vmlinux                  __copy_user_inatomic
  246      100.000  vmlinux                  __copy_user_inatomic [self]
-------------------------------------------------------------------------------
241       3.3853  nf_conntrack             /nf_conntrack
  241      100.000  nf_conntrack             /nf_conntrack [self]
-------------------------------------------------------------------------------
222       3.1184  dropbear                 /usr/sbin/dropbear
  222      100.000  dropbear                 /usr/sbin/dropbear [self]
-------------------------------------------------------------------------------
216       3.0341  vmlinux                  tick_nohz_idle_enter
  216      100.000  vmlinux                  tick_nohz_idle_enter [self]
-------------------------------------------------------------------------------
205       2.8796  vmlinux                  tick_nohz_idle_exit
  205      100.000  vmlinux                  tick_nohz_idle_exit [self]
-------------------------------------------------------------------------------
185       2.5987  vmlinux                  r4k_wait
  185      100.000  vmlinux                  r4k_wait [self]
-------------------------------------------------------------------------------
154       2.1632  vmlinux                  finish_task_switch.constprop.62
  154      100.000  vmlinux                  finish_task_switch.constprop.62 [self]
-------------------------------------------------------------------------------
116       1.6294  busybox                  /bin/busybox

  116      100.000  busybox                  /bin/busybox [self]
-------------------------------------------------------------------------------
93        1.3064  ld-uClibc-0.9.33.so      /lib/ld-uClibc-0.9.33.so
  93       100.000  ld-uClibc-0.9.33.so      /lib/ld-uClibc-0.9.33.so [self]
-------------------------------------------------------------------------------
92        1.2923  ath9k                    /ath9k
  92       100.000  ath9k                    /ath9k [self]
-------------------------------------------------------------------------------
84        1.1799  vmlinux                  local_bh_enable
  84       100.000  vmlinux                  local_bh_enable [self]
-------------------------------------------------------------------------------
82        1.1518  vmlinux                  __wake_up_sync_key
  82       100.000  vmlinux                  __wake_up_sync_key [self]
-------------------------------------------------------------------------------
72        1.0114  vmlinux                  __bzero
  72       100.000  vmlinux                  __bzero [self]
-------------------------------------------------------------------------------
69        0.9692  vmlinux                  nf_iterate
  69       100.000  vmlinux                  nf_iterate [self]
-------------------------------------------------------------------------------
63        0.8850  libdns.so.93.1.0         /usr/lib/libdns.so.93.1.0
  63       100.000  libdns.so.93.1.0         /usr/lib/libdns.so.93.1.0 [self]
-------------------------------------------------------------------------------
56        0.7866  vmlinux                  ag71xx_poll
  56       100.000  vmlinux                  ag71xx_poll [self]
-------------------------------------------------------------------------------
56        0.7866  vmlinux                  tcp_rcv_established
  56       100.000  vmlinux                  tcp_rcv_established [self]
-------------------------------------------------------------------------------
55        0.7726  oprofiled                /usr/bin/oprofiled
  55       100.000  oprofiled                /usr/bin/oprofiled [self]
-------------------------------------------------------------------------------
53        0.7445  mac80211                 /mac80211
  53       100.000  mac80211                 /mac80211 [self]
-------------------------------------------------------------------------------
53        0.7445  vmlinux                  do_ade
  53       100.000  vmlinux                  do_ade [self]
-------------------------------------------------------------------------------
",Ketan Kulkarni,2012-04-11 06:53:13.45416,2013-12-22 13:29:58.783903,Dave Täht,In Progress,Normal
433,cerowrt,Easy wireless extender using ethernet that copes with cerowrt split-networks,"CeroWRT is great as it provides split networks: se00, sw00, sw10, gw00, gw10... instead of the common pattern of bridge all together.

This is great, but imposes few problems, such as UPnP being only visible in their network. Another problem that would be great to be solved is how to cover more area using CeroWRT bound by Ethernet (as opposed to WDS).

Some houses are big or have thick brick walls that blocks wireless propagation. To solve this using different routers will help. Since gigabit ethernet is way faster and more reliable than extending the range using WDS, it is desired to use it to link different routers.

It is expected that if you have multiple routers with the same SSID, if they use a single DHCP IP pool, the devices can migrate transparently from router to router, without loosing connectivity. Usually this is done by linking the routers using their LAN, giving them the same WiFi SSID and disabling the DHCP in all but one router.

However given CeroWRT multi-network scheme, it will break transparent migration across routers with the same SSID. If one device connected to sw00 (say IP: 172.30.42.93) on main router, then walks towards the signal of the secondary router it will need to be reconnected because the flow from the main router to secondary doesn't happen through sw00, but se00, that doesn't know the .93 IP! The device would then reconnect with an IP within range 1-30 (se00).

I've been thinking about alternatives, none of them is great and would like your ideas. Likely integrate the result as a new feature of CeroWRT.",Gustavo Barbieri,2013-05-29 05:58:14.693419,2013-05-29 05:58:14.693419,Dave Täht,New,Normal
444,cerowrt,IPV6 configureation,"Hi
I get a /64 from my ISP
SE00 gets given the entire /64
so neither SW10 or sw00 get any ipv6 addresses or assignments
how can I get ipv6 running on the wireless as well ?
Do I need a larger assignment from my ISP ?

/etc/config/network looks like:

config interface 'se00'
	option ifname 'se00'
	option proto 'static'
	option netmask '255.255.255.224'
	option ip6assign '64'
	option ipaddr '192.168.254.1'
	option delegate '0'

config interface 'ge00'
	option ifname 'ge00'
	option _orig_ifname 'ge00'
	option _orig_bridge 'false'
	option proto 'pppoe'
	option username 'xxx
	option password 'xxxxxxx'
	option ipv6 '1'

config interface 'wan6'
	option ifname '@ge00'
	option proto 'dhcpv6'
	option broadcast '1'
	option metric '2048'
	option reqprefix '60'
	option reqaddress 'try'

config interface 'sw00'
	option proto 'static'
	option netmask '255.255.255.224'
	option ipaddr '192.168.254.65'
	option ip6assign '64'

config interface 'sw10'
	option proto 'static'
	option netmask '255.255.255.224'
	option ipaddr '192.168.254.97'
	option ip6assign '64'




only ",David Hunnisett,2014-06-20 10:50:46.939858,2014-06-24 19:49:33.595268,Dave Täht,Closed,Normal
441,cerowrt,Fwd: [Cerowrt-devel] odhcp6c went crazy flooding Comcast with DHCPv6 SOLICITs,"---------- Forwarded message ----------
From: Chuck Anderson <cra@wpi.edu>
Date: Tue, Mar 25, 2014 at 7:40 PM
Subject: Re: [Cerowrt-devel] odhcp6c went crazy flooding Comcast with
DHCPv6 SOLICITs
To: cerowrt-devel@lists.bufferbloat.net


This happened again, but this time it killed the eMTA in my cable
modem, knocking out my Xfinity Voice service.  The Arris Telephony
Modem got stuck at Telephony-DHCP and wouldn't boot past that point,
which is unsurprising given the large flood of DHCPv6 Solicit packets
going through it.  As soon as I unplugged the CeroWrt WAN interface,
the Arris eMTA was able to boot and my phone service was restored.

This was with the CeroWrt comcast release 3.10.28-4 which has been
sitting there running for 52 days.  It appears to take a long time to
see this issue, so mabye no one here has seen it because they reboot
or upgrade their CeroWrt routers more often than that, or maybe no one
is using odhcp6c anymore.

This is definitely a severe bug in odhcp6c.  It should have built-in
rate limiting to prevent it from trashing the network.  It is never
correct for a DHCP client to send packets this rapidly.

The odhcp6c process is currently taking all available CPU, about 86%,
with 12% taken by rngd.  How can I debug this currently running
process?  There is no ""strace"" binary to see what it is doing...

17039  1182 root     R      828   1%  86% odhcp6c -s /lib/netifd/dhcpv6.script
 1778     1 root     S      816   1%  12% /sbin/rngd -f -r /dev/urandom -W 4000
 1286     1 root     S     2756   2%   0% /usr/sbin/snmpd -Lf /dev/null -p /var
20565 20081 root     R     1708   1%   0% top
20064  1326 root     S     1300   1%   0% dropbear -i
 1601     1 root     S     1216   1%   0% /usr/sbin/babeld -D -I /var/run/babel
 1098     2 root     SW       0   0%   0% [kworker/0:3]
 1254     1 root     S     4828   4%   0% /usr/sbin/lighttpd -D -f /etc/lighttp
 1226     1 www-data S     4244   3%   0% /usr/sbin/lighttpd -D -f /etc/lighttp
 1628     1 root     S     3952   3%   0% /usr/sbin/hostapd -P /var/run/wifi-ph
 1663     1 root     S     3952   3%   0% /usr/sbin/hostapd -P /var/run/wifi-ph
 1537     1 nobody   S     2320   2%   0% avahi-daemon: running [cerowrt.local]
 1450     1 root     S     1756   1%   0% /usr/sbin/dbus-daemon --system
 1348  1182 root     S     1716   1%   0% udhcpc -p /var/run/udhcpc-ge00.pid -s
20081 20064 root     S     1716   1%   0% -ash
 1242     1 root     S     1712   1%   0% /usr/sbin/crond -f -c /etc/crontabs -
 1791     1 root     S     1708   1%   0% /usr/sbin/ntpd -n -l -p 0.openwrt.poo
 1182     1 root     S     1576   1%   0% /sbin/netifd
16232     1 nobody   S     1436   1%   0% /usr/sbin/dnsmasq -C /var/etc/dnsmasq
^C233 16232 root     S     1432   1%   0% /usr/sbin/dnsmasq -C /var/etc/dnsmasq

root@cerowrt:/# uptime
 22:32:31 up 52 days,  1:10,  load average: 1.27, 1.29, 1.26


Tcpdump output:

22:04:42.703054 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.703239 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.703422 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.703603 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.703786 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.703968 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.704151 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.704334 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.704516 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.704698 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.704881 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.705104 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.705290 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.705472 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.705655 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.705837 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.706020 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.706202 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.706385 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.706566 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.706749 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.706932 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.707116 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.707298 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.707481 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.707664 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.707846 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.708028 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.708211 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.708393 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.708576 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.708759 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.708981 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.709202 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.709387 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.709617 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.709801 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.709983 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.710167 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.710350 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.710533 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.710715 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.710898 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.752919 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.753102 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.753285 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.753468 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.753650 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.753834 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.754016 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.754199 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.754382 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.754564 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.754747 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.754931 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.755113 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.755346 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.755529 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.755712 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.755964 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.756152 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.756335 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.756517 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.756700 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.756883 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.757073 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.757256 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.757439 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.757623 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.757806 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.757990 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.758171 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.758355 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.758536 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.758719 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.890376 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.890562 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.890745 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.890928 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.891120 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.891303 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit
22:04:42.891487 IP6 fe80::2eb0:5dff:fe7f:7096.dhcpv6-client >
ff02::1:2.dhcpv6-server: dhcp6 solicit


On Sat, Feb 01, 2014 at 08:29:50AM -0500, Chuck Anderson wrote:
> This morning my Linux PC which has a direct connection to my Comcast
> cable modem (no router in between) lost its IPv4 address.  During
> troubleshooting, I noticed that the dhclient was unable to get an IPv4
> address from Comcast.  I ran tcpdump and discovered that the CeroWRT
> router, also connected to the same cable modem via a switch, was
> flooding the WAN with DHCPv6 SOLICIT packets with about 4700
> packets/sec, 6.6 megabits/sec of traffic!  I immediately unplugged
> CeroWRT from the WAN and then my PC was able to get an IPv4 address
> from Comcast.
>
> I know CeroWrt 3.7.5-2 is old at this point, but I'm wondering if
> something else changed to cause this behavior.  Maybe Comcast
> IPv6-enabled my CMTS finally?  I've been using HE tunnels for IPv6,
> one on a Linksys OpenWRT for my ""production"" network and a separate
> tunnel on this CeroWRT for ""testing"".
>
> There is one other change that was made to my Linux PC--I booted into
> a new kernel yesterday morning and had a similar problem with the
> inability to get an IPv4 address via DHCP from Comcast for about 30
> minutes, then it just started working on its own.  (I hadn't noticed
> initially since I was using IPv6 to get where I needed to go.)  I
> didn't have time to troubleshoot it at the time, but I assumed it was
> due to this IPv6 change in the Fedora kernel:
>
> * Wed Jan 29 2014 Justin M. Forbes <jforbes@fedoraproject.org> - 3.12.9-201
> - ipv6 addrconf: revert /proc/net/if_inet6 ifa_flag format (rhbz 1056711)
>
> * Tue Jan 28 2014 Josh Boyer <jwboyer@fedoraproject.org>
> - Add patch from Stanislaw Gruszka to fix ath9k BUG (rhbz 990955)
>
> * Mon Jan 27 2014 Justin M. Forbes <jforbes@fedoraproject.org> - 3.12.9-200
> - Backport new IPv6 address flag IFA_F_NOPREFIXROUTE and IFA_F_MANAGETEMPADDR (rhbz 1056711)
> - Linux v3.12.9
> - i915: remove pm_qos request on error (rhbz 1057533)
>
> See https://bugzilla.redhat.com/show_bug.cgi?id=1056711 for details
> about that.
>
> Each time this loss of IPv4 happened, I noticed the NIC link went down
> right before it started.  Maybe the flooding was happening yesterday
> morning too, and the flooding caused my poor 5-port Netgear switch to
> flake out and flap the NIC links?  Alternatively, maybe the link flap
> itself was what caused odhcp6c to wig out and start flooding in the
> first place?  Unfortunately I don't have a tcpdump from yesterday
> morning to confirm this.
>
> CeroWRT status:
>
> Router Name  cerowrt
> Router Model NETGEAR WNDR3700v2
> Firmware Version     CeroWrt Modena 3.7.5-2 / LuCI Trunk (trunk+svn)
> Kernel Version             3.7.5
> Local Time         Sat Feb 1 07:54:43 2014
> Uptime                     58d 6h 56m 51s
>
> The DHCPv6 client is odhcp6c:
>
> root@cerowrt:~# ps |grep dhc
>   980 root      1720 S    udhcpc -p /var/run/udhcpc-ge00.pid -s /lib/netifd/dh
>  1335 root       804 R    odhcp6c -s /lib/netifd/dhcpv6.script -Ntry -P60 ge00
>  3725 root      1704 S    grep dhc
>
> Here is an example packet from the DHCPv6 flood:
>
> No.     Time        Source                Destination           Protocol Length Info
>       1 0.000000    fe80::c63d:c7ff:feb0:8f41 ff02::1:2             DHCPv6   179    Solicit XID: 0x45eb91 CID: 00030001c43dc7b08f41
>
> Frame 1: 179 bytes on wire (1432 bits), 179 bytes captured (1432 bits)
>     Encapsulation type: Ethernet (1)
>     Arrival Time: Feb  1, 2014 07:20:27.723633000 EST
>     [Time shift for this packet: 0.000000000 seconds]
>     Epoch Time: 1391257227.723633000 seconds
>     [Time delta from previous captured frame: 0.000000000 seconds]
>     [Time delta from previous displayed frame: 0.000000000 seconds]
>     [Time since reference or first frame: 0.000000000 seconds]
>     Frame Number: 1
>     Frame Length: 179 bytes (1432 bits)
>     Capture Length: 179 bytes (1432 bits)
>     [Frame is marked: False]
>     [Frame is ignored: False]
>     [Protocols in frame: eth:ipv6:udp:dhcpv6]
>     [Coloring Rule Name: UDP]
>     [Coloring Rule String: udp]
> Ethernet II, Src: Netgear_b0:8f:41 (c4:3d:c7:b0:8f:41), Dst: IPv6mcast_00:01:00:02 (33:33:00:01:00:02)
>     Destination: IPv6mcast_00:01:00:02 (33:33:00:01:00:02)
>         Address: IPv6mcast_00:01:00:02 (33:33:00:01:00:02)
>         .... ..1. .... .... .... .... = LG bit: Locally administered address (this is NOT the factory default)
>         .... ...1 .... .... .... .... = IG bit: Group address (multicast/broadcast)
>     Source: Netgear_b0:8f:41 (c4:3d:c7:b0:8f:41)
>         Address: Netgear_b0:8f:41 (c4:3d:c7:b0:8f:41)
>         .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)
>         .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
>     Type: IPv6 (0x86dd)
> Internet Protocol Version 6, Src: fe80::c63d:c7ff:feb0:8f41 (fe80::c63d:c7ff:feb0:8f41), Dst: ff02::1:2 (ff02::1:2)
>     0110 .... = Version: 6
>         [0110 .... = This field makes the filter ""ip.version == 6"" possible: 6]
>     .... 0000 0000 .... .... .... .... .... = Traffic class: 0x00000000
>         .... 0000 00.. .... .... .... .... .... = Differentiated Services Field: Default (0x00000000)
>         .... .... ..0. .... .... .... .... .... = ECN-Capable Transport (ECT): Not set
>         .... .... ...0 .... .... .... .... .... = ECN-CE: Not set
>     .... .... .... 0000 0000 0000 0000 0000 = Flowlabel: 0x00000000
>     Payload length: 125
>     Next header: UDP (17)
>     Hop limit: 1
>     Source: fe80::c63d:c7ff:feb0:8f41 (fe80::c63d:c7ff:feb0:8f41)
>     [Source SA MAC: Netgear_b0:8f:41 (c4:3d:c7:b0:8f:41)]
>     Destination: ff02::1:2 (ff02::1:2)
>     [Source GeoIP: Unknown]
>     [Destination GeoIP: Unknown]
> User Datagram Protocol, Src Port: dhcpv6-client (546), Dst Port: dhcpv6-server (547)
>     Source port: dhcpv6-client (546)
>     Destination port: dhcpv6-server (547)
>     Length: 125
>     Checksum: 0xda1c [validation disabled]
>         [Good Checksum: False]
>         [Bad Checksum: False]
> DHCPv6
>     Message type: Solicit (1)
>     Transaction ID: 0x45eb91
>     Elapsed time
>         Option: Elapsed time (8)
>         Length: 2
>         Value: ffff
>         Elapsed-time: 655350 ms
>     Option Request
>         Option: Option Request (6)
>         Length: 10
>         Value: 00170018003800160015
>         Requested Option code: DNS recursive name server (23)
>         Requested Option code: Domain Search List (24)
>         Requested Option code: Unknown (56)
>         Requested Option code: SIP Servers IPv6 Address List (22)
>         Requested Option code: SIP Server Domain Name List (21)
>     Client Identifier
>         Option: Client Identifier (1)
>         Length: 10
>         Value: 00030001c43dc7b08f41
>         DUID: 00030001c43dc7b08f41
>         DUID Type: link-layer address (3)
>         Hardware type: Ethernet (1)
>         Link-layer address: c4:3d:c7:b0:8f:41
>     Reconfigure Accept
>         Option: Reconfigure Accept (20)
>         Length: 0
>     Fully Qualified Domain Name
>         Option: Fully Qualified Domain Name (39)
>         Length: 10
>         Value: 00076365726f77727400
>         0000 0... = Reserved: 0x00
>         .... .0.. = N bit: Server should perform DNS updates
>         .... ..0. = O bit: Server has not overridden client's S bit preference
>         .... ...0 = S bit: Server should not perform forward DNS updates
>         Domain: cerowrt
>     Identity Association for Non-temporary Address
>         Option: Identity Association for Non-temporary Address (3)
>         Length: 12
>         Value: 000000010000000000000000
>         IAID: 00000001
>         T1: 0
>         T2: 0
>     Identity Association for Prefix Delegation
>         Option: Identity Association for Prefix Delegation (25)
>         Length: 41
>         Value: 000000010000000000000000001a00190000000000000000...
>         IAID: 00000001
>         T1: 0
>         T2: 0
>         IA Prefix
>             Option: IA Prefix (26)
>             Length: 25
>             Value: 00000000000000003c000000000000000000000000000000...
>             Preferred lifetime: 0
>             Valid lifetime: 0
>             Prefix length: 60
>             Prefix address: :: (::)
>
> 0000  33 33 00 01 00 02 c4 3d c7 b0 8f 41 86 dd 60 00   33.....=...A..`.
> 0010  00 00 00 7d 11 01 fe 80 00 00 00 00 00 00 c6 3d   ...}...........=
> 0020  c7 ff fe b0 8f 41 ff 02 00 00 00 00 00 00 00 00   .....A..........
> 0030  00 00 00 01 00 02 02 22 02 23 00 7d da 1c 01 45   ......."".#.}...E
> 0040  eb 91 00 08 00 02 ff ff 00 06 00 0a 00 17 00 18   ................
> 0050  00 38 00 16 00 15 00 01 00 0a 00 03 00 01 c4 3d   .8.............=
> 0060  c7 b0 8f 41 00 14 00 00 00 27 00 0a 00 07 63 65   ...A.....'....ce
> 0070  72 6f 77 72 74 00 00 03 00 0c 00 00 00 01 00 00   rowrt...........
> 0080  00 00 00 00 00 00 00 19 00 29 00 00 00 01 00 00   .........)......
> 0090  00 00 00 00 00 00 00 1a 00 19 00 00 00 00 00 00   ................
> 00a0  00 00 3c 00 00 00 00 00 00 00 00 00 00 00 00 00   ..<.............
> 00b0  00 00 00                                          ...
>
> The CeroWRT system log is attached.  Nothing looks strange except the
> loss of ge00 link around 6:24 this morning, which is right around when
> I lost IPv4 connectivity to my Linux PC (I have a system monitoring
> this IP and it SMS's me if it goes down).  My PC's NIC link went down
> at exactly the same time.  At 7:24 is when I unplugged CeroWRT.

> Feb  1 03:44:30 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 03:47:19 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 03:49:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 03:50:22 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 03:53:35 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 03:56:41 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 03:57:04 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 03:58:00 cerowrt daemon.crit xinetd[2832]: 2832 {process_sensor} Adding 88.119.198.49 to the global_no_access list for 120 minutes
> Feb  1 03:58:28 cerowrt daemon.crit xinetd[2832]: 2832 {process_sensor} Adding 58.63.69.150 to the global_no_access list for 120 minutes
> Feb  1 03:59:08 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 03:59:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 03:59:42 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 04:02:32 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:06:00 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:08:47 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 04:09:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 04:11:20 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:13:56 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:18:43 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 04:19:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 04:20:12 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:21:43 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 04:22:12 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:28:35 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 04:29:14 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:29:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 04:31:12 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:32:44 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 04:36:44 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 04:38:16 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:39:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 04:39:44 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 04:41:10 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:44:21 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 04:47:58 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:49:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 04:50:43 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:53:37 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 04:56:01 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 04:57:45 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 04:58:14 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 04:59:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 05:01:41 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:04:28 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:07:24 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 05:09:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 05:09:54 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:13:36 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:13:40 cerowrt daemon.crit xinetd[2832]: 2832 {process_sensor} Adding 60.165.210.96 to the global_no_access list for 120 minutes
> Feb  1 05:16:00 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 05:17:49 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:19:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 05:22:10 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:25:36 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 05:26:55 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:29:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 05:29:44 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:34:45 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 05:35:04 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:37:35 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:39:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 05:43:33 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:44:03 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 05:46:24 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:49:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 05:52:14 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 05:53:29 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 05:55:50 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 05:58:48 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 05:59:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 06:00:20 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:03:02 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:04:52 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:08:20 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:09:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 06:11:32 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:12:22 cerowrt daemon.crit xinetd[2832]: 2832 {process_sensor} Adding 71.187.187.196 to the global_no_access list for 120 minutes
> Feb  1 06:13:23 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:18:19 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:19:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 06:21:03 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:21:21 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:24:12 cerowrt kern.info kernel: [5030779.328125] ge00: link down
> Feb  1 06:24:16 cerowrt kern.debug kernel: [5030783.343750] ar71xx: pll_reg 0xb8050014: 0x11110000
> Feb  1 06:24:16 cerowrt kern.info kernel: [5030783.343750] ge00: link up (1000Mbps/Full duplex)
> Feb  1 06:24:30 cerowrt kern.info kernel: [5030797.406250] ge00: link down
> Feb  1 06:24:55 cerowrt kern.debug kernel: [5030822.503906] ar71xx: pll_reg 0xb8050014: 0x11110000
> Feb  1 06:24:55 cerowrt kern.info kernel: [5030822.503906] ge00: link up (1000Mbps/Full duplex)
> Feb  1 06:27:56 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:29:14 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:29:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 06:31:07 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:36:39 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:38:47 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:38:55 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:39:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 06:44:26 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:46:36 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:47:26 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:49:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 06:52:47 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 06:54:47 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 06:56:36 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 06:59:00 cerowrt daemon.crit xinetd[2832]: 2832 {process_sensor} Adding 187.54.249.118 to the global_no_access list for 120 minutes
> Feb  1 06:59:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 07:02:03 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 07:02:53 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 07:05:08 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:07:25 cerowrt daemon.crit xinetd[2832]: 2832 {process_sensor} Adding 181.50.13.174 to the global_no_access list for 120 minutes
> Feb  1 07:09:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 07:11:33 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 07:11:35 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 07:13:52 cerowrt daemon.info xinetd[2832]: At least 1 DENY_TIME has expired, global_no_access list updated
> Feb  1 07:14:12 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:19:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 07:20:09 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 07:20:30 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 07:23:36 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:24:57 cerowrt kern.info kernel: [5034424.527343] ge00: link down
> Feb  1 07:29:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 07:29:41 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 07:29:50 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 07:32:36 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:38:52 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
> Feb  1 07:39:12 cerowrt daemon.info hostapd: sw00: STA 74:e5:43:69:09:da IEEE 802.11: authenticated
> Feb  1 07:39:12 cerowrt daemon.info hostapd: sw00: STA 74:e5:43:69:09:da IEEE 802.11: associated (aid 2)
> Feb  1 07:39:12 cerowrt daemon.info hostapd: sw00: STA 74:e5:43:69:09:da RADIUS: starting accounting session 52806EEC-0000005B
> Feb  1 07:39:12 cerowrt daemon.info hostapd: sw00: STA 74:e5:43:69:09:da WPA: pairwise key handshake completed (RSN)
> Feb  1 07:39:12 cerowrt daemon.info dnsmasq-dhcp[2896]: DHCPDISCOVER(sw00) 172.30.42.74 74:e5:43:69:09:da
> Feb  1 07:39:12 cerowrt daemon.info dnsmasq-dhcp[2896]: DHCPOFFER(sw00) 172.30.42.74 74:e5:43:69:09:da
> Feb  1 07:39:12 cerowrt daemon.info dnsmasq-dhcp[2896]: DHCPREQUEST(sw00) 172.30.42.74 74:e5:43:69:09:da
> Feb  1 07:39:12 cerowrt daemon.info dnsmasq-dhcp[2896]: DHCPACK(sw00) 172.30.42.74 74:e5:43:69:09:da a
> Feb  1 07:39:12 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:39:13 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-SOLICIT(sw00) 74:e5:43:69:09:da
> Feb  1 07:39:13 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:39:14 cerowrt daemon.info dnsmasq-dhcp[2896]: SLAAC-CONFIRM(sw00) 2001:470:89c6:1:76e5:43ff:fe69:9da a
> Feb  1 07:39:15 cerowrt daemon.info dnsmasq-dhcp[2896]: DHCPINFORMATION-REQUEST(sw00) 00:04:fc:3a:bd:af:bb:b3:64:10:e1:fd:72:cf:0f:0c:c1:14 a
> Feb  1 07:39:19 cerowrt authpriv.info dropbear[3709]: Child connection from 172.30.42.74:53620
> Feb  1 07:39:20 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:39:25 cerowrt authpriv.info dropbear[3709]: Exit before auth: Exited normally
> Feb  1 07:39:28 cerowrt authpriv.info dropbear[3710]: Child connection from 172.30.42.74:53621
> Feb  1 07:39:35 cerowrt authpriv.warn dropbear[3710]: Login attempt for nonexistent user from 172.30.42.74:53621
> Feb  1 07:39:37 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:39:38 cerowrt daemon.info hostapd: sw00: STA 74:e5:43:69:09:da WPA: group key handshake completed (RSN)
> Feb  1 07:39:38 cerowrt daemon.info hostapd: sw00: STA e0:75:7d:6c:67:de WPA: group key handshake completed (RSN)
> Feb  1 07:39:39 cerowrt authpriv.warn dropbear[3710]: Login attempt for nonexistent user from 172.30.42.74:53621
> Feb  1 07:39:44 cerowrt authpriv.warn dropbear[3710]: Login attempt for nonexistent user from 172.30.42.74:53621
> Feb  1 07:39:44 cerowrt authpriv.info dropbear[3710]: Exit before auth: Exited normally
> Feb  1 07:39:45 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw10) 2001:470:89c6:2::
> Feb  1 07:39:52 cerowrt kern.debug kernel: [5035318.730468] icmpv6_send: no reply to icmp error
> Feb  1 07:39:55 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:39:56 cerowrt kern.debug kernel: [5035322.816406] icmpv6_send: no reply to icmp error
> Feb  1 07:40:00 cerowrt kern.debug kernel: [5035327.488281] icmpv6_send: no reply to icmp error
> Feb  1 07:40:07 cerowrt authpriv.info dropbear[3712]: Child connection from 172.30.42.74:53629
> Feb  1 07:40:10 cerowrt kern.debug kernel: [5035336.816406] icmpv6_send: no reply to icmp error
> Feb  1 07:40:13 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(sw00) 2001:470:89c6:1::
> Feb  1 07:40:13 cerowrt authpriv.notice dropbear[3712]: Password auth succeeded for 'root' from 172.30.42.74:53629
> Feb  1 07:40:28 cerowrt kern.debug kernel: [5035355.472656] icmpv6_send: no reply to icmp error
> Feb  1 07:40:43 cerowrt kern.info kernel: [5035370.363281] device ge00 entered promiscuous mode
> Feb  1 07:40:44 cerowrt kern.info kernel: [5035371.164062] device ge00 left promiscuous mode
> Feb  1 07:40:46 cerowrt kern.info kernel: [5035372.847656] device ge00 entered promiscuous mode
> Feb  1 07:40:49 cerowrt kern.info kernel: [5035376.109375] device ge00 left promiscuous mode
> Feb  1 07:46:37 cerowrt daemon.info dnsmasq-dhcp[2896]: RTR-ADVERT(se00) 2001:470:89c6::
_______________________________________________
Cerowrt-devel mailing list
Cerowrt-devel@lists.bufferbloat.net
https://lists.bufferbloat.net/listinfo/cerowrt-devel",David Taht,2014-03-25 20:22:01.261066,2014-03-25 20:44:53.40748,Dave Täht,Closed,Normal
435,codel,"Typo in ""Best Practices"" document?","- wiki page Best_Practices_for_Benchmarking_CoDel_and_FQ_CoDel
- section ""Hardware Rate Limiting""
- final word is ""100Gbps""

should that read ""10Mbps"" rather than ""100Gbps""?",Ray Lehtiniemi,2013-07-03 09:32:44.963243,2013-07-26 20:57:17.259926,Dave Täht,Closed,Normal
442,cerowrt,Wifi interfaces stop transmitting at least some traffic types after much traffic,"We have been seeing a bug in (only wifi) interfaces so far where after a significant amount of
traffic is transferred some traffic (notably tcp synacks, but other forms of traffic too),
start failing to be transmitted back to the STA.

We have thus far ruled out syn flood protection, & 6in4 encapsulation. Some users never see
the problem, others can get it to happen in a few hours.",Dave Täht,2014-04-05 09:30:12.933587,2014-10-07 09:57:39.164666,Dave Täht,Closed,Immediate
353,cerowrt,possible ipv6 multicast issue,"See item 5.


---------- Forwarded message ----------
From: David Miller <davem@davemloft.net>
Date: Fri, Apr 6, 2012 at 10:35 AM
Subject: [GIT] Networking
To: torvalds@linux-foundation.org
Cc: akpm@linux-foundation.org, netdev@vger.kernel.org,
linux-kernel@vger.kernel.org



1) Fix inaccuracies in network driver interface documentation, from
  Ben Hutchings.

2) Fix handling of negative offsets in BPF JITs, from Jan Seiffert.

3) Compile warning, locking, and refcounting fixes in netfilter's
  xt_CT, from Pablo Neira Ayuso.

4) phonet sendmsg needs to validate user length just like any
  other datagram protocol, fix from Sasha Levin.

5) Ipv6 multicast code uses wrong loop index, from RongQing Li.

6) Link handling and firmware fixes in bnx2x driver from Yaniv
  Rosner and Yuval Mintz.

7) mlx4 erroneously allocates 4 pages at a time, regardless of page
  size, fix from Thadeu Lima de Souza Cascardo.

8) SCTP socket option wasn't extended in a backwards compatible
  way, fix from Thomas Graf.

9) Add missing address change event emissions to bonding, from
  Shlomo Pongratz.

10) /proc/net/dev regressed because it uses a private offset to
   track where we are in the hash table, but this doesn't
   track the offset pullback that the seq_file code does
   resulting in some entries being missed in large dumps.

   Fix from Eric Dumazet.

11) do_tcp_sendpage() unloads the send queue way too fast, because
   it invokes tcp_push() when it shouldn't.  Let the natural sequence
   generated by the splice paths, and the assosciated MSG_MORE
   settings, guide the tcp_push() calls.

   Otherwise what goes out of TCP is spaghetti and doesn't batch
   effectively into GSO/TSO clusters.

   From Eric Dumazet.

12) Once we put a SKB into either the netlink receiver's queue
   or a socket error queue, it can be consumed and freed up,
   therefore we cannot touch it after queueing it like that.

   Fixes from Eric Dumazet.

13) PPP has this annoying behavior in that for every transmit
   call it immediately stops the TX queue, then calls down
   into the next layer to transmit the PPP frame.

   But if that next layer can take it immediately, it just
   un-stops the TX queue right before returning from the
   transmit method.

   Besides being useless work, it makes several facilities
   unusable, in particular things like the equalizers.  Well
   behaved devices should only stop the TX queue when they
   really are full, and in PPP's case when it gets backlogged
   to the downstream device.

   David Woodhouse therefore fixed PPP to not stop the TX
   queue until it's downstream can't take data any more.

14) IFF_UNICAST_FLT got accidently lost in some recent stmmac
   driver changes, re-add.  From Marc Kleine-Budde.

15) Fix link flaps in ixgbe, from Eric W. Multanen.

16) Descriptor writeback fixes in e1000e from Matthew Vick.

Please pull, thanks a lot!

The following changes since commit 314489bd4c7780fde6a069783d5128f6cef52919:

 Merge tag 'fixes-for-linus' of
git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc (2012-04-05
22:13:39 -0700)

are available in the git repository at:

 git://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git master

Artem Savkov (1):
     r8169: enable napi on resume.

Ben Hutchings (6):
     ethtool: Remove exception to the requirement of holding RTNL lock
     doc, net: Remove obsolete reference to dev->poll
     doc, net: Update documentation of synchronisation for TX multiqueue
     doc, net: Update netdev operation names
     doc, net: Remove instruction to set net_device::trans_start
     doc, net: Update ndo_start_xmit return type and values

Bruce Allan (1):
     e1000e: prevent oops when adapter is being closed and reset simultaneously

David S. Miller (2):
     Merge branch 'master' of git://git.kernel.org/.../jkirsher/net
     Merge branch 'master' of git://1984.lsi.us.es/net

David Woodhouse (1):
     ppp: Don't stop and restart queue on every TX packet

Eric Dumazet (5):
     net: fix /proc/net/dev regression
     tcp: allow splice() to build full TSO packets
     tcp: tcp_sendpages() should call tcp_push() once
     netlink: fix races after skb queueing
     net: fix a race in sock_queue_err_skb()

Fernando Luis Vazquez Cao (1):
     TCP: update ip_local_port_range documentation

Jan Beulich (1):
     netfilter: xt_LOG: don't use xchg() for simple assignment

Jan Engelhardt (1):
     netfilter: ipset: avoid use of kernel-only types

Jan Seiffert (2):
     bpf jit: Make the filter.c::__load_pointer helper non-static for the jits
     bpf jit: Let the x86 jit handle negative offsets

Marc Kleine-Budde (1):
     stmmac: re-add IFF_UNICAST_FLT for dwmac1000

Matthew Vick (1):
     e1000e: Guarantee descriptor writeback flush success.

Multanen, Eric W (1):
     ixgbe: driver fix for link flap

Pablo Neira Ayuso (4):
     netfilter: xt_CT: remove a compile warning
     netfilter: xt_CT: allocation has to be GFP_ATOMIC under
rcu_read_lock section
     netfilter: xt_CT: fix missing put timeout object in error path
     netfilter: nf_conntrack: fix count leak in error path of
__nf_conntrack_alloc

RongQing.Li (1):
     ipv6: fix array index in ip6_mc_add_src()

Sasha Levin (1):
     phonet: Check input from user before allocating

Shlomo Pongratz (2):
     net/bonding: emit address change event also in bond_release
     net/bonding: correctly proxy slave neigh param setup ndo function

Srinivas Kandagatla (1):
     phy:icplus:fix Auto Power Saving in ip101a_config_init.

Thadeu Lima de Souza Cascardo (1):
     mlx4: allocate just enough pages instead of always 4 pages

Thomas Graf (1):
     sctp: Allow struct sctp_event_subscribe to grow without breaking binaries

Veaceslav Falico (1):
     bonding: properly unset current_arp_slave on slave link up

Yaniv Rosner (10):
     bnx2x: PFC fix
     bnx2x: Fix BCM57810-KR FC
     bnx2x: Fix BCM57810-KR AN speed transition
     bnx2x: Fix BCM578x0-SFI pre-emphasis settings
     bnx2x: Restore 1G LED on BCM57712+BCM8727 designs.
     bnx2x: Fix link issue for BCM8727 boards.
     bnx2x: Fix BCM84833 PHY FW version presentation
     bnx2x: Clear BCM84833 LED after fan failure
     bnx2x: Fix BCM57711+BCM84823 link issue
     bnx2x: Clear MDC/MDIO warning message

Yuval Mintz (1):
     bnx2x: correction to firmware interface

stephen hemminger (2):
     sky2: copy received packets on inefficient unaligned architecture
     MAINTAINERS: update for Marvell Ethernet drivers

 Documentation/networking/driver.txt                |   31 ++--
 Documentation/networking/ip-sysctl.txt             |   11 +-
 Documentation/networking/netdevices.txt            |   25 ++--
 MAINTAINERS                                        |   19 +--
 arch/x86/net/bpf_jit.S                             |  122 +++++++++++----
 arch/x86/net/bpf_jit_comp.c                        |   41 +++--
 drivers/net/bonding/bond_main.c                    |   60 ++++++-
 drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c    |    1 -
 .../net/ethernet/broadcom/bnx2x/bnx2x_fw_defs.h    |  110 +++++++-------
 drivers/net/ethernet/broadcom/bnx2x/bnx2x_link.c   |  147 +++++++++++++----
 drivers/net/ethernet/broadcom/bnx2x/bnx2x_reg.h    |    8 +
 drivers/net/ethernet/intel/e1000e/e1000.h          |    6 +
 drivers/net/ethernet/intel/e1000e/netdev.c         |   26 +++
 drivers/net/ethernet/intel/ixgbe/ixgbe_dcb_nl.c    |  164 ++++++++++----------
 drivers/net/ethernet/marvell/sky2.c                |   13 ++-
 drivers/net/ethernet/mellanox/mlx4/mlx4_en.h       |    5 +-
 drivers/net/ethernet/realtek/r8169.c               |    3 +
 drivers/net/ethernet/stmicro/stmmac/stmmac_main.c  |    6 +-
 drivers/net/phy/icplus.c                           |    3 +-
 drivers/net/ppp/ppp_generic.c                      |   14 +-
 fs/splice.c                                        |    5 +-
 include/linux/ethtool.h                            |    3 +-
 include/linux/netdevice.h                          |    2 -
 include/linux/netfilter/xt_set.h                   |    4 +-
 include/linux/socket.h                             |    2 +-
 include/net/netfilter/xt_log.h                     |    2 +-
 net/core/dev.c                                     |   58 ++------
 net/core/dev_addr_lists.c                          |    3 +-
 net/core/filter.c                                  |    9 +-
 net/core/skbuff.c                                  |    4 +-
 net/ipv4/tcp.c                                     |    2 +-
 net/ipv6/mcast.c                                   |    2 +-
 net/netfilter/nf_conntrack_core.c                  |    1 +
 net/netfilter/xt_CT.c                              |   28 +++-
 net/netlink/af_netlink.c                           |   24 ++--
 net/phonet/pep.c                                   |    3 +
 net/sctp/socket.c                                  |    5 +-
 net/socket.c                                       |    6 +-
 38 files changed, 602 insertions(+), 376 deletions(-)",David Taht,2012-04-06 11:31:08.047925,2012-04-19 23:46:40.290421,David Taht,Closed,Normal
277,cerowrt,Fwd: [OpenWrt-Devel] [PATCH] correct fair traffic sharing support in qos-scripts,"---------- Forwarded message ----------
From: Weedy <weedy2887@gmail.com>
Date: Fri, Sep 23, 2011 at 4:37 PM
Subject: Re: [OpenWrt-Devel] [PATCH] correct fair traffic sharing
support in qos-scripts
To: OpenWrt Development List <openwrt-devel@lists.openwrt.org>


On 16/11/10 01:55 PM, Ben Pfountz wrote:
> This patch updates qos-scripts to support fair traffic sharing using the
> SFQ with external classifiers method.  It also corrects a bug in the
> unsupported ESFQ method already used by qos-scripts.  (ESFQ:
> http://fatooh.org/esfq-2.6/ only updated to 2.6.24, it was switched to
> an SFQ patch after that and not updated since 2008)
>
> A class can be forced to use SFQ, and an external classifier added like
> this:
>
> config class ""Normal""
>         option avgrate     10
>         option priority    30
>         option packetdelay 100
>         option limitrate   94
> #       option qdisc      ""sfq perturb 2""
> config class ""Normal_up""
> #       option filter   ""protocol all flow hash keys src divisor 1024""
> config class ""Normal_down""
> #       option filter   ""protocol all flow hash keys dst divisor 1024""
>
> Using these options, the user needs to load cls_flow before qos-scripts
> starts.
>
> I've got more information here:
> http://oneitguy.com/blogs/netprince/fair-traffic-sharing-esfq-broken-switching-sfqexternal-classifiers
>
>
> This has been tested on r23914.
>
> Signed-off-by: Ben Pfountz <netprince<>vt_edu>

I am bumping this so we can get a current patch.
_______________________________________________
openwrt-devel mailing list
openwrt-devel@lists.openwrt.org
https://lists.openwrt.org/mailman/listinfo/openwrt-devel",David Taht,2011-09-24 03:58:32.0764,2011-11-18 07:54:17.956447,David Taht,In Progress,High
260,cerowrt,"WAN port won't DHCP successfully (it would not receive packets, but would transmit them)","In smoketest 4 of RC6, the WAN port would not DHCP on my local network; which is a bit of a mess.

It was plugged into a DLINK DGS-2208 Gigabit switch, which is plugged into a 100Mbit switch, which is plugged into a WNDR3700v2 (running the Bismark build).

Hypothesis: it might have problems if it sees ethernet pause frames.  I first became aware of pause frames when I saw them in a wireshark capture I took off this switch last fall.

My laptops dhcp off this switch just fine, FWIW.",Jim Gettys,2011-09-01 19:42:41.749982,2012-04-21 12:27:41.601628,David Taht,Closed,High
448,cerowrt,pimd is running away on interior router,"I installed two interior routers.  I noticed that the load was always above 1 on those routers (the exterior gateway was ok), pimd was the culprit.

I disabled pimd, which doesn't have much use at the moment (since I don't use IPv6 multicast applications).  And as we don't have hnetd atm to delegate IPv6 prefixes and I'm not bothering to try, this is a theory as to why pimd is only running away on the interior routers; the exterior router has global IPv6 addresses.

Attached are dmesg.txt and logread.txt files of the complaints it is producing.

",Jim Gettys,2014-09-12 13:13:53.415661,2014-09-12 13:17:23.672091,David Taht,New,High
332,cerowrt,the new SFQ with low limits and many flows exhibits starvation issues,"I am getting some reports of SFQ's new 'head drop' orientation causing starvation.

More details to come",Dave Täht,2012-01-30 15:11:44.874403,2012-04-19 23:58:46.024682,David Taht,Closed,Urgent
229,cerowrt,Renumbering interfaces is painful via the web interface,"with 6 interfaces, and a dns server, and access to the router controlled by iptables and xinetd, it's hard to renumber interfaces to have a different subnet allocation - and ipv6 is also problematic.

I have a simple script that does 95% of the work that could be improved to also be accessible via luci ""renumber/rename home network"" - which would eliminate the tedium.",Dave Täht,2011-08-16 16:29:40.789743,2012-04-21 13:11:32.502325,David Taht,New,High
295,cerowrt,"Fwd: netem: Gilbert, Simple Gilbert, Bernouli loss model broken","-------- Original Message --------
Subject: 	netem: Gilbert, Simple Gilbert, Bernouli loss model broken
Date: 	Tue, 8 Nov 2011 12:40:29 +0100
From: 	Marcus Wermuth <marcus.wermuth@gmail.com>
To: 	netdev@vger.kernel.org



Hey,

I wanted to try the netem extension to setup a loss via Gilbert,
Simple Gilbert, Bernouli loss model[1]. Kernel support is included
since several releases. But configuration as demonstrated in [1] does
not work at all. It seems that the userspace part in iproute is
missing, the original patch from the authors does not work.

Does anybody know about that?

Bye, Marcus

(I'm not subscribed to netdev-list)

[1] http://netgroup.uniroma2.it/twiki/bin/view.cgi/Main/NetemCLG",David Taht,2011-11-08 03:49:36.53016,2012-04-20 00:04:11.357171,David Taht,Closed,Normal
290,cerowrt,Fwd: [RFC] ipv6 over wireless classification issue?,"-------- Original Message --------
Subject: 	[RFC] ipv6 over wireless classification issue?
Date: 	Sun, 23 Oct 2011 12:23:25 +0200
From: 	David Täht <dave.taht@gmail.com>
Organization: 	Bufferbloat.net
To: 	bloat-devel@lists.bufferbloat.net, ""linux-wireless@vger.kernel.org"" 
<linux-wireless@vger.kernel.org>



After slowly working my way down from verifying the apps to ECN handling
and up from the drivers... I've been (also) slowly working on getting
wireless qos/aqms to work better, on ipv6. (I need to get to having a
spectrum analyzer or better instrumentation...) I was puzzled about dscp
marked ipv6 packets responding differently.

Perhaps this is it. I'm not making this a commit yet (untested code!)

d@cruithne:~/git/linux-2.6/include$ git diff
diff --git a/net/wireless/util.c b/net/wireless/util.c
index be75a3a..a11c5f2 100644
--- a/net/wireless/util.c
+++ b/net/wireless/util.c
@@ -658,6 +658,12 @@ unsigned int cfg80211_classify8021d(struct sk_buff
*skb)
          case htons(ETH_P_IP):
                  dscp = ip_hdr(skb)->tos&  0xfc;
                  break;
+       case htons(ETH_P_IPV6):
+               dscp = ipv6_get_dsfield(ipv6_hdr(skb))&  0xfc;
+               break;
+       case htons(ETH_P_ARP):
+               dscp = 4<<5;
+               break;
          default:
                  return 0;
          }


A) Elsewhere in the stack ipv4_get_dsfield is the equivalent of the
ip_hdr(skb)->tos&  0xfc line
B) It appears ipv6_get_dsfield is safe to call from non-ipv6 enabled
systems

So my thought would be to also harmonize this with ipv4_get_dsfield...

C) And I doubt that slamming arp packets into the VI queue would be
acceptable yet (as per the ANTs discussion of a few months back, ARP,
ND, RA, RS, DHCP, and possibly DNS, ssh (marked interactive), etc might
do better in the VI queue)
(however this part of the patch is not relevant to the IPv6 issue, it's
just the patch I wanted to try)

D) Lastly, Later on in this function only dscp's first 3 bits (CS0 -
CS7) are used to classify packets into the queues, where a mildly saner
version would use a lookup table to also do sane things with the
'immediate' bit, perhaps settable via userspace from via sysfs, sysctl,
or proc.",David Taht,2011-10-23 03:30:13.796752,2012-04-21 13:16:44.904828,David Taht,In Progress,Normal
288,cerowrt,Duplicate pings bother me,"In a recent experiment with cerowrt, some duplicate pings were seen, largely when the network was otherwise idle. 

I am really hard pressed to think of circumstances where seeing duplicate pings can happen, given the various forms of ARQ and block acks built into 802.11n. The fact that it was happening on an idle (2 hop) network implies (to me) that single packet transfers may have an issue in retries that multipacket transfers do not. 

Things that tweak me on this topic were the recent sack related analysis and dan's work on coverfire

http://www.coverfire.com/archives/2011/10/15/linux-flow-classifier-proto-dst-and-tos/

which pointed to oddball packets being mishandled elsewhere in the stack. The experiment was otherwise successful, showing a distinct improvement in latency when a txqueuelen of 37 was used vs a txqueuelen of 1000, on the router, and for all I know there ARE circumstances in 802.11n where you will see duplicate packets... but interestingly, no dups were seen in the txqueuelen 1000 test.

Further experiments are needed.


d@cruithne:~/org/lincstalk/bbloat$ grep -A 1 -B 1 DUP p1.txt # this was the txqueuelen 37 test:

64 bytes from 172.26.0.3: icmp_seq=67 ttl=63 time=1.237 ms
64 bytes from 172.26.0.3: icmp_seq=67 ttl=63 time=67.926 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=68 ttl=63 time=1.503 ms
--
64 bytes from 172.26.0.3: icmp_seq=104 ttl=63 time=2.624 ms
64 bytes from 172.26.0.3: icmp_seq=104 ttl=63 time=108.333 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=105 ttl=63 time=14.603 ms
--
64 bytes from 172.26.0.3: icmp_seq=115 ttl=63 time=1.543 ms
64 bytes from 172.26.0.3: icmp_seq=115 ttl=63 time=72.641 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=116 ttl=63 time=60.502 ms
--
64 bytes from 172.26.0.3: icmp_seq=194 ttl=63 time=1.948 ms
64 bytes from 172.26.0.3: icmp_seq=194 ttl=63 time=169.254 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=195 ttl=63 time=1.486 ms
--
64 bytes from 172.26.0.3: icmp_seq=229 ttl=63 time=1.585 ms
64 bytes from 172.26.0.3: icmp_seq=229 ttl=63 time=75.449 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=230 ttl=63 time=3.115 ms
--
64 bytes from 172.26.0.3: icmp_seq=259 ttl=63 time=1.574 ms
64 bytes from 172.26.0.3: icmp_seq=259 ttl=63 time=77.107 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=260 ttl=63 time=1.253 ms
--
64 bytes from 172.26.0.3: icmp_seq=376 ttl=63 time=1.761 ms
64 bytes from 172.26.0.3: icmp_seq=376 ttl=63 time=78.557 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=377 ttl=63 time=1.333 ms
--
64 bytes from 172.26.0.3: icmp_seq=497 ttl=63 time=1.681 ms
64 bytes from 172.26.0.3: icmp_seq=497 ttl=63 time=72.170 ms (DUP!)
64 bytes from 172.26.0.3: icmp_seq=498 ttl=63 time=5.078 ms
",Dave Täht,2011-10-21 19:01:21.250368,2012-04-21 12:38:25.899303,David Taht,Closed,Normal
376,cerowrt,Fwd: [PATCH] tcp: fix infinite cwnd in tcp_complete_cwr(),"grumble


---------- Forwarded message ----------
From: Yuchung Cheng <ycheng@google.com>
Date: Sat, Apr 28, 2012 at 12:04 PM
Subject: [PATCH] tcp: fix infinite cwnd in tcp_complete_cwr()
To: davem@davemloft.net, ilpo.jarvinen@helsinki.fi
Cc: ncardwell@google.com, nanditad@google.com, netdev@vger.kernel.org,
Yuchung Cheng <ycheng@google.com>


When the cwnd reduction is done, ssthresh may be infinite
if TCP enters CWR via ECN or F-RTO. If cwnd is not undone, i.e.,
undo_marker is set, tcp_complete_cwr() falsely set cwnd to the
infinite ssthresh value. The correct operation is to keep cwnd
intact because it has been updated in ECN or F-RTO.

Signed-off-by: Yuchung Cheng <ycheng@google.com>
---
 net/ipv4/tcp_input.c |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/net/ipv4/tcp_input.c b/net/ipv4/tcp_input.c
index c93b0cb..ac417de 100644
--- a/net/ipv4/tcp_input.c
+++ b/net/ipv4/tcp_input.c
@@ -2868,11 +2868,13 @@ static inline void tcp_complete_cwr(struct sock *sk)

       /* Do not moderate cwnd if it's already undone in cwr or recovery. */
       if (tp->undo_marker) {
-               if (inet_csk(sk)->icsk_ca_state == TCP_CA_CWR)
+               if (inet_csk(sk)->icsk_ca_state == TCP_CA_CWR) {
                       tp->snd_cwnd = min(tp->snd_cwnd, tp->snd_ssthresh);
-               else /* PRR */
+               } else if (tp->snd_ssthresh < TCP_INFINITE_SSTHRESH) {
+                       /* PRR algorithm. */
                       tp->snd_cwnd = tp->snd_ssthresh;
-               tp->snd_cwnd_stamp = tcp_time_stamp;
+                       tp->snd_cwnd_stamp = tcp_time_stamp;
+               }
       }
       tcp_ca_event(sk, CA_EVENT_COMPLETE_CWR);
 }",David Taht,2012-04-28 16:17:28.070426,2014-06-24 19:59:47.797586,David Taht,Closed,High
202,cerowrt,STA mode is broken,Configuring for sta mode does not appear to work,Dave Täht,2011-07-10 15:50:32.126841,2011-08-03 04:48:27.265733,David Taht,Closed,Urgent
392,cerowrt,/tmp/log/babled.log grows and grows....,"My router had become very unstable: it would lock up and I would often try rebooting to no avail.  When I say ""lock up"", I mean I could no longer send packets via the wireless interfaces (or get a new address from it); the box would continue to forward packets from another router just fine.

Specifically, the router has been running 3.3.0-rc6 and is a WNDR3700v2.

On the theory I should try to figure out what happened after CeroWrt had been up for a long time, I suffered in silence.

Today, in response to mail on the cerowrt mailing list, I finally noticed that /tmp/log/babeld.log was huge.
-rw-r--r--    1 root     root        247936 May 24 12:27 babeld.log

As /tmp is a tmpfs, I suspect that this may be the cause of the unstableness.


root@gw-main:/tmp/log# tail babeld.log
Couldn't determine channel of interface gw00: Invalid argument.
Couldn't determine channel of interface gw10: Invalid argument.
Couldn't determine channel of interface gw00: Invalid argument.
Couldn't determine channel of interface gw10: Invalid argument.
Couldn't determine channel of interface gw00: Invalid argument.
Couldn't determine channel of interface gw10: Invalid argument.
Couldn't determine channel of interface gw00: Invalid argument.
Couldn't determine channel of interface gw10: Invalid argument.
Couldn't determine channel of interface gw00: Invalid argument.
Couldn't determine channel of interface gw10: Invalid argument.

Gives us another clue.

I should have squirreled away a copy of the whole file before nuking it, but I didn't.  /me bad.
",Jim Gettys,2012-05-24 09:45:34.091184,2014-06-24 19:56:56.013872,David Taht,Closed,High
336,cerowrt,Fwd: [PATCH 04/15] brcm80211: smac: fix endless retry of A-MPDU transmissions,"seeing this sort of stuff get fixed always cheers me up.

what I wonder about if is there a way to simulate radio issues like this
against j.random hardware so as to be able to finger the problem
via black box means.


---------- Forwarded message ----------
From: Arend van Spriel <arend@broadcom.com>
Date: Thu, Feb 9, 2012 at 9:08 PM
Subject: [PATCH 04/15] brcm80211: smac: fix endless retry of A-MPDU
transmissions
To: linville@tuxdriver.com
Cc: linux-wireless@vger.kernel.org, Arend van Spriel
<arend@broadcom.com>, Stanislaw Gruszka <sgruszka@redhat.com>


The A-MPDU code checked against a retry limit, but it was using
the wrong variable to do so. This patch fixes this to assure
proper retry mechanism.

This problem had a side-effect causing the mac80211 flush callback
to remain waiting forever as well. That side effect has been fixed
by commit by Stanislaw Gruszka:

commit f96b08a7e6f69c0f0a576554df3df5b1b519c479
Date:   Tue Jan 17 12:38:50 2012 +0100

   brcmsmac: fix tx queue flush infinite loop

   Reference:
   https://bugzilla.kernel.org/show_bug.cgi?id=42576

Cc: Stanislaw Gruszka <sgruszka@redhat.com>
Reviewed-by: Pieter-Paul Giesberts <pieterpg@broadcom.com>
Reviewed-by: Alwin Beukers <alwin@broadcom.com>
Signed-off-by: Arend van Spriel <arend@broadcom.com>
---
 drivers/net/wireless/brcm80211/brcmsmac/ampdu.c |    6 +-----
 1 files changed, 1 insertions(+), 5 deletions(-)

diff --git a/drivers/net/wireless/brcm80211/brcmsmac/ampdu.c
b/drivers/net/wireless/brcm80211/brcmsmac/ampdu.c
index d89dcb1..c1ce831 100644
--- a/drivers/net/wireless/brcm80211/brcmsmac/ampdu.c
+++ b/drivers/net/wireless/brcm80211/brcmsmac/ampdu.c
@@ -1051,17 +1051,13 @@ brcms_c_ampdu_dotxstatus_complete(struct
ampdu_info *ampdu, struct scb *scb,
               }
               /* either retransmit or send bar if ack not recd */
               if (!ack_recd) {
-                       struct ieee80211_tx_rate *txrate =
-                           tx_info->status.rates;
-                       if (retry && (txrate[0].count < (int)retry_limit)) {
+                       if (retry && (ini->txretry[index] < (int)retry_limit)) {
                               ini->txretry[index]++;
                               ini->tx_in_transit--;
                               /*
                                * Use high prededence for retransmit to
                                * give some punch
                                */
-                               /* brcms_c_txq_enq(wlc, scb, p,
-                                * BRCMS_PRIO_TO_PREC(tid)); */
                               brcms_c_txq_enq(wlc, scb, p,
                                               BRCMS_PRIO_TO_HI_PREC(tid));
                       } else {",David Taht,2012-02-09 12:14:45.984382,2012-04-21 12:35:49.827596,David Taht,Closed,Normal
196,cerowrt,Adding netem support to simulate latency,"Netem looks very useful to simulate latency and packet loss.

http://www.linuxfoundation.org/collaborate/workgroups/networking/netem

I've added support for it to the cerowrt and cerowrt-dbg builds, and proposed a package for openwrt.

https://dev.openwrt.org/ticket/8839#comment:3",Dave Täht,2011-06-05 05:27:57.539922,2013-01-29 20:57:09.837332,Jim Gettys,Closed,Normal
276,cerowrt,JetDirect protocol does not seem to be working between networks,"There is some sort of discovery protocol that JetDirect uses (or at least the Linux printing system uses to discover printers on the net).

This does not seem to be working; whether it can/should work in a routed world is less clear.

I don't see this as highly important right now, but maybe someday...",Jim Gettys,2011-09-22 15:32:30.481389,2012-04-20 00:02:57.502594,Jim Gettys,Closed,High
118,cerowrt,SFB requires a new iproute2,"While you can use SFB without a newer tc, it helps to control it better if you have a new tc.

The tc utility is heavily dependended on by other tools, so instead of using a separate feed for it, we need to patch openwt.",Dave Täht,2011-05-07 21:33:42.976515,2013-03-27 23:32:04.802588,Jim Gettys,Closed,Normal
28,sysadmin,Outiline of some topics,"[[bloat:Outline]]
(This is more or less hidden, you can only get to it via the titles index)

Feel free to review where to go with it.

I started pounding through urls and references but I gotta admit that xml,html,and wiki conversions to textile is tedious. 

I ran out of steam tonight. Will resume in the morning. It was a good test of the interactivity of the wiki.I only crashed it once.",Dave Täht,2011-01-26 20:59:47.513043,2011-01-27 08:50:50.962625,Jim Gettys,New,Normal
32,sysadmin,kernel build cluster,"It would improve cycle/test times if we could find a clustering solution/provider that we could light up for kernel builds. 

My usual inclination is to find someone willing to donate time, but I suspect that even one large EC2 instance would help.",Dave Täht,2011-02-01 09:13:16.440476,2011-02-01 09:36:19.17417,Jim Gettys,New,Normal
29,sysadmin,Load testing results,"after only achieving 2.5 req/sec via SSL, and being scared of a slashdotting, I did some more load testing,
this time against SSL and non-SSL between siwa and shipka/

2.5 req/sec for SSL (77% of cpu in apache, 500ms latency)
10 req/sec (77% of cpu in ruby, 60 ms latency) 

The bottleneck has now moved to the ruby process(es). Sigh. I guess I will have to look over passenger more.
I trust fcgi. Given the effect on permissions problems, etc, switching at this late date scares me. 

This was a lot closer to my original goal of 50,000 hits/hr

I've enabled both https and http for now.

I do note that the ping test does not test overall real throughput, as it really only exercises a connection attempt.

The results with -Q turned on (persistent requests) were nearly identical however. (60 ms latencies), so I would think the end comparison against the real site would be much closer in results as it makes multiple requests per page. 

I would still like it very much if we could force logined users to be running over the SSL connection. And maybe an SSL certificate with less bits would be faster and still make me feel comfortable with putting mission critical data on redmine.

",Dave Täht,2011-01-26 21:46:08.754388,2011-01-26 22:07:50.789475,Jim Gettys,New,Normal
30,sysadmin,Add reduced bufferbloat logo & Creative commons attributio n,"need the jigsawfish logo on the front page, (reduced somewhat ) and when editing new pages, suggest the creative commons license, and default to that.


(I don't want to use an external link for the images, however)",Dave Täht,2011-01-27 10:26:31.094573,2011-01-27 13:54:27.949953,Jim Gettys,In Progress,Normal
281,cerowrt,Bind configuration needs Lucification.,"Right now, entering, for example, upstream name servers into the Luci page for configuration doesn't work.  This gets people both in corporate environments (since the local name servers may show domains not publicly available), and for configuring things
like Comcast's nice DNSSEC capable name servers.

So we need to get bind properly integrated into the UI.

As far as exactly what to do for this particular problem, this captures a quick conversation:

<pre>
<dtaht99>  chroot/etc/bind/conf/forwarders.conf
<dtaht99> uncomment named.conf's forwarders line
<dtaht99> walla
<dtaht99> edit /etc/bind/conf/forwarders.conf
<dtaht99> to point at those
<dtaht99> have a script rewrite them if needed
<jg> ok; seems like a plan.
</pre>
",Jim Gettys,2011-09-27 12:40:37.411936,2011-11-18 07:44:05.649371,Jim Gettys,New,High
210,cerowrt,setting ring buffer size below 64 via ethtool on the ar71xx hangs the driver at gigE speeds,"If the wan is on gigE and IF you are getting serious network traffic before you run ethtool, the ring buffer doesn't get updated right, and you stop getting traffic at 7 packets. Worse, ethtool runs AFTER dhcp, so you do get a valid ip address, then ethtool -g tx 4 runs and locks up the card.

This showed up in our testing in the last couple days. You unplug and replug, it sets up the driver right that time, and life is good, and we achieve 100+Mbit/sec speeds with VERY low latency. 

I can duplicate it every time now, but was faarrrr too tired after debugging the problem for 2 days straight to figure out where it was, but I think it should be easy to find.

Basically, the debloat package in cerowrt would trigger it - but only under those circumstances. Saw it, maybe, rarely, on 100Mbit on the wan port. It explains a lot - reports of dhcp problems, etc, etc.
",Dave Täht,2011-07-16 14:09:54.139672,2012-04-21 12:35:46.893731,Jim Gettys,Closed,High
41,bloat,Battlemesh - Jim Gettys appearance ,"Jim Gettys will be giving two talks at the upcoming ""Battlemesh conference"":http://battlemesh.org/BattleMeshV4/Agenda March 16-19, in 
Sant Bartomeu del Grau (SBG for short), near Barcelona, Catalunia, Spain. 

One will be a condensed version of the existing Bell Labs bufferbloat talk, the other will be about OLPC meltdowns. 

There are also interesting talks scheduled about babel-z, the mesh potato, and other topics of interest to the mesh networking community.

Not to mention the battle of the mesh technologies! I have some hope that the best debloated router will win!",Dave Täht,2011-03-05 10:26:14.143724,2011-03-21 14:03:11.31623,Jim Gettys,Closed,Normal
261,cerowrt,home.lan should always be in the DNS search list.,"Along with whatever domain the router is serving...

In any case, after the installation, the router isn't serving thegettys.net in its dns search path.

I'm not 100% sure about this though.",Jim Gettys,2011-09-02 17:06:54.146416,2011-11-18 09:08:11.427535,Jim Gettys,New,Normal
248,cerowrt,Failure to meet expectations,"Why is it, that despite trying to get testers to be interested in - for example, trying babel and mesh routing on the extra interfaces... or configuring their own web server... running dns and dnssec... or playing with the cerowrt web proxy... or doing network bandwidth and latency under load tests... or reporting back on the quality of the wifi interface... playing with ahcp... or seeing the utility of having a guest interface... etc?

I'm not whining, I just had hoped we'd tried hard enough to encourage folk to do things differently with what we were trying to do and documented, here:

http://jupiter.lab.bufferbloat.net/cerowrt/about.html

http://jupiter.lab.bufferbloat.net/cerowrt/features.html

To get peeps fiddling with that stuff rather than fitting the whole smeer into their pre-conceptions of how to do this stuff.

So I'm willing to try and address all these 'it's not the same as a normal router' issues, but trying to change at least a few of those preconceptions along the way would be helpful. Ideas?",Dave Täht,2011-08-23 15:23:28.678389,2012-04-21 12:31:50.770085,Jim Gettys,New,Normal
282,cerowrt,Build ceroWRT,"Hi all!

I try to build cerowrt with script ""build_cero.sh init"" but this script give me an error:


Resolving deltas: 100% (1270/1270), done.
Initialized empty Git repository in /home/marc/cerofiles/src/cerowrt/.git/
warning: remote HEAD refers to nonexistent ref, unable to checkout.

Building sub-repositories
./build_cero.sh: line 47: ./scripts/env: No such file or directory
./build_cero.sh: line 48: cd: env: No such file or directory
fatal: Couldn't find remote ref master
./build_cero.sh: line 51: cd: /root/src/cerowrt/files: No such file or directory
cat: /root/src/cerowrt/env/dirs.list: No such file or directory
mkdir: missing operand
Try `mkdir --help' for more information.
feeds.conf hates ~ syntax
cat: env/feeds.remote.conf: No such file or directory
updating feeds
./build_cero.sh: line 63: ./scripts/feeds: No such file or directory
cat: env/packages.list: No such file or directory
./build_cero.sh: line 64: ./scripts/feeds: No such file or directory
cp: cannot stat `.config': No such file or directory
make: *** No rule to make target `defconfig'.  Stop.
cat: .config: No such file or directory
cat: config.orig: No such file or directory


I don't know if this is the correct site to post my problem..",Marc Franco,2011-09-30 01:49:33.400624,2012-03-26 07:15:23.550633,Jim Gettys,In Progress,Normal
122,cerowrt,DNSSec enabled and split dns enabled default setup,"with a DNSSec enabled and split dns enabled default setup that ""just worked"" out of the box, bind could be an adaquate substitute and superset for dnsmasq in the name services case.

That said dnsmasq has a much tighter integration with dhcp than we do at present.

On the gripping hand, it would be a great proof of concept",Dave Täht,2011-05-07 23:13:31.48673,2012-04-21 12:42:07.061322,Jim Gettys,Feedback,Normal
233,cerowrt,BIND 9 behaves REALLY REALLY badly when in a walled garden,"When I am in this hotel, where DNS (and most packets) are blocked off-net until I click through a captive portal, BIND 9 will not resolve any names, and my laptop cannot either.

I propose that some checking script be in place which does a DNS lookup to the ge00-provided name server addresses, and if it returns data, then BIND be configured normally.  If this look-up fails, BIND should be configured as a forwarder to the dhcp-provided name servers.",Michael Graff,2011-08-17 20:30:51.585291,2011-11-18 08:31:18.428392,Jim Gettys,In Progress,High
11,sysadmin,Existing Database dumps,"Given the amount of text in the bufferbloat catagory thus far it seems apparent that the dump you gave me was the wrong one, because none of that was in there. 

If you have a great deal of data left in it, I can help slam it online, if you dump it.

Similarly a plain text dump of your wordpress db.

Also, all I saw of the old site last night was 2 issues in the sysadm catagory.

 ",Dave Täht,2011-01-24 08:42:20.847226,2011-03-22 07:19:43.876992,Jim Gettys,In Progress,Normal
211,uberwrt,"cerowrt-chrome breaks on firefox 3.6.17, 3.6.18 and CSS is mildy borked regardless","On safari and chrome the on-board web pages work, except that the css shows the nav bar mildly wrong.

On firefox 3.6.17 and 3.6.18, however, it is making links look like centered menus...

",Dave Täht,2011-07-16 14:16:36.150219,2011-07-19 11:00:17.281899,Jim Gettys,Closed,Normal
412,cerowrt,dansguardian is needed....,"For those of us with kids...

Polipo can easily be configured to use it, it appears, and dansguardian is in OpenWrt already.
",Jim Gettys,2012-10-25 17:31:23.273895,2014-05-14 11:36:30.532729,Jim Gettys,Closed,High
25,sysadmin,Get off of the existing DNS provider,"I mean, they probably have a nice wysiwig gui but sending mispellings to an ad server has made me mildly nuts.

I misspelt siwa as sima once and nearly trashed part of the system as I ended up on shipka without noticing it.

Additionally:

They return entirely bogus ipv6 records on a misspelling. Worse, if I use ""search bufferbloat.net"", they ALWAYS return a bogus ipv6 record, making lookups to anywhere, like us.ubuntu.com fail, initially, and fall back to ipv4.

At one level I remain glad we did this with ipv6 included. It was and remains a good experiment. I had no idea that normal people had to cope with this level of marketing driven stupidity all over the internet, nor how bad it will affect the ipv6 rollout. 

At another level I want to go visit the guys borking how DNS is supposed to work, and shoot them all in the head. It would be intensely satisfying and well worth the lifetime jail term. Spammers are more elusive than these guys... 

If there is a way to move off of their DNS servers and onto something we can control better (w/geodns) I'm all in favor of it. 

Regrettably, I still maintain my own servers with pure bind9 text files, no web interface... 
",Dave Täht,2011-01-26 15:37:41.754112,2011-04-20 10:57:47.258166,Jim Gettys,In Progress,High
24,sysadmin,http://mirrors.bufferbloat.net,"I'll set this up to point to your /home/jg/public_html dir

As for DNS records, lets' go easy on the non ipv6 folk and do:

mirrors.bufferbloat.net IN AAAA 2001:4f8:3:36:2e0:81ff:fe23:90d3
                        IN A 149.20.54.82
                        IN A 149.20.54.81
                        IN A 149.20.54.64

And any other places you'd want it to go. 

If you want I'll mirror it on my comcast link... 

75.145.127.229

you can put it on yours too

I'm ALL in favor of using redmine... but for video/audio... and a slashdotting.... not so much.
",Dave Täht,2011-01-26 14:35:05.864694,2011-01-26 16:37:51.441828,Jim Gettys,Closed,Normal
7,sysadmin,Set up backup disc for rsync daemon backup,"I need to format the disk, install rsyncd, and create backup.bufferbloat.net to point at it.",Jim Gettys,2011-01-23 18:50:42.037412,2011-01-26 17:44:05.870465,Jim Gettys,Closed,Normal
10,sysadmin,DNS addition for admin.bufferbloat.net,"I'd like admin.bufferbloat.net to point to:

2001:4f8:3:36:208:54ff:fe2e:16b5

(this is the ""spare"" ipv6 address for siwa)

I will hang various tools off of that. 

so while you are doing backup.bufferbloat.net... 

And if you care, I can lock down stuff even harder, restricting ssh to a range of ip adddresses, etc. Personally I'm happy with my port 222 trick. ",Dave Täht,2011-01-23 19:06:17.510966,2011-01-24 14:21:11.074437,Jim Gettys,Closed,Normal
17,sysadmin,Add Workflow statuses - TEST and DEPLOY,"Adopting this morning's affair for rhetorical purposes:

""In progress"" is not quite enough coverage of statuses. The 
actual progress of a bug is helpful. In particular (assuming there 
is a way to notify the other groups on a status change) it 
lets you throw the bug over the wall to the next guy...

So for example, the reporter (you) should have been able to move 
the status along to TEST or DEPLOY but closing the bug itself?

not helpful, since I'm the guy that has to do those two tasks, and
seeing the bug closed means (to me) it's entirely solved.

So I would suggest adding these two to the workflow

Test
Deploy

And it would be great if changing this status triggered a notification
to that ""group"". of one. at present.

From my understanding of ""activity"" it was ""what was done"" rather than status.

There are other common resolutions/statuses of bugs common out there, besides ""closed""

WONTFIX
NOFIX
WAIT - stuck on an external factor
(I really like this one as it happens a lot and generally needs managerial attention)
Duplicate
CNCL  
RTFM 
NOTABUG

There seems to be an ability to add custom fields, not sure the
right way to do this...

(and yea, this is why my gtd inspired org-mode looks like it does. 
 WAIT in particular - stuck tasks are project killers. 

 I'll also do things like have an automated script move stuff that has 
 started but has no progress for X time - and a deadline - from it's current status
 to STCK (stuck) to keep the manager/assignee on his toes.

yes, I even use 4 letter codes, it saves on screen space and eyeball time.

Not that I expect any/all my ideas to be accepted, nor do I want to complicate matters overmuch. fully closing bugs holds great satisfaction to me, too.",Dave Täht,2011-01-25 08:55:07.02948,2011-01-25 08:55:07.02948,Jim Gettys,New,Normal
264,cerowrt,Performance over the LFN,"I  get rather different results from netperf. This is iperf

From 4 driver buffers, 8 txqueuelen


LFN = root@europa:~# ping  98.229.130.122
PING 98.229.130.122 (98.229.130.122): 56 data bytes
64 bytes from 98.229.130.122: seq=0 ttl=54 time=96.463 ms

<pre>
root@europa:~# iperf -w220k -c 98.229.130.122 
------------------------------------------------------------
Client connecting to 98.229.130.122, TCP port 5001
TCP window size:  220 KByte
------------------------------------------------------------
[  3] local 149.20.63.19 port 49114 connected with 98.229.130.122 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.1 sec  4.00 MBytes  3.32 Mbits/sec
root@europa:~# iperf -t 60 -w220k -c 98.229.130.122 
------------------------------------------------------------
Client connecting to 98.229.130.122, TCP port 5001
TCP window size:  220 KByte
------------------------------------------------------------
[  3] local 149.20.63.19 port 49115 connected with 98.229.130.122 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-60.0 sec  59.9 MBytes  8.37 Mbits/sec
root@europa:~# 
</pre>

And from a normal desktop, 64 driver buffers, 1000 txqueuelen

<pre>
^Cd@bob-desktop:~$ iperf -w 220k -\c 98.229.130.122
------------------------------------------------------------
Client connecting to 98.229.130.122, TCP port 5001
TCP window size:  256 KByte (WARNING: requested  220 KByte)
------------------------------------------------------------
[  3] local 149.20.63.20 port 36413 connected with 98.229.130.122 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.1 sec  10.4 MBytes  8.60 Mbits/sec
d@bob-desktop:~$ iperf -t 60 -w 220k -\c 98.229.130.122
------------------------------------------------------------
Client connecting to 98.229.130.122, TCP port 5001
TCP window size:  256 KByte (WARNING: requested  220 KByte)
------------------------------------------------------------
[  3] local 149.20.63.20 port 36414 connected with 98.229.130.122 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-60.1 sec  58.4 MBytes  8.15 Mbits/sec
</pre>",Dave Täht,2011-09-06 02:30:06.41193,2012-04-21 12:48:05.39794,Jim Gettys,New,Normal
299,cerowrt,Follow up with speedtest.net on bufferbloat detection,"",Jim Gettys,2011-11-18 08:47:43.089518,2012-04-21 12:31:54.268955,Jim Gettys,In Progress,High
5,sysadmin,Web server log analyzer,"usually helpful to have a web server log analyzer configured.

Which to choose?",Dave Täht,2011-01-23 18:46:35.420224,2011-03-18 07:57:57.634689,Richard Pitt,New,Low
352,cerowrt,Major differences between ipv6 and ipv4 performance,"This is probably related to the unaligned accesses patches for tcp
recv and checksum
that are implemented currently for ipv4 only, but only profiling will tell.

root@remote:/etc/config# iptables -I INPUT -p tcp -m multiport --ports
5000:5010 -j ACCEPT
root@remote:/etc/config# iperf -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------
[  4] local 149.20.63.22 port 5001 connected with 149.20.63.20 port 59727
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-60.0 sec  1.86 GBytes   266 Mbits/sec
root@remote:/etc/config# iperf -w256k -V -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size:  512 KByte (WARNING: requested  256 KByte)
------------------------------------------------------------
[  4] local 2001:4f8:fff8:500::1 port 5001 connected with
2001:4f8:3:203::14 port 60094
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-60.1 sec   732 MBytes   102 Mbits/sec",David Taht,2012-04-05 15:17:49.114386,2012-04-21 09:49:24.161205,Felix Fietkau,Closed,Normal
195,cerowrt,ag71xx ethernet appears to be doing many unaligned transfers,"do_ade accounts for over 22% of the runtime on stuff that stresses the ethernet driver.

this is trapping on unaligned accesses. from somewhere. ",Dave Täht,2011-06-04 11:21:01.28444,2012-04-21 12:37:34.847334,Felix Fietkau,Closed,Normal
138,bismark,Polipo's default DNS resolver doesn't work,"The defaults for polipo seem to think it can issue it's own queries, nor does it listen on ipv6,
nor is it particularly configurable, and it (when used on a guest lan) can introduce security holes.

On the other hand, it could speed things up for many users.",Dave Täht,2011-05-12 15:15:26.213271,2011-08-02 21:50:04.160933,Srikanth Sundaresan,Closed,Normal
44,bismark,New Development Requirements,"New Tree
Server on new port
Update structure
",Dave Täht,2011-04-04 06:56:03.794327,2011-08-02 22:18:56.300116,Srikanth Sundaresan,New,Normal
165,bismark,Package up and do a release from SVN of the various bismark scripts,"there is *no* point in doing version control on everything and then just dumping something critical like your actual data measurement tools into a package arbitrarily. 

GIGO.

do a svn tag of a version number
create a tarball of the release from that version number
create a package from the tarball
build it
test...

It's the only way to avoid GIGO.",Dave Täht,2011-05-18 16:12:41.879248,2011-07-16 10:38:41.499199,Srikanth Sundaresan,Closed,Immediate
136,bismark,Bismark misbehavior,"For some reason I think this getting to where it has more than one instance is bad.

This is the result of running overnight.

 4555 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 62447:12
 5079 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 54285:12
 5354 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 55654:12
 5494 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 52699:12
 5721 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 62258:12
 5793 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 60917:12
 6089 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 55817:12
 6240 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 54469:12
 6384 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 54438:12
 6532 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 55729:12
 7375 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 61640:12
 8159 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 58735:12
 9079 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 52238:12
 9223 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 52493:12
 9364 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 50485:12
 9446 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 58797:12
 9741 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 63524:12
 9954 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 50323:12
10229 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 52364:12
10343 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 52240:12
10556 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 54975:12
10831 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 57035:12
10888 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 62043:12
11111 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 61877:12
11334 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 61838:12
11406 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 63279:12
11604 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 60027:12
11742 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 56732:12
11884 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 64720:12
12231 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 61647:12
12439 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 65134:12
13083 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 60132:12
13158 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 64958:12
13604 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 55558:12
14275 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 53613:12
15673 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 51111:12
18087 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 51631:12
18382 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 53280:12
18652 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 51607:12
18798 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 59466:12
19408 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 62624:12
19480 root      1148 S    ssh -K 30 -N -i /etc/bismark/bismark_key -R 51304:12
",Dave Täht,2011-05-12 07:38:20.137511,2011-07-16 10:40:47.077363,Srikanth Sundaresan,Closed,Immediate
52,dashboard,Data analysis tools,"Maybe leverage and work with

http://grenouille.com is doing something that is dynamic and live...

",Dave Täht,2011-04-04 08:11:19.380416,2011-05-16 20:09:02.248549,Srikanth Sundaresan,New,Normal
104,dashboard,"Split database tables by month, device, parameter","",Nick Feamster,2011-05-02 19:45:49.145825,2011-09-24 17:13:50.187632,Srikanth Sundaresan,In Progress,High
71,bismark,Project Overview,Short overview (1-paragraph) of the paragraph,Srikanth Sundaresan,2011-04-08 05:27:22.732124,2011-04-08 05:27:22.732124,Srikanth Sundaresan,New,Normal
74,bismark,Registration for routers,"Create a registration system for the routers. Users should be able to register and download images (different images for different privacy levels).
",Srikanth Sundaresan,2011-04-08 05:31:26.413718,2011-04-11 02:44:10.891008,Srikanth Sundaresan,New,Normal
78,bismark,Link to Project Management and Wiki,Link to current management page and wiki from the home page.,Srikanth Sundaresan,2011-04-08 07:28:57.743408,2011-04-08 07:28:57.743408,Srikanth Sundaresan,New,Normal
47,bismark,Integrate SVN with redmine again,"",Dave Täht,2011-04-04 07:35:59.662485,2011-05-16 20:05:19.363532,Srikanth Sundaresan,Closed,Normal
77,bismark,"Images for Atom, NoxBox","Create image for the Atom and NoxBox. Copy the config from the WNDR build, change the board and ath stuff. Build test image.",Srikanth Sundaresan,2011-04-08 06:01:32.245044,2011-05-16 19:47:39.458468,Srikanth Sundaresan,New,Low
60,bismark,Destination IP for prober,Currently the destination IP in prober is hardcoded to 143.215.131.173. Need to change that to a command line option or a config file.,Srikanth Sundaresan,2011-04-06 13:25:04.528946,2011-07-26 01:51:06.651299,Srikanth Sundaresan,Closed,High
46,bismark,Openwrt packaging for bismark,"The svn tree builds directly several versions of the bismark scripts.

If done via openwrt, and openwrt opkg versioning becomes easier.",Dave Täht,2011-04-04 07:35:24.054281,2011-05-22 06:36:03.201616,Srikanth Sundaresan,New,Immediate
144,bismark,bismark-active should use fping,"Scripting around fping rather than ping would lead to more accurate results for pinging multiple servers, as you no longer would be timing program startup.",Dave Täht,2011-05-13 06:12:06.857686,2011-08-02 22:09:19.576192,Srikanth Sundaresan,New,Urgent
177,bismark,Bismark management daemon listening on multiple ports,"To allow devices to properly report to the management server in restricted 
environments (e.g. in presence of restrictive firewalls), we decided to let the
probing protocol work on several port numbers (currently 53, 1028, 1234, 5353, 54321).
Privileged port numbers other than 53 were ont chosen because we (at least I) don't have
enough permissions to listen on them (53 is currently supported on dp4 through ""iptables -t nat"" redirection).

The bdmd daemon is currently able to listen only on a UDP port number.
It is multi-threaded and it manages a mutex to query the SQLite databases.

Launching several bdmd processes on different port numbers is not efficient, 
because the access to the SQLite database wouldn't be exclusive anymore.

To be independently able to efficiently support this feature, we need bdmd to listen on several ports natively.
(adding more iptables redirections would be simpler, but requires root privileges...)",Walter de Donato,2011-05-26 03:48:42.246726,2011-07-19 15:03:50.089699,Srikanth Sundaresan,Closed,Urgent
68,bismark,BISMark Home Page,"Create BISMark home page as a go-to for all things BISMark.
",Srikanth Sundaresan,2011-04-08 05:22:30.447047,2011-06-13 21:38:26.125052,Srikanth Sundaresan,New,High
69,bismark,BISMark Logo,Create nice logo for BISMark,Srikanth Sundaresan,2011-04-08 05:23:45.626768,2011-06-13 21:38:26.074503,Srikanth Sundaresan,Closed,Normal
75,bismark,Page for DOwnloads,"We need to create a page for people to download images. We will start off by supporting 3 platforms: NoxBox, Atom, and the WNDR3700. Might also need some images to help people out with choosing images.
",Srikanth Sundaresan,2011-04-08 05:35:09.960774,2011-04-08 05:35:09.960774,Srikanth Sundaresan,New,Normal
63,bismark,Create openwrt package for bismark,"",Dave Täht,2011-04-06 14:04:22.10079,2011-05-12 18:40:41.327229,Srikanth Sundaresan,Closed,Normal
209,bismark,cerowrt radio issues,"There were 2 routers where both the radios didn't come up on the cerowrt build; Joon's and Matt's. On mine, the 5G radio didn't come up.

On all three, the radios work perfectly on the capetown build after a reflash.

",Srikanth Sundaresan,2011-07-14 22:58:29.780728,2011-07-16 03:48:20.075228,Srikanth Sundaresan,Feedback,Immediate
208,bismark,Networking doesn't work in the cerowrt build,"Networking in the latest cerowrt build (the one that we used for the smoke test today afternoon/evening) doesn't seem to work out of the box (I'm testing from home, with the upstream device being a wndr with capetown). The device gets an IP from the upstream box; but can't ping the upstream router, or anything beyond. Here's the routing table:


root@OpenWrt:~# route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         192.168.42.1    0.0.0.0         UG    0      0        0 ge00
172.30.42.32    *               255.255.255.224 U     0      0        0 se00
172.30.42.64    *               255.255.255.224 U     0      0        0 sw00
172.30.42.96    *               255.255.255.224 U     0      0        0 sw10
172.30.42.128   *               255.255.255.224 U     0      0        0 gw00
172.30.42.160   *               255.255.255.224 U     0      0        0 gw10
192.168.42.0    *               255.255.255.0   U     0      0        0 ge00
root@OpenWrt:~# ip route
default via 192.168.42.1 dev ge00 
172.30.42.32/27 dev se00  proto kernel  scope link  src 172.30.42.33 
172.30.42.64/27 dev sw00  proto kernel  scope link  src 172.30.42.65 
172.30.42.96/27 dev sw10  proto kernel  scope link  src 172.30.42.97 
172.30.42.128/27 dev gw00  proto kernel  scope link  src 172.30.42.129 
172.30.42.160/27 dev gw10  proto kernel  scope link  src 172.30.42.161 
192.168.42.0/24 dev ge00  proto kernel  scope link  src 192.168.42.126 

However, after restarting networking, it works. There are a few errors that pop up during restart, though.

bind: Address already in use
could not bind to udp port 123
command failed: No such device (-19)

And plenty of iptables errors:

iptables: No chain/target/match by that name.
ip6tables: No chain/target/match by that name


The routing entries look like this:
root@OpenWrt:~# route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         192.168.42.1    0.0.0.0         UG    0      0        0 ge00
172.30.42.32    *               255.255.255.224 U     0      0        0 se00
172.30.42.64    *               255.255.255.224 U     0      0        0 sw00
172.30.42.96    *               255.255.255.224 U     0      0        0 sw10
172.30.42.128   *               255.255.255.224 U     0      0        0 gw00
172.30.42.160   *               255.255.255.224 U     0      0        0 gw10
192.168.1.64    *               255.255.255.255 !H    -1     0        0 *
192.168.42.0    *               255.255.255.0   U     0      0        0 ge00
192.168.42.1    *               255.255.255.255 !H    -1     0        0 *
root@OpenWrt:~# ip route
default via 192.168.42.1 dev ge00 
172.30.42.32/27 dev se00  proto kernel  scope link  src 172.30.42.33 
172.30.42.64/27 dev sw00  proto kernel  scope link  src 172.30.42.65 
172.30.42.96/27 dev sw10  proto kernel  scope link  src 172.30.42.97 
172.30.42.128/27 dev gw00  proto kernel  scope link  src 172.30.42.129 
172.30.42.160/27 dev gw10  proto kernel  scope link  src 172.30.42.161 
unreachable 192.168.1.64  proto babel  metric -1 onlink 
192.168.42.0/24 dev ge00  proto kernel  scope link  src 192.168.42.126 
unreachable 192.168.42.1  proto babel  metric -1 onlink

It's weird; I don't understand this. The first table seems proper (though should the default entry be at the bottom?). There seem t be errors in the second, but routing works.
",Srikanth Sundaresan,2011-07-14 22:56:59.588843,2011-07-18 19:53:14.416657,Srikanth Sundaresan,Closed,Immediate
141,bismark,bismark-chrome package could use some love,"Currently the bismark chrome package consists of some links. It would be nice if it did more than that, and the links were worthwhile, AND it pointed to networkdashboard AND the router's configure interface.

If people could suggest deep links (google's funding office, this projects' main page, the Italian site, etc) AND images, it would be great.",Dave Täht,2011-05-12 18:48:07.952755,2011-05-23 03:35:36.57182,Nick Feamster,Closed,Urgent
146,bismark,first buffalo router flashing results in brick,"It acquires no IP addresses, nor does it assign any.

It does come up with a SSID on the wireless interface, so the problem is in network initialization.

The flashing technique was no fun either.",Dave Täht,2011-05-14 09:47:33.594222,2011-06-13 21:35:44.352098,Nick Feamster,New,Low
127,bismark,Need release notes & installation guide,"good defaults are one thing.

A good standard procedure for doing installs is another.

Also need to note any known ""gotchas"" in the interfaces.",Dave Täht,2011-05-08 20:02:13.73831,2011-08-02 21:54:02.514728,Nick Feamster,In Progress,Immediate
212,bismark,www.projectbismark.net != projectbismark.net,"projectbismark.net is the public site. www.projectbismark.net is currently a home directory.

Looks like the Apache virtual host configuration needs to be changed, as I would argue these two should be the same page.",Stephen Woodrow,2011-07-17 21:15:51.328061,2011-07-17 21:15:51.328061,Nick Feamster,New,Normal
96,bismark,telnet does not work upon reflashing,"With the latest image, upon re-flashing, the initial telnet into the box (192.168.42.1) does not work.  Error is ""connection refused"", so the port does not appear to be open. 

% telnet 192.168.42.1
Trying 192.168.42.1...
telnet: connect to address 192.168.42.1: Connection refused
telnet: Unable to connect to remote host

Ping works, and the Web interface is reachable (from where the user can initially set a default ssh/web admin password, but the telnet issue should be fixed.",Nick Feamster,2011-04-20 20:15:42.007078,2011-05-16 19:42:27.729577,Nick Feamster,Closed,Low
57,bismark,Write up PR for joint effort,Draft what we want to say about the project in public.,Dave Täht,2011-04-06 04:23:33.585208,2011-08-03 18:55:57.063895,Nick Feamster,New,Urgent
171,bismark,Set default QoS to something reasonable,"People are already complaining about the default QoS setting.

We should make the default work.  Let's at least set it to something reasonable.   I just ran a speedtest from here.  Based on your guidelines, the QoS settings should be something like 750 kbps down, 100 kbps up.",Nick Feamster,2011-05-19 17:52:41.887315,2011-05-27 19:25:41.11803,Nick Feamster,Closed,Normal
152,bismark,Web page for Gateway,"The Web page on the device needs a portal page that directs users to places that are actually useful, has information about the project, and so forth.",Nick Feamster,2011-05-16 02:13:06.425261,2011-05-16 19:34:13.062987,Nick Feamster,Closed,Immediate
105,dashboard,Web page front matter and improved style sheet,"",Nick Feamster,2011-05-02 19:46:46.169308,2011-05-23 03:24:28.905308,Nick Feamster,Closed,Immediate
172,dashboard,Reporting QoS settings would be good,"It would be good for the users's QoS settings to be reported back to the network dashboard.

",Dave Täht,2011-05-20 06:20:42.921039,2011-08-02 22:05:41.94704,Nick Feamster,New,Normal
117,bismark,ipv4 performing 1/3 the speed of ipv6 over wireless,"<pre>
root@OpenWrt:/etc/config# iperf -V -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------
[  4] local 2002:8fd7:83f0:1::1 port 5001 connected with 2002:8fd7:83f0:1::2 port 40097
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-60.0 sec   116 MBytes  16.2 Mbits/sec
[  5] local 2002:8fd7:83f0:1::1 port 5001 connected with 2002:8fd7:83f0:1::2 port 58407
[  5]  0.0-60.0 sec   116 MBytes  16.2 Mbits/sec
root@OpenWrt:/etc/config# iperf -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------
[  4] local 192.168.43.1 port 5001 connected with 192.168.43.123 port 41415
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-60.0 sec  48.7 MBytes  6.80 Mbits/sec

</pre>",Dave Täht,2011-05-07 15:35:24.027807,2011-05-08 16:59:19.928989,Nick Feamster,Closed,Normal
164,bismark,Need PDUs,"In order for me to continue working on this remotely, the PDUs are required.",Dave Täht,2011-05-18 15:42:56.751414,2011-05-23 03:49:34.262962,Nick Feamster,Closed,Urgent
72,bismark,People,Create people page in homepage,Srikanth Sundaresan,2011-04-08 05:28:37.07818,2011-05-23 03:29:18.199612,Nick Feamster,Closed,High
190,bismark,Re: [Bismark-devel] network dashboard moved to github,"I  was wondering where updates had been going.

This is not the one containing the schema, but if this
is the current one, I can merge again, or create a separate repo for it.

My assumption is that this, actually,
is a forked version from where we were two weeks back, continuing on with
mysql support.

On Wed, Jun 1, 2011 at 7:39 AM, Nick Feamster <feamster@cc.gatech.edu>wrote:

> https://github.com/bismark-devel/networkdashboard
>
> _______________________________________________
> Bismark-devel mailing list
> Bismark-devel@lists.bufferbloat.net
> https://lists.bufferbloat.net/listinfo/bismark-devel
>",David Taht,2011-06-01 11:23:19.912492,2011-06-01 11:42:52.44076,Nick Feamster,Closed,Immediate
167,dashboard,Many places in the world do not have postal codes,"Many places in the world do not have postal codes. Making it a required field,
not so good.

Otherwise, remember that international phone numbers can have 0XX-YYY-ZZZZ-ZZZZ digits, too.

See screenshot.",Dave Täht,2011-05-18 18:06:30.239723,2011-05-19 10:54:01.810768,Nick Feamster,Closed,Normal
153,bismark,need 2 user accounts on networkdashboard.org,"Although I was given ""full"" privs on that machine I cannot make a new user. NIS is in use?

We need two users created:

dashboard (where the programs running the web site will reside) (production code)

and 

dashdev (pick a name) where the next generation of source code and programs for the web site will reside.

It would help if there was a shared ""group"" for the users/developers involved in this project as well, ""bismark"", that they were all part of.

",Dave Täht,2011-05-16 03:57:59.263785,2011-05-18 15:25:06.031885,Nick Feamster,Closed,Immediate
92,bismark,Need a more complete time utility,"On 04/17/2011 11:42 AM, Srikanth Sundaresan wrote:
> Does anyone know how to get GNU time 1.7? The current version of time on
> the build is incompatible with some of our measurement scripts.
>

General tip: when trying to figure out where a utility comes from, you can generally do a:

$ dpkg --search /usr/bin/time
time: /usr/bin/time

Which in this case shows that ubuntu/debian time comes from the time package.

You can then

$ mkdir ~/src/time; cd $_; apt-get source time

to see more about that package and its source.

Anyway...

The version of time in the build is the busybox version, which as you've noted is quite limited. It would be a good idea to go through the busybox configuration screen and figure out what additional features are needed, and what can be dropped. (be gentle here)

In this case, if you really need gnu time,  it would be best to add gnu time as an openwrt package,
and then drop the applet from the busybox build after it works. Regrettably it is not already packaged up in openwrt.

Alternatively, the busybox folk are good on accepting patches, so you could modify busybox to support the syntax for time that you need. As src goes, busybox is VERY modular and easy to deal with.

Either way, note this problem in the wiki's issues page. I can see how lacking a good timing utility would be a big problem!
",Dave Täht,2011-04-17 12:41:50.293929,2011-05-08 16:58:18.928113,Brian Poole,Closed,Urgent
125,cerowrt,ECN blacklist iptables rules,"Much like we have email blacklists, a malfunctioning ECN server blacklist could be maintained, and used as a standard iptables rule, to prevent ECN negotiation to malfunctioning hosts.

It could use ipset to check for malfunctioning hosts on connect and rsync or wget to periodically update the file, much like how spam sources are tracked today. It would be awesome if it could check automagically and phone home with the data...

",Dave Täht,2011-05-07 23:24:05.776149,2014-06-24 20:03:30.544213,Steven  Bauer,Closed,Normal
120,bismark,Need to set country code by default and via web interface,"Setting the country code for south africa by default would be good idea.

The problem is that the country code is not included in the auto-generated wireless file.",Dave Täht,2011-05-07 22:36:09.691104,2011-05-10 06:09:55.072847,Travis Kemen,Closed,High
97,iscwrt,The web interface stomps on 6in4 and 6to4 interfaces,"The current build stomps on 6in4 and 6to4 interfaces, replacing the proto with a ""none"".",Dave Täht,2011-05-02 06:46:05.230715,2012-04-22 16:30:26.536519,Travis Kemen,Closed,Normal
100,iscwrt,Adding a network crashes the web interface,"If you add a network, you get garbage html. It creates a network, however.",Dave Täht,2011-05-02 07:00:53.095012,2011-07-27 20:17:03.283739,Travis Kemen,Closed,Normal
88,bismark,Web based backup script does not work,"While working with eric on getting his wndr3700 working, the web based backup script failed to work entirely.

Also, mountd was eating 100% of CPU.

Could someone verify this is still a problem?",Dave Täht,2011-04-16 06:46:30.128427,2011-05-08 12:27:10.920014,Travis Kemen,Closed,Urgent
134,bismark,"xWrt interface no longer shows ""channel""","I think the web interface once upon a time (like, last saturday)
actually let you edit the radio's channel....

now there is no option to set the channel displayed.",Dave Täht,2011-05-10 15:14:16.752958,2011-05-11 06:32:22.543616,Travis Kemen,Closed,Normal
151,dashboard,"why so many dns ""params"" in the existing measurements table?","Why track success or failure of a given test in a *separate* table?

Is this a flaw in the existing measurement table? ALL tests should record success or failure! The absence of data is not an indicator of success or failure, merely the absence of data.

I'd add a field for this if it made sense (and it makes sense to me)

Why are these params separate measurements? How do they relate to each other? What generates the data?

CREATE TABLE dnsdelay (like measurements_tmpl including defaults including const
raints including indexes);
CREATE TABLE dnsdelayc (like measurements_tmpl including defaults including cons
traints including indexes);
CREATE TABLE dnsdelaync (like measurements_tmpl including defaults including con
straints including indexes);
CREATE TABLE dnsfail (like measurements_tmpl including defaults including constr
aints including indexes);
CREATE TABLE dnsfailc (like measurements_tmpl including defaults including const
raints including indexes);
CREATE TABLE dnsfailnc (like measurements_tmpl including defaults including cons
traints including indexes);",Dave Täht,2011-05-15 20:18:28.455038,2011-07-29 08:22:23.875251,Walter de Donato,In Progress,Normal
73,bismark,DNS query and response capture,"Want to capture client DNS queries and responses from hosts on the network for two reasons:
* Mapping of IP addresses in flow capture to DNS names (for sites that are on CDNs).  For example: How much traffic goes to NetFlix?
* Intrusion detection: looking for suspicious DNS lookups from hosts",Nick Feamster,2011-04-08 05:30:54.167756,2011-05-23 03:40:41.014525,Walter de Donato,New,Normal
56,bismark,Port bismark scripts to an openwrt/busybox shell,"Bash costs probably several hundred k of flash that can be used for other things,
and the default busybox shell is not too horrible.

What bash specific features are required in the scripts?

If it is possible to convert, how long will it take?",Dave Täht,2011-04-06 04:10:02.147677,2011-05-18 15:06:19.207752,Walter de Donato,Closed,Urgent
61,bismark,Create filesystem layout for bismark,"With a correct filesystem layout, a package can be built",Dave Täht,2011-04-06 14:02:26.083622,2011-05-16 03:46:35.717906,Walter de Donato,Closed,Normal
157,bismark,Busybox traceroute buggy implementation ,"The busybox version of traceroute should support the generation of ICMP packets, instead of UDP, using the option -I.
For some strange reason using such option always generates UDP packets.

Such beahavior limitates the flexibility of the bismark-tr script, 
that should be able to choose between UDP, ICMP and TCP implemetations of the algorithm.

For our purposes, it would be optimal to have only one traceroute binary supporting all the three protocols.",Walter de Donato,2011-05-17 08:20:06.909185,2011-07-18 07:07:28.374495,Walter de Donato,Closed,Urgent
67,bismark,Wireless throughput estimation,"Would be nice to have some way of estimating wireless throughput inside the home.  This will require some experimentation, of course.  But, we have had a couple ideas on this (returning large DNS or ARP replies to clients)",Nick Feamster,2011-04-06 22:21:05.370732,2011-05-16 19:56:15.196185,Walter de Donato,Feedback,Low
170,bismark,"What is the purpose of ""ZONE""","DEVICE_ID=$(cat /etc/bismark/ID)
PLATFORM=$(uname -nm | tr ' ' '_')
VERSION=340
ZONE=NorthAm
WAN_IF=eth1
WIFI_IF=wlan0


Does this need to be reset for South Africa?",Dave Täht,2011-05-19 15:02:45.884019,2011-07-19 15:00:23.542189,Walter de Donato,New,Normal
42,bismark,Registration Script,Automatic Registration script,Dave Täht,2011-04-04 06:50:14.504693,2011-05-26 07:37:07.908001,Walter de Donato,New,Normal
169,bismark,PROXY is still hard coded in the bismark.conf file,"Where is this machine?

from bismark.conf:

# Bismark Proxy Server
PROXY=143.215.131.173
PROXY_PORT=123

Should this be a DNS address?
",Dave Täht,2011-05-19 14:57:03.640165,2011-07-16 14:26:51.303269,Walter de Donato,New,Normal
150,dashboard,Django requires all tables have a single field primary key,"After 30 years of database research, and 20 years of web development, web frameworks such as django still require a single ""id"" field as a primary key into the database, as if database design was not important.

Declaring an artificial primary key results in terribly suboptimal data ordering on the disk. 

Many tables (particularly data collection tables) have a naturally small number of fields, a totally natural multi-field primary key and using an artificial id field hurts on performance. A lot.

Declaring an artificial key as merely unique is not picked up by django as a primary key.  

lastly, the ""quick hack"" to solve this problem induces HUGE serialization problems on data input (generating a sequential key bottlenecks all inputs)",Dave Täht,2011-05-15 19:43:55.519798,2011-05-23 03:45:25.575182,Abhishek Jain,In Progress,Urgent
106,dashboard,Throughput timeseries plots,"",Nick Feamster,2011-05-02 19:47:19.886196,2011-05-29 11:40:26.565013,Abhishek Jain,Closed,High
111,dashboard,Add functionality for choosing param and data range,Have a pull down menu where user can choose parameter and the data range to view the graph for.,Abhishek Jain,2011-05-05 06:43:34.527802,2011-05-29 11:40:52.123808,Abhishek Jain,Closed,High
108,dashboard,Pie charts/tables for passive summaries,"",Nick Feamster,2011-05-02 19:50:22.587769,2011-05-02 19:50:22.587769,Abhishek Jain,New,Normal
161,dashboard,Django is grabbing all urls so where can I stick downloads,"http://www.networkdashboard.org/downloads/

was where I thought I'd be putting downloads of the images and package directories.

or projectbismark.

If this is the case, django needs to be reconfigured to ignore 
certain urls. Or is there a better place?",Dave Täht,2011-05-18 14:23:10.575149,2011-05-27 16:41:54.239126,Abhishek Jain,Closed,Immediate
184,dashboard,Remove NB-Xuzi-Uky from all tables,"These boxes aren't reporting anything useful, and the way they are named makes tables look cluttered.",Nick Feamster,2011-05-27 16:47:40.403862,2011-05-29 11:39:36.300606,Abhishek Jain,Closed,Immediate
182,dashboard,more info on device data page,"this page http://networkdashboard.org/device/NB105/

Should have a couple more pieces of information at the top of the page:
* ISP
* Service Plan
* Upload Rate
* Download Rate

Adding the last two will require a schema change (and some tedious data entry...), but I think it will make it more apparent to the user how to compare what their plan is versus what they are getting.
",Nick Feamster,2011-05-27 16:33:24.147287,2011-05-29 11:36:30.253242,Abhishek Jain,Closed,Immediate
178,dashboard,Column spacing in device list table,the spacing between columns is too narrow,Nick Feamster,2011-05-27 16:27:45.078601,2011-05-29 11:39:20.033504,Abhishek Jain,Closed,Immediate
179,dashboard,Progress bar never goes away,"When I submit a query, I see the ""progress bar"" (actually just a bar indicating that something is happening), but it never goes away once the query completes.  An easy fix to this is to simply get rid of the progress indicator.",Nick Feamster,2011-05-27 16:29:20.137116,2011-05-29 11:38:53.296578,Abhishek Jain,Closed,Immediate
180,dashboard,"Add a link for ""Show Active Devices"" on the front page","The front page should have two links:

* Show Active Devices
* Show All Devices

where ""Active"" is defined as having reported within the last 7 days.",Nick Feamster,2011-05-27 16:30:34.912695,2011-05-29 11:39:05.416229,Abhishek Jain,Closed,Immediate
181,dashboard,Javascript error dialog box,"Submitting a query initiates a dialog box saying ""changed"".  This was for debugging, but should be removed.",Nick Feamster,2011-05-27 16:31:31.714735,2011-05-29 11:36:51.911463,Abhishek Jain,Closed,Immediate
107,dashboard,Passive network summaries into database table ,"",Nick Feamster,2011-05-02 19:49:58.011911,2011-05-23 03:54:39.736052,Abhishek Jain,New,Normal
109,dashboard,Evaluate flash vs. static plots,"",Nick Feamster,2011-05-02 19:50:49.068171,2011-05-13 09:51:47.324732,Abhishek Jain,Closed,High
183,dashboard,Sorting by date in the device summaries table does not work,"sorting the table by clicking on ""last update"" shows:
""May, March, Jan, Feb, Dec 2010, Apr""",Nick Feamster,2011-05-27 16:44:11.749965,2011-05-29 11:38:41.363679,Abhishek Jain,Closed,Immediate
110,cerowrt,dhcpd/named not restarted on network restart,"Restarting the network in iscwrt does not restart dhcpd; subsequent DHCPDISCOVERs are not answered.

Restarting named is less urgent but ought to be done anyway",Evan Hunt,2011-05-03 16:40:51.247806,2014-06-24 20:03:25.604555,Evan Hunt,Closed,Normal
121,iscwrt,it would be nice if bind-latest ran chrooted,"Since bind has often been a source of security problems in the past, it would be nice if it ran chrooted. That said, given the close integration with dhcp, this may prove difficult if not impossible to do.
",Dave Täht,2011-05-07 23:11:11.454593,2011-08-11 11:44:43.854083,Evan Hunt,Closed,Normal
227,cerowrt,how to test add-zone,given the level of chrooting I worry that adding zones on the fly won't work.,Dave Täht,2011-08-11 11:45:31.431981,2012-04-21 12:42:18.788949,Evan Hunt,New,Normal
224,cerowrt,dnssec-tools would be a good package to make,"It looks like dnssec can be made much more manageable with a port of the dnssec-tools,
available here:

http://www.dnssec-tools.org/",Dave Täht,2011-08-04 17:37:26.341589,2012-04-21 12:33:52.46034,Evan Hunt,Closed,Normal
215,iscwrt,acl them-keys not found,"doesn't like this syntax, so I got rid of it for now

--- a/net/bind-latest/files/chroot/named/etc/bind/conf/named.conf
+++ b/net/bind-latest/files/chroot/named/etc/bind/conf/named.conf
@@ -17,7 +17,7 @@ acl local {
 
 
 view ""us"" {
-       match-clients { !them-key; local; };
+       match-clients { local; };
        allow-query { any; };
        allow-recursion { any; };
        recursion yes;
",Dave Täht,2011-07-24 22:40:52.302065,2011-08-02 20:54:40.540794,Evan Hunt,Closed,Normal
123,cerowrt,dyndns and bind-latest integration scripts,"I have put the last known version of the bind integration scripts into the ceropackage repository as an openwrt package.

https://github.com/dtaht/ceropackages/tree/master/net/bind-dhcp-hooks

Regrettably it depends on dhcp-latest and is out of sync with the work in progress.",Dave Täht,2011-05-07 23:16:03.244534,2014-06-24 20:03:27.344879,Evan Hunt,Closed,Normal
89,cerowrt,bind9 grows too large by default,It is possible to limit the size of bind to below 24MB. Less than 32MB would probably allow for decent caching.,Dave Täht,2011-04-16 09:03:59.623338,2014-06-24 20:03:22.464331,Evan Hunt,Closed,Normal
175,cerowrt,Security (DNSsec) could be used to verify package updates,"Security (DNSsec) could be used to verify package updates among other things.
",Dave Täht,2011-05-23 08:59:12.939192,2012-04-21 12:42:09.168244,Evan Hunt,New,Normal
262,cerowrt,poor wireless performance in smoketest rc6,"Side by side comparison of Netgear and Cerowrt firmware shows that Cerowrt has significantly worse performance.

91Mbps Netgear 5 GHz
78Mbps Netgear 2.4 GHz
20Mbps Smoketest rc6 5 GHz
17Mbps Smoketest rc6 2.4 GHz

Images attached show signal levels and the output from the Optus Sydney speedtester which is quite local to my home network.  The WiFi signal levels are comparable for both routers, so I don't think this is an RF issue.  There are some other APs in my area in the 2.4GHz band, but their levels are relatively low.

Notes:
* 2 x WNDR7200v2 boxes
* Netgear fw: 1.0.0.8
* Mac OSX 10.6.8, Macbook Pro laptop
* 3 feet between access points
* 4 feet to the laptop which was more or less equidistant to the APs
",Aidan Williams,2011-09-04 01:27:17.233395,2011-11-18 21:17:05.391039,Frank Horowitz,In Progress,Normal
65,cerowrt,Package up and cross compile nuttcp for openwrt,"",Dave Täht,2011-04-06 14:08:32.263639,2011-07-31 07:56:36.428175,Stephen Walker,Closed,Normal
186,cerowrt,wndr3700 eth0 cannot be configured as a distinct ethernet port ,"By default, openwrt configures the first radio + ethernet port as a bridge across the local switch, and wireless. It appears to be picking up the mac address of the wireless interface when doing so, and works pretty good, except that thus far I've been unable to coax greater than 60Mbit performance out of it.

It would be useful to be able to NOT configure the ethernet interface as a bridge, but as a real, separate wired interface for my ongoing investigation to QoS and multicast issues, in particular.

Attempting to do so, results in the following - even after disabling the wireless interfaces entirely. 

root@aitne:~# ifconfig eth0
eth0      Link encap:Ethernet  HWaddr C4:3D:C7:B0:AE:36  
          inet addr:192.168.130.1  Bcast:192.168.130.255  Mask:255.255.255.0
          inet6 addr: fe80::c63d:c7ff:feb0:ae36/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1219 errors:0 dropped:1218 overruns:0 frame:0
          TX packets:1296 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:16 
          RX bytes:130214 (127.1 KiB)  TX bytes:338924 (330.9 KiB)
          Interrupt:4 

100% drops.

Even though, the other ethernet interface is fine

eth1      Link encap:Ethernet  HWaddr C4:3D:C7:B0:AE:37  
          inet addr:192.168.115.171  Bcast:192.168.115.255  Mask:255.255.255.0
          inet6 addr: fe80::c63d:c7ff:feb0:ae37/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:5081 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3399 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:5 
          RX bytes:669121 (653.4 KiB)  TX bytes:312308 (304.9 KiB)
          Interrupt:5 


openwrt bleeding edge, r26878

There are no revealing errors in the log, this is all that is said about eth0 and eth1.

root@aitne:~# dmesg | grep eth0
eth0: Atheros AG71xx at 0xb9000000, irq 4
eth0: using fixed link parameters
eth0: link up (1000Mbps/Full duplex)
eth0: link down
eth0: link up (1000Mbps/Full duplex)
",Dave Täht,2011-05-29 05:40:56.610118,2011-09-17 18:03:21.516443,Jo-Philipp Wich,Closed,High
298,cerowrt,Need build file name in the status page.,"It's too hard to figure out what file you installed on a running router, so bug reports are tough to correlate with builds. This causes confusion and headaches in support.  Would be nice to get the file name generated when the build is created onto the status page somehow.",Jim Gettys,2011-11-18 08:21:24.796472,2011-11-18 08:29:59.728919,Jo-Philipp Wich,New,Normal
80,iscwrt,6to4 support,"Adding basic 6to4 support in the image is easy, but cannot (seemingly) be done in the web UI directly.

Appending the following two lines to the /etc/network/config file gets you most of the way there

config interface v6
  option proto 6to4

But firewall rules regardless do not seem to work (blocking all traffic at the router)",Dave Täht,2011-04-12 06:54:43.20564,2012-04-22 16:30:25.373155,Jo-Philipp Wich,Closed,Normal
199,cerowrt,A bunch of baby GUI bugs/features,"1) luci-app-ntpc - seems to pull in ntpclient. Or something else is.

ntpclient is obsolete as 
ntpd -g from either the ntpd or ntpd-ssl package will do the right thing,
even more so than ntpdate.

It would be nice to be able to edit ntp.conf from the gui, instead.

2) PPOE is borked in the gui, if you add ppoe later, you get luci crashing because there 
   is no ppp tab. (probably my bug, I just needed to build ppoe and a luci for ppoe in)

3) It would be more consistent to use whatever/24 to denote the ipv4 routes in system->routes,
   as that is how ipv6 shows up, and you save a column.

   re ipv6:  You can safely filter out the fe80:: routes to reduce the noise level
 
   Protocol to show up in that column would be good, instead.

/etc/iproute2/rt_proto could list babel support (42), and a larger list of
real protocols, to get automatic number->reality translation

/etc/iproute2/* consists of several rather tiny files that are nice to have. 
I hope whenever the latest iproute shows up we can include them.

I'll gladly file these separately elsewhere, just wanted to capture then before I went to bed.",Dave Täht,2011-06-16 19:32:51.600098,2011-07-10 14:57:31.861755,Jo-Philipp Wich,Closed,Normal
198,cerowrt,Firewall rules are no longer correct,The firewall rules I did can be simplified when using the luci interface.,Dave Täht,2011-06-09 07:46:11.979575,2011-08-03 07:10:13.297242,Jo-Philipp Wich,Closed,Normal
139,iscwrt,6in4 scripts don't check for rfc1918 on wan inteface,"and generate bad 2002::whatever by default.

Sigh",Dave Täht,2011-05-12 16:05:07.400609,2011-09-17 18:03:44.856255,Jo-Philipp Wich,Closed,Normal
207,cerowrt,Polipo does not listen on localhost with its own internal resolver,"When polipo is configured (/etc/config/polipo) with:

<pre>
config 'polipo' 'general'
...
    option 'dnsUseGethostbyname' 'false'
    option 'dnsNameServer' '127.0.0.1'
</pre>

it appears that DNS does not work for polipo. We're using BIND9 running natively on the devices. However, configured as follows:

<pre>
config 'polipo' 'general'
...
    option 'dnsUseGethostbyname' 'true'
    option 'dnsNameServer' '127.0.0.1'
</pre>

DNS does work, however it is slow because this is single-threaded.

We have also tried binding directly to ::1 which appears to have worked once or twice but not consistently. We have also tried binding to the interface address which seems to work with @option 'dnsUseGethostbyname' 'true'@.",Nick Feamster,2011-07-14 10:09:25.024206,2012-04-21 12:46:58.908597,Stephen Woodrow,In Progress,High
51,bismark,Switch to postgres from mysql,"Better data and better schema for the system.

Better analysis tools.

Month to month data collection...

",Dave Täht,2011-04-04 08:08:57.343394,2011-08-03 18:39:00.828555,Stephen Woodrow,In Progress,Normal
166,dashboard,Major changes to webserver/dp4/dns needed,"well, I finally got full access to the dp4 this afternoon

I'm going to need to make major changes across the entire system to do this.

django, if kept, needs to become fastcgi in particular.
Apache is under configured
there is no user authentiation or privacy features in place
the postgres database needs to be configured and tuned up
dns is unconfigured
there is no ipv6
the box is out of date

At least one of these changes is going to require a reboot.",Dave Täht,2011-05-18 16:25:50.161032,2011-09-24 17:07:05.307371,Stephen Woodrow,New,Urgent
50,bismark,Freeze against a version of D-ITG,"And generate package for such.

",Dave Täht,2011-04-04 07:55:36.000265,2011-09-24 17:11:58.726285,Stephen Woodrow,Feedback,Immediate
162,cerowrt,TX_RETRY still too high ,"<dtaht> I see latencies as high as 60ms under load for ping  [12:45]
<dtaht> and NEVER a packet loss.
<dtaht> I think I only set TX_RETRY down to 2.
<nbd> yeah, with my patch i still haven't found a decent queue length limit
      that doesn't hurt aggregation throughput
<dtaht> There's another RETRY in hardware?
<nbd> but at least i've been able to keep the non-aggregated latency low
      without hurting throughput at all
<dtaht> nbd: you know me, I don't give a F* about aggregation throughpt...
<dtaht> cool  [12:46]
<dtaht> that's a start
<dtaht> I have routers going to the third world... Today.
<nbd> what TX_RETRY are you talking about?
<dtaht> The amount of wireless-n down there is probably non-existent
<dtaht> -#define ATH_TXMAXTRY            13  [12:47]
<dtaht> +#define ATH_TXMAXTRY            2
<dtaht>  #define ATH_MGT_TXMAXTRY        4
<dtaht>  
<dtaht>  #define TID_TO_WME_AC(_tid)				\
<dtaht> @@ -542,7 +542,7 @@
<dtaht>  #define DEFAULT_CACHELINE       32
<dtaht>  #define ATH_REGCLASSIDS_MAX     10
<dtaht>  #define ATH_CABQ_READY_TIME     80      /* % of beacon interval */
<dtaht> -#define ATH_MAX_SW_RETRIES      10
<dtaht> +#define ATH_MAX_SW_RETRIES      2
<dtaht> 
<nbd> ah
<nbd> ATH_TXMAXTRY is unused  [12:48]
<nbd> except when using the ath9k rate control module
<nbd> but that one's crappy anyway
<nbd> and openwrt doesn't use it
<dtaht> I figured. 
<nbd> init.c: hw->max_rate_tries = 10;
<dtaht> How is germany in June?  [12:49]
<dtaht> sigh
<dtaht> too late to change now, but good to know.
<nbd> germany's nice in june",Dave Täht,2011-05-18 14:51:50.261962,2011-08-03 07:16:08.349235,Andrew McGregor,Closed,Normal
216,cerowrt,Infiinite retry for ping,ping takes 1.6 seconds to go 40 meters. ,Dave Täht,2011-07-28 19:59:02.45831,2011-08-14 09:28:38.605187,Andrew McGregor,Closed,Immediate
238,cerowrt,Multiple named processes running,"When fiddling around in the UI, I have had up to 6 different named processes running.  I don't know how or why...  In general, this happens mostly when futzing with interfaces a lot.  A very lot.",Michael Graff,2011-08-22 15:59:44.007842,2012-04-21 12:45:57.28778,Michael Graff,Closed,Urgent
449,cerowrt,DNS lookups for certain domains fail behind CeroWRT DNS,"Several domains that I use regularly will not resolve when proxied by my CeroWRT 3.10.48-2 router, and nor will they resolve from the CeroWRT network diagnostics page.  When setting the resolv.conf of a host behind my router manually to point to a known good resolver, however, they resolve correctly.

I have not been able to determine what causes this.

The symptoms from the client are that queries are sent to the CeroWRT device but it never returns a response.  Compare this failing lookup:

16:51:36.140676 IP 192.168.33.1.43897 > 192.168.33.254.53: 27175+ A? debian.org. (28)
16:51:41.140752 IP 192.168.33.1.43897 > 192.168.33.254.53: 27175+ A? debian.org. (28)
[no response]

With this successful lookup:

16:51:51.220838 IP 192.168.33.1.57704 > 192.168.33.254.53: 55242+ A? psg.com. (25)
16:51:51.221277 IP 192.168.33.254.53 > 192.168.33.1.57704: 55242 1/0/0 A 147.28.0.62 (41)

Examples of domains that fail reliably are debian.org (as above) and lkml.org.  I have not identified any specific feature of these domains' records that may cause this, but I haven't examined them closely.",Ethan Blanton,2015-01-24 13:54:36.181509,2015-06-16 17:25:51.357882,Petri Rosenström,Closed,Normal
294,cerowrt,Add configurations for WNDR3800,"Dave said ""Explicitly identifing a wndr3800 as a wndr3800 will need a /etc/defconfig/ set of files created.""

We'll figure out what needs to be done.

I think that these files come from *cerofiles* repository in folder *files/etc/defconfig/*

There might be other configurations also like Dave suggest http://www.bufferbloat.net/issues/291#note-3",Petri Rosenström,2011-11-05 01:57:11.86392,2012-01-29 15:37:00.39204,Petri Rosenström,Closed,Normal
399,cerowrt,Problem starting avahi-daemon,"In latest build, 3.3.8-6, avahi-daemon fails to start with the error ""avahi-daemon: unrecognized option `--no-chroot'"". Removing the option from the file allows it to start up and function.

",William Katsak,2012-07-02 15:05:39.394948,2012-07-12 12:24:34.710595,Petri Rosenström,Closed,Normal
257,cerowrt,setting up a subdomain delegation and views to bind9 on the router,"I added the following definitions to my main bind9 dns server
so I could test the bind9 services on the routers. 

(I note I added the lab IN A an AAAA records later to no avail)

lab                     IN NS ns1.lab.bufferbloat.net.
                        IN NS ns2.lab.bufferbloat.net.
                        IN A 149.20.63.18
                        IN AAAA 2001:4f8:3:203::2
ns1.lab                 IN A 149.20.63.18
                        IN AAAA 2001:4f8:3:203::2
ns2.lab                 IN A 149.20.63.19
                        IN AAAA 2001:4f8:3:203::13

Then I set up acls, a slave zone, etc, on the router, to make it work...
theoretically. However, if I only enabled the internal view, I got this:

Aug 30 11:43:33 shipka named[7177]: zone lab.bufferbloat.net/IN: refresh: non-authoritative answer from master 2001:4f8:3:203::2#53 (source ::#0)

and no slaves file is created. OK. So I try to setup the glue record and NOT cache the domains...

root@shipka:/etc/bind# host www.lab.bufferbloat.net
Host www.lab.bufferbloat.net not found: 3(NXDOMAIN)
root@shipka:/etc/bind# host lab.bufferbloat.net
Host lab.bufferbloat.net not found: 3(NXDOMAIN)
root@shipka:/etc/bind# Aug 30 11:43:33 shipka named[7177]: zone lab.bufferbloat.net/IN: refresh: non-authoritative answer from master 2001:4f8:3:203::2#53 (source ::#0)

so I set up the external view and now I'm happy except I don't write the slaves file - 


except that I get this:

Aug 30 11:54:33 shipka named[7259]: transfer of 'lab.bufferbloat.net/IN' from 2001:4f8:3:203::2#53: connected using 2001:4f8:3:36:208:54ff:fedb:40ec#52884
Aug 30 11:54:33 shipka named[7259]: transfer of 'lab.bufferbloat.net/IN' from 2001:4f8:3:203::2#53: failed while receiving responses: REFUSED
Aug 30 11:54:33 shipka named[7259]: transfer of 'lab.bufferbloat.net/IN' from 2001:4f8:3:203::2#53: Transfer completed: 0 messages, 0 records, 0 bytes, 0.002 secs (0 bytes/sec)

and I still want the internal views to be split so I can have 172.x reverse resolve....


and ultimately I want to be able to sign this whole shmeer....
",Dave Täht,2011-08-30 11:56:33.333836,2012-04-21 12:42:23.724118,Petri Rosenström,New,Normal
342,cerowrt,"bind9 needs a 'allow-recursion' line to allow machines in the acl but not on a directly attached net, to work","allow-recursion is required if you have (for example) two cerowrt routers and want one bind instance to provide name service to them both.

view ""internal"" {
       match-clients { ""internal-net""; };
       recursion yes;
       allow-recursion { any; };
",Dave Täht,2012-03-01 06:24:48.67079,2012-04-21 12:35:51.696449,Petri Rosenström,Closed,Normal
293,cerowrt,Support for WNDR3800,"CeroWRT could support the WNDR3800. This is a feature request that helps us to figure out what else needs to be done for full support.

btw. there are already images for wndr3800.",Petri Rosenström,2011-11-05 01:21:39.750402,2012-01-29 15:37:00.440973,Petri Rosenström,Closed,Normal
287,ahlnem,The architecture of the first two deployments is needed,"
The ""Network Design"":http://www.bufferbloat.net/projects/ahlnem/wiki/Network_Design makes the configuration of the original testbed network pretty clear. Is this done in dia or some other tool?

What do you intend do on your first two deployments? For example, will you be testing a specific provider or set of providers? IPv6 at all? Will you need to be turning off NAT in order to make it work right? Etc?

",Dave Täht,2011-10-17 07:21:54.392998,2011-10-17 07:21:54.392998,Fabian Schneider,New,Normal
406,cerowrt,quagga does not propagate default 6to4 route,"When 6to4 is used on Cerowrt 3.3.8-14 and prior, the default route for ipv6 is not propagated via quagga-babeld.

root@gw:/etc/quagga# ip -6 route | grep default
default via ::192.88.99.1 dev 6to4-ge01  metric 1024 

The 2002::/16 route is propagated to all clients. Note that it ends up in the kernel table.

root@gw:/etc/quagga# ip -6 route | grep 6to4
2002::/16 dev 6to4-ge01  proto kernel  metric 256 

If I manually on the client add the default route via

ip -6 route add default via fe80::204e:7fff:fe4a:9627 dev gw11

Things work.

So my guess is that the default route in the 6to4 netifd script needs to also be inserted into the kernel table in order to be passed to clients via quagga.

I have denis's patch as well installed for RT_PROT messages, but that doesn't appear to affect this behavior.

",Dave Täht,2012-08-10 17:41:19.900767,2012-12-03 03:36:43.977685,Denis Ovsienko,In Progress,Normal
